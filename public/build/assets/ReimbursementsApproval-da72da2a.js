import{G as n,X as q,H as Z,b as E,j as o,w as s,g as i,l as p,_ as w,a3 as B,F as ee,Q as S,a as T,i as u,o as F,t as b,n as te,d as oe,I as ae,P as le,J as se,R as ne,v as ie}from"./toastservice.esm-a485217a.js";import{u as re,C as de,T as ce,B as ue,S as pe,F as me,c as ve,b as fe,e as be,a as ge,d as _e}from"./styleclass.esm-25bc05b3.js";import"./blockui.esm-5c987121.js";import{s as we}from"./confirmdialog.esm-d36c2e71.js";import{D as he}from"./dialogservice.esm-b5383532.js";import{s as ye}from"./toast.esm-8dae2159.js";import{s as xe}from"./progressspinner.esm-4410ebc7.js";import{s as Se}from"./row.esm-6ebc942e.js";import{s as Ce}from"./columngroup.esm-9dd1458e.js";import{s as Re}from"./calendar.esm-6fc95d76.js";import{h as I}from"./moment-fbc5633a.js";import{s as ke}from"./checkbox.esm-41b041ea.js";const Ae=i("h5",null,"Do you want to approve all?",-1),De={class:"flex justify-content-between align-items-center"},Te={class:"flex justify-content-between align-items-center"},Pe=["disabled"],Ue=i("i",{class:"fa fa-cog me-2"},null,-1),$e=["disabled"],Ne=i("i",{class:"fas fa-file-download me-2"},null,-1),Ve=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),Me=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),je={class:"confirmation-content"},Le=i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Ee={key:0},Be={class:"orders-subtable"},Fe={style:{"white-space":"nowrap"}},Ie={__name:"ReimbursementsApproval",setup(Oe){let h=n(),g=n(!1),m=n(!1);const _=n(!1);re();const O=q();n(!0);const P=n([]);n(!1),n(!1);const C=n();n(),n(!0),n({global:{value:null,matchMode:S.CONTAINS},name:{value:null,matchMode:S.STARTS_WITH,matchMode:S.EQUALS,matchMode:S.CONTAINS},status:{value:null,matchMode:S.EQUALS}});const Y=n(["Pending","Approved","Rejected"]);let v=null,R=null;const z=n(!0);Z(()=>{h.value=[],f.value=new Date,console.log(f.value)});function H(){let a=window.location.origin+"/fetch_all_reimbursements_as_groups";console.log("AJAX URL : "+a),T.get(a).then(e=>{h.value=e.data,console.log(e.data),console.log(Object.keys(e.data))})}function U(a,e){g.value=!0,v=e,R=a,console.log("Selected Row Data : "+JSON.stringify(a))}function $(a){g.value=!1,a&&D()}function D(){v="",R=null}const f=n(),y=n();n(!1);const k=n(!1),N=n(),J=()=>{let a=new Date(f.value),e=a.getFullYear(),x=a.getMonth()+1;console.log(f.value.toString()),console.log(N),_.value=!0,T.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:e,selected_month:x,selected_status:y.value}).then(d=>{console.log("data sent"),console.log("data from "+d.employee_name),h.value=d.data,N.value=d.data,_.value=!1}).catch(d=>{console.log(d)})},G=()=>{let a=new Date(f.value);_.value=!0;let e=a.getFullYear(),x=a.getMonth()+1;z.value=!1;let d="/reports/generate-manager-reimbursements-reports?selected_year="+e+"&selected_month="+x+"&selected_status="+y.value+"&_token={{ csrf_token() }}";window.location=d,setTimeout(V,1e3)},V=()=>{_.value=!1};setTimeout(V,3e3);function Q(){$(!1),m.value=!0,console.log("Processing Rowdata : "+JSON.stringify(R)),console.log("currentlySelectedStatus : "+v),T.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:R,status:v=="Approve"?"Approved":v=="Reject"?"Rejected":v,reviewer_comments:""}).then(a=>{console.log(a),m.value=!1,O.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),H(),D()}).catch(a=>{m.value=!1,D(),console.log(a.toJSON())})}return n(),(a,e)=>{const x=u("Toast"),d=u("Button"),A=u("Dialog"),W=u("Calendar"),K=u("Dropdown"),M=u("ProgressSpinner"),r=u("Column"),X=u("InputText"),j=u("DataTable");return F(),E(ee,null,[o(x),o(A,{visible:k.value,"onUpdate:visible":e[2]||(e[2]=t=>k.value=t),modal:"",header:"Header",style:{width:"25vw"}},{footer:s(()=>[o(d,{label:"No",icon:"pi pi-times",onClick:e[0]||(e[0]=t=>k.value=!1),text:""}),o(d,{label:"Yes",icon:"pi pi-check",onClick:e[1]||(e[1]=t=>k.value=!1),autofocus:""})]),default:s(()=>[Ae]),_:1},8,["visible"]),i("div",De,[i("div",Te,[o(W,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=t),view:"month",dateFormat:"mm/yy",class:"",style:{border:"1px solid orange","border-radius":"7px"}},null,8,["modelValue"]),o(K,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=t=>y.value=t),options:Y.value,placeholder:"Status",class:"w-full md:w-14rem mx-3",style:{border:"1px solid orange","border-radius":"7px"}},null,8,["modelValue","options"]),i("button",{label:"Submit",class:"btn btn-primary",severity:"danger",disabled:!y.value!="",onClick:J},[Ue,p(" Generate")],8,Pe)]),i("button",{class:"btn btn-primary",disabled:w(h)=="",severity:"success",onClick:G},[Ne,p("Download")],8,$e)]),i("div",null,[o(A,{header:"Header",visible:_.value,"onUpdate:visible":e[5]||(e[5]=t=>_.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[o(M,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[Ve]),_:1},8,["visible"]),o(A,{header:"Header",visible:w(m),"onUpdate:visible":e[6]||(e[6]=t=>B(m)?m.value=t:m=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[o(M,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[Me]),_:1},8,["visible"]),o(A,{header:"Confirmation",visible:w(g),"onUpdate:visible":e[9]||(e[9]=t=>B(g)?g.value=t:g=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:s(()=>[o(d,{label:"Yes",icon:"pi pi-check",onClick:e[7]||(e[7]=t=>Q()),class:"p-button-text",autofocus:""}),o(d,{label:"No",icon:"pi pi-times",onClick:e[8]||(e[8]=t=>$(!0)),class:"p-button-text"})]),default:s(()=>[i("div",je,[Le,i("span",null,"Are you sure you want to "+b(w(v))+"?",1)])]),_:1},8,["visible"]),i("div",null,[o(j,{value:w(h),paginator:!0,rows:10,class:"mt-6",dataKey:"user_id",onRowExpand:a.onRowExpand,onRowCollapse:a.onRowCollapse,expandedRows:P.value,"onUpdate:expandedRows":e[11]||(e[11]=t=>P.value=t),selection:C.value,"onUpdate:selection":e[12]||(e[12]=t=>C.value=t),selectAll:a.selectAll,onSelectAllChange:a.onSelectAllChange,onRowSelect:a.onRowSelect,onRowUnselect:a.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:s(()=>[p(" No Reimbursement data for the selected status filter ")]),loading:s(()=>[p(" Loading customers data. Please wait. ")]),expansion:s(t=>[i("div",Be,[o(j,{value:t.data.reimbursement_data,responsiveLayout:"scroll",selection:C.value,"onUpdate:selection":e[10]||(e[10]=c=>C.value=c),selectAll:a.selectAll,onSelectAllChange:a.onSelectAllChange},{default:s(()=>[o(r,{field:"",header:"Date",sortable:""},{body:s(c=>[i("p",Fe,b(w(I)(c.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),o(r,{field:"from",header:"From"}),o(r,{field:"to",header:"To"}),o(r,{field:"user_comments",header:"Comments"}),o(r,{field:"vehicle_type",header:"Mode of transport"}),o(r,{class:"fontSize13px",field:"distance_travelled",header:"Distance Covered"}),o(r,{class:"fontSize13px",field:"total_expenses",header:"Total Expenses"},{body:s(c=>[p(b("₹ "+c.data.total_expenses),1)]),_:2},1024),o(r,{field:"status",header:"Status",sortable:""},{body:s(c=>[i("span",{class:te("order-badge order-"+c.data.status)},b(c.data.status),3)]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:s(()=>[o(r,{expander:!0}),o(r,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),o(r,{field:"user_code",header:"Employee Id",sortable:""}),o(r,{field:"name",header:"Employee Name"},{body:s(t=>[p(b(t.data.employee_name),1)]),filter:s(({filterModel:t,filterCallback:c})=>[o(X,{modelValue:t.value,"onUpdate:modelValue":L=>t.value=L,onInput:L=>c(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),o(r,{class:"fontSize13px",field:"total_distance_travelled",header:"Overall Distance Travelled",sortable:!1},{body:s(t=>[p(b(t.data.total_distance_travelled+" KM"),1)]),_:1}),o(r,{class:"fontSize13px",field:"total_expenses",header:"Overall Reimbursements",sortable:!1},{body:s(t=>[p(b("₹ "+t.data.total_expenses),1)]),_:1}),o(r,{field:"",header:"Action"},{body:s(t=>[t.data.has_pending_reimbursements=="true"?(F(),E("span",Ee,[o(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:c=>U(t.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),o(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:c=>U(t.data,"Reject")},null,8,["onClick"])])):oe("",!0)]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"])])])],64)}}},l=ae(Ie);l.use(le,{ripple:!0});l.use(de);l.use(se);l.use(he);l.directive("tooltip",ce);l.directive("badge",ue);l.directive("ripple",ne);l.directive("styleclass",pe);l.directive("focustrap",me);l.component("Button",ie);l.component("DataTable",ve);l.component("Column",fe);l.component("ColumnGroup",Ce);l.component("Row",Se);l.component("Toast",ye);l.component("ConfirmDialog",we);l.component("Dropdown",be);l.component("InputText",ge);l.component("Dialog",_e);l.component("ProgressSpinner",xe);l.component("Calendar",Re);l.component("moment",I);l.component("Checkbox",ke);l.mount("#vjs_reimbursementsApprovalTable");
