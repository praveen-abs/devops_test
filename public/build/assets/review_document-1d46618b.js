import{B as a,X as K,E as Q,c as T,h as t,e as i,w as s,V as v,a1 as E,F as j,f as W,K as _,g as f,o as P,t as V,j as F,G as X,P as q,H as Z,R as ee,q as te}from"./toastservice.esm-be32db1e.js";import{T as oe,B as le,S as ae,b as ne,a as se}from"./styleclass.esm-ba8fdf63.js";import"./blockui.esm-dd521861.js";import{u as ie,C as re,F as ce,b as ue,s as pe,a as de}from"./inputtext.esm-e9caa4ce.js";import{s as me}from"./confirmdialog.esm-bc3d19a4.js";import{D as ve}from"./dialogservice.esm-7f45f84c.js";import{s as fe}from"./toast.esm-798d9fce.js";import{s as ge}from"./progressspinner.esm-08c4bf67.js";import{s as _e}from"./row.esm-6ebc942e.js";import{s as be}from"./columngroup.esm-9dd1458e.js";import{s as he}from"./calendar.esm-edf22c1b.js";import{h as O}from"./moment-fbc5633a.js";import{s as we}from"./checkbox.esm-dabc85a7.js";import{a as $}from"./index-f7a317fc.js";const ye=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),Se={class:"confirmation-content"},Ce=i("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Re={class:"orders-subtable"},Ae={style:{"white-space":"nowrap"}},De=["src","alt"],ke=["src"],xe=i("button",{class:"btn btn-success mr-3"},"Edit",-1),Te=i("button",{class:"btn btn-danger"},"Delete",-1),Pe={__name:"review_document",setup($e){const C=a(!1);let b=a(),m=a(!1),g=a(!1);const R=a(!1);ie();const Y=K();a(!0);const N=a([]);a(!1),a(!1);const h=a();a(),a(!0);const A=a(),I=e=>{console.log(e),A.value=e,C.value=!0};a({global:{value:null,matchMode:_.CONTAINS},name:{value:null,matchMode:_.STARTS_WITH,matchMode:_.EQUALS,matchMode:_.CONTAINS},status:{value:null,matchMode:_.EQUALS}}),a(["Pending","Approved","Rejected"]);let u=null,w=null;a(!0),Q(()=>{b.value=[],S.value=new Date,console.log(S.value),J()});function J(){let e=window.location.origin+"/fetch-onboarded-doc";console.log("AJAX URL : "+e),$.get(e).then(l=>{b.value=l.data,console.log(l.data)})}function y(e,l){m.value=!0,u=l,w=e,console.log("Selected Row Data : "+JSON.stringify(e))}function B(e){m.value=!1,e&&D()}function D(){u="",w=null}const S=a(),z=a();a(!1),a(!1);const L=a(),G=()=>{let e=new Date(S.value),l=e.getFullYear(),k=e.getMonth()+1;console.log(S.value.toString()),console.log(L),R.value=!0,$.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:l,selected_month:k,selected_status:z.value}).then(p=>{console.log("data sent"),console.log("data from "+p.employee_name),data_reimbursements.value=p.data,L.value=p.data,R.value=!1}).catch(p=>{console.log(p)})};setTimeout(()=>{R.value=!1},3e3);function H(){B(!1),console.log("Processing Rowdata : "+JSON.stringify(w)),console.log("currentlySelectedStatus : "+u),$.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:w,status:u=="Approve"?"Approved":u=="Reject"?"Rejected":u,reviewer_comments:""}).then(e=>{console.log(e),G(),Y.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),D()}).catch(e=>{g.value=!1,D(),console.log(e.toJSON())})}return a(),(e,l)=>{const k=f("Toast"),p=f("ProgressSpinner"),x=f("Dialog"),d=f("Button"),r=f("Column"),M=f("DataTable");return P(),T(j,null,[t(k),i("div",null,[t(x,{header:"Header",visible:v(g),"onUpdate:visible":l[0]||(l[0]=n=>E(g)?g.value=n:g=n),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[t(p,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[ye]),_:1},8,["visible"]),t(x,{header:"Confirmation",visible:v(m),"onUpdate:visible":l[3]||(l[3]=n=>E(m)?m.value=n:m=n),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:s(()=>[t(d,{label:"Yes",icon:"pi pi-check",onClick:l[1]||(l[1]=n=>H()),class:"p-button-text",autofocus:""}),t(d,{label:"No",icon:"pi pi-times",onClick:l[2]||(l[2]=n=>B(!0)),class:"p-button-text"})]),default:s(()=>[i("div",Se,[Ce,i("span",null,"Are you sure you want to "+V(v(u))+"?",1)])]),_:1},8,["visible"]),i("div",null,[t(M,{value:v(b),paginator:!0,rows:10,class:"",dataKey:"user_id",onRowExpand:e.onRowExpand,onRowCollapse:e.onRowCollapse,expandedRows:N.value,"onUpdate:expandedRows":l[5]||(l[5]=n=>N.value=n),selection:h.value,"onUpdate:selection":l[6]||(l[6]=n=>h.value=n),selectAll:e.selectAll,onSelectAllChange:e.onSelectAllChange,onRowSelect:e.onRowSelect,onRowUnselect:e.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:s(()=>[F(" No Reimbursement data for the selected status filter ")]),loading:s(()=>[F(" Loading customers data. Please wait. ")]),expansion:s(n=>[i("div",Re,[t(M,{value:n.data.onboard_doc,responsiveLayout:"scroll",selection:h.value,"onUpdate:selection":l[4]||(l[4]=c=>h.value=c),selectAll:e.selectAll,onSelectAllChange:e.onSelectAllChange},{default:s(()=>[t(r,{field:"",header:"Date",sortable:""},{body:s(c=>[i("p",Ae,V(v(O)(c.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),t(r,{field:"document_name",header:"Document Name"}),t(r,{field:"doc_url",header:"Document Url"}),t(r,{field:"",header:"View"},{body:s(c=>[t(d,{type:"button",icon:"pi pi-eye",class:"p-button-success Button",label:"View",onClick:U=>I(c.data.doc_url),style:{height:"2em"}},null,8,["onClick"])]),_:2},1024),t(r,{field:"",header:"Action"},{body:s(c=>[i("span",null,[t(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:U=>y(c.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),t(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:U=>y(c.data,"Reject")},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:s(()=>[t(r,{expander:!0}),t(r,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),t(r,{field:"user_code",header:"Employee Id",sortable:""}),t(r,{field:"employee_name",header:"Employee Name"}),t(r,{class:"fontSize13px",field:"total_distance_travelled",header:"Date Of Joining"}),t(r,{class:"fontSize13px",field:"total_expenses",header:"Approval Status",sortable:!1}),t(r,{field:"",header:"Action"},{body:s(n=>[i("span",null,[t(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:c=>y(n.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),t(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:c=>y(n.data,"Reject")},null,8,["onClick"])])]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"]),t(x,{visible:C.value,"onUpdate:visible":l[7]||(l[7]=n=>C.value=n),modal:"",header:"Documents",style:{width:"40vw"}},{default:s(()=>[i("img",{src:`http://127.0.0.1:8000/${A.value}`,alt:A.value,class:"block pb-3 m-auto"},null,8,De)]),_:1},8,["visible"]),(P(!0),T(j,null,W(v(b),n=>(P(),T("div",{key:n},[i("img",{src:n.doc_url,alt:""},null,8,ke),xe,Te]))),128))])])],64)}}},o=X(Pe);o.use(q,{ripple:!0});o.use(re);o.use(Z);o.use(ve);o.directive("tooltip",oe);o.directive("badge",le);o.directive("ripple",ee);o.directive("styleclass",ae);o.directive("focustrap",ce);o.component("Button",te);o.component("DataTable",ne);o.component("Column",se);o.component("ColumnGroup",be);o.component("Row",_e);o.component("Toast",fe);o.component("ConfirmDialog",me);o.component("Dropdown",ue);o.component("InputText",pe);o.component("Dialog",de);o.component("ProgressSpinner",ge);o.component("Calendar",he);o.component("moment",O);o.component("Checkbox",we);o.mount("#ReviewDocuments");
