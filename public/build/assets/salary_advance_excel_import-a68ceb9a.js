/* empty css              *//* empty css                   *//* empty css                 */import{Q as r,g as T,o as c,c as u,d as l,aa as _,h as w,w as A,F as M,f as le,b as ie,t as x,n as V,l as ce,ai as pe,a as ue,T as de,ac as me,ad as fe,H as _e,P as ye,R as ve,u as ge,x as be,I as he,K as Se,M as xe,J as Te,L as Ee}from"./inputnumber.esm-5d69a21b.js";import{d as Ce,c as we}from"./pinia-c08c4665.js";import{u as Ae,a as J,T as Ne,B as Ie,S as ke,b as De,s as $e}from"./toastservice.esm-9d3b5dc9.js";import"./blockui.esm-3d95c539.js";import{a as Re}from"./datatable.esm-7205543b.js";import{D as Ve,s as Oe}from"./dialogservice.esm-ea919e3d.js";import{C as Be}from"./confirmationservice.esm-9a37c562.js";import{s as Pe}from"./progressspinner.esm-7d63b3de.js";import{s as Fe}from"./row.esm-6ebc942e.js";import{s as Le}from"./calendar.esm-0c5ba9cf.js";import{s as Me}from"./textarea.esm-e5a5a0a6.js";import{s as Ue}from"./chips.esm-7b2af6dc.js";import{s as je}from"./multiselect.esm-951f3d22.js";import{s as He}from"./selectbutton.esm-5e82c29f.js";import{s as Ke}from"./radiobutton.esm-31b4816a.js";import{s as ze}from"./checkbox.esm-8e251a83.js";import{s as We}from"./organizationchart.esm-e629bcb6.js";import{u as qe,a as Qe}from"./vue-router-3826051d.js";import{a as Ge}from"./index-362795f3.js";import{r as Je,u as O}from"./xlsx-4ad528ac.js";import"./dayjs.min-2f06af28.js";import{S as Y}from"./Service-7a074f26.js";import{_ as Ye}from"./_plugin-vue_export-helper-c27b6911.js";const X=Ce("useImportSalaryAdvance",()=>{qe();const y=r(!1),i=Ae(),d=r(),E=r(),S=r(),v=r([]),m=r([]);r(!1),r(!1);const g=r(),N=r(),C=s=>{S.value=s.target.files[0]},t=(s,a)=>{if(s){var n=s.target.files[0];if(!n)return;var p=new FileReader;p.onload=function(To){const ne=p.result;var D=Je(ne,{type:"binary",cellDates:!0,dateNF:"dd-mm-yyyy"}),G=D.Sheets[D.SheetNames[0]];let P=[];const $={},F=O.decode_range(G["!ref"]);let h;const re=F.s.r;for(h=F.s.c;h<=F.e.c;++h){const f=G[O.encode_cell({c:h,r:re})];let k="UNKNOWN "+h;f&&f.t&&(k=O.format_cell(f)),$[h]=k;let L={title:$[h],value:$[h]};$[h].includes("UNKNOWN")||P.push(L)}E.value=P,console.log(P);const I=D.SheetNames.reduce((f,k)=>{const L=D.Sheets[k];return f[k]=O.sheet_to_json(L,{raw:!1,dateNF:"dd-mm-yyyy"}),f},{}),R=Object.keys(I)[0];I[R]?d.value=I[R]:d.value=[],d.value&&q(d.value),v.value.push(d.value);for(let f=0;f<I[R].length;f++)console.log("jsonData['Sheet1'].length :",I[R].length),Q(d.value[f])},p.readAsArrayBuffer(n)}else i.add({severity:"error",summary:"file missing!",detail:"selected",life:2e3})},e=s=>{let a="";N.value=="quick"?a="/onboarding/storeQuickOnboardEmployees":N.value=="bulk"&&(a="/onboarding/storeBulkOnboardEmployees"),m.value==0?(y.value=!0,Ge.post(a,s).then(n=>{y.value=!1,n.data.status=="failure"?i.add({severity:"error",summary:"failure",detail:`${n.data.message}`,life:3e3}):n.data.status=="success"&&(n.data.data.forEach(p=>{i.add({severity:"success",summary:`${p.Employee_Name}`,detail:`${p.message}`,life:3e3})}),setTimeout(()=>{window.location.replace(window.location.origin+"/manageEmployees")},4e3))}).finally(()=>{})):i.add({severity:"error",summary:"Failure!",detail:"Clear error fields",life:3e3})};function B(s){return s.filter((a,n)=>s.indexOf(a)!==n)}let U=r([]),j=r([]),H=r([]),K=r([]),z=r([]),W=r([]);const q=s=>{s.forEach(a=>{U.value.push(a["Employee Code"]),j.value.push(a.Email),H.value.push(a["Mobile Number"]),K.value.push(a["Pan No"]),z.value.push(a.Aadhar),W.value.push(a["Account No"])})},Z=(s,a)=>!!B(s).includes(a),ee=(s,a)=>(console.log(a),!!s.includes(a)),oe=s=>(console.log("loan Amount:"+b(s)),!(b(s)<=0)),se=r([{id:"1",name:"Salary advance"},{id:"2",name:"Interest free loan"},{id:"3",name:"Travel advance"},{id:"4",name:"Interest with loan"}]),te=(s,a,n)=>{if(s){let p=b(a)-b(n);return console.log(b(s)==p),b(s)!=p}},ae=(s,a,n)=>{if(s){let p=b(a)/b(n);return b(s)!=p}},b=s=>{if(s){console.log(s.split(".")[0]);var a=s.split(".")[0],n=a.match(/\d/g);if(n)return n=n.join(""),console.log(`convertRupeeIntoNumber${n}`),parseInt(n)}},Q=s=>(console.log(g.value),[]);return{getCurrentlyImportedTableDuplicateEntries:q,currentlyImportedTableEmployeeCodeValues:U,findCurrentTableDups:Z,uploadOnboardingFile:e,type:N,currentlyImportedTableAadharValues:z,currentlyImportedTablePanValues:K,currentlyImportedTableAccNoValues:W,currentlyImportedTableEmailValues:j,currentlyImportedTableMobileNumberValues:H,loanAmount:oe,loanTypes:se,findBalanceAmount:te,findEmiCalculation:ae,isExistsOrNot:ee,convertExcelIntoArray:t,EmployeeSalaryAdvanceDynamicHeader:E,EmployeeSalaryAdvanceSource:d,getValidationMessages:Q,getExcelForUpload:C,canShowloading:y}}),Xe={class:"grid w-10/12 grid-cols-3 mx-auto my-2 place-content-center"},Ze={class:"flex"},eo=l("label",{class:"p-2 font-semibold border-gray-500 rounded-lg cursor-pointer border-1 fs-6",for:"file"},[l("i",{class:"px-2 pi pi-folder",style:{"font-size":"1rem"}}),ce("Browse")],-1),oo=pe('<div class="p-2 mx-6 font-semibold text-black bg-white rounded-lg fs-6">Total Records : <span class="font-bold"> 2324 </span></div><div class="p-2 mx-6 font-semibold text-black bg-green-100 rounded-lg fs-6">Processed Records : <span class="font-bold"> 2342 </span></div><div class="p-2 mx-6 font-semibold text-black bg-red-100 rounded-lg fs-6">Error Records : <span class="font-bold"> 12313 </span></div>',3),so=l("div",{class:"py-5"},[l("p",{class:"font-semibold fs-6"},"Sample format:"),l("div",{class:"table-responsive"})],-1),to={class:"table-responsive"},ao=l("p",{class:"font-semibold fs-6"},"Original data:",-1),no={key:0},ro={class:"font-semibold fs-6"},lo={key:1},io={class:"font-semibold fs-6"},co={class:"font-semibold fs-6"},po={key:3},uo={class:"font-semibold fs-6"},mo={class:"font-semibold fs-6"},fo={class:"font-semibold fs-6"},_o={class:"font-semibold fs-6"},yo={key:7,class:"font-semibold fs-6"},vo={__name:"import_salary_advance",setup(y){Y();const i=X(),d=S=>{let{data:v,newValue:m,field:g}=S;switch(g){case"quantity":case"price":isPositiveInteger(m)?v[g]=m:S.preventDefault();break;default:m.trim().length>0?v[g]=m:S.preventDefault();break}},E=["SALARY ADVANCE","INTEREST FREE LOAN","TRAVEL ADVANCE","INTEREST wITH LOAN"];return(S,v)=>{const m=T("InputText"),g=T("Column"),N=T("DataTable");return c(),u(M,null,[l("div",Xe,[l("div",Ze,[eo,l("input",{type:"file",name:"",id:"file",hidden:"",onChange:v[0]||(v[0]=C=>_(i).convertExcelIntoArray(C)),accept:".xls, .xlsx"},null,32)]),oo]),so,l("div",to,[ao,w(N,{class:"py-4",value:_(i).EmployeeSalaryAdvanceSource,tableStyle:" min-width: 50rem",responsiveLayout:"scroll",stateStorage:"session",stateKey:"dt-state-demo-session",editMode:"cell",onCellEditComplete:d,rows:_(i).EmployeeSalaryAdvanceSource},{default:A(()=>[(c(!0),u(M,null,le(_(i).EmployeeSalaryAdvanceDynamicHeader,C=>(c(),ie(g,{key:C.title,field:C.title,style:{"min-width":"12rem"},header:C.title},{body:A(({data:t,field:e})=>[e.includes("Employee Code")?(c(),u("div",no,[l("p",ro,x(t[e]?t[e]:"-"),1)])):e.includes("Legal Entity")?(c(),u("div",lo,[l("p",io,x(t[e]?t[e]:"-"),1)])):e.includes("Loan Type")?(c(),u("div",{key:2,class:V([_(i).isExistsOrNot(E,t[e].toUpperCase())?"bg-red-100 p-2 rounded-lg":""])},[l("p",co,x(t[e]?t[e]:"-"),1)],2)):e.includes("Category")?(c(),u("div",po,[l("p",uo,x(t[e]?t[e]:"-"),1)])):e.includes("Loan Amount")?(c(),u("div",{key:4,class:V([_(i).loanAmount(t[e])?"bg-red-100 p-2 rounded-lg":""])},[l("p",mo,x(t[e]?t[e]:"-"),1)],2)):e.includes("Balance")?(c(),u("div",{key:5,class:V([_(i).findBalanceAmount(t[e],t["Loan Amount"],t["Repayment Made"])?"bg-red-100 p-2 rounded-lg":""])},[l("p",fo,x(t[e]?t[e]:"-"),1)],2)):e.includes("EMI")?(c(),u("div",{key:6,class:V([_(i).findEmiCalculation(t[e],t.Balance,t.Tenure)?"bg-red-100 p-2 rounded-lg":""])},[l("p",_o,x(t[e]?t[e]:"-"),1)],2)):(c(),u("p",yo,x(t[e]?t[e]:"-"),1))]),editor:A(({data:t,field:e})=>[w(m,{modelValue:t[e],"onUpdate:modelValue":B=>t[e]=B},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","header"]))),128))]),_:1},8,["value","rows"])])],64)}}};const go=y=>(me("data-v-f282f4f1"),y=y(),fe(),y),bo=go(()=>l("h5",{style:{"text-align":"center"}},"Please wait...",-1)),ho={__name:"salary_advance_excel_import",setup(y){const i=X();return Y(),r(null),Qe(),(d,E)=>{const S=T("Toast");T("Column"),T("DataTable");const v=T("ProgressSpinner"),m=T("Dialog");return c(),u(M,null,[w(S),ue("",!0),w(de,{name:"fade",mode:"out-in"},{default:A(()=>[w(m,{header:"Header",visible:_(i).canShowloading,"onUpdate:visible":E[2]||(E[2]=g=>_(i).canShowloading=g),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:A(()=>[w(v,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:A(()=>[bo]),_:1},8,["visible"])]),_:1}),w(vo)],64)}}},So=Ye(ho,[["__scopeId","data-v-f282f4f1"]]),o=_e(So),xo=we();o.use(ye,{ripple:!0});o.use(Be);o.use(J);o.use(Ve);o.use(J);o.use(xo);o.directive("tooltip",Ne);o.directive("badge",Ie);o.directive("ripple",ve);o.directive("styleclass",ke);o.directive("focustrap",ge);o.component("Button",be);o.component("RadioButton",Ke);o.component("DataTable",Re);o.component("Column",he);o.component("ColumnGroup",Oe);o.component("Row",Fe);o.component("Toast",De);o.component("ConfirmDialog",$e);o.component("Dropdown",Se);o.component("InputText",xe);o.component("Dialog",Te);o.component("ProgressSpinner",Pe);o.component("Calendar",Le);o.component("Textarea",Me);o.component("Chips",Ue);o.component("MultiSelect",je);o.component("InputNumber",Ee);o.component("SelectButton",He);o.component("Checkbox",ze);o.component("OrganizationChart",We);o.mount("#salary_advance_excel_import");
