/* empty css              *//* empty css                   *//* empty css                 */import{Q as n,g as C,o as p,c as u,d as l,aa as f,h as B,w as R,F as U,f as ce,b as ie,t as h,n as V,l as pe,am as ue,a as me,H as de,P as fe,R as _e,u as ye,x as ve,I as be,K as ge,M as he,J as xe,L as Se}from"./inputnumber.esm-e362c3ab.js";import{d as Ee,c as Te}from"./pinia-641035e3.js";import{u as Ce,a as X,T as Ne,B as Ae,S as Ie,b as $e,s as De}from"./toastservice.esm-8d63d505.js";import"./blockui.esm-da95937b.js";import{a as ke}from"./datatable.esm-5f85e77a.js";import{D as Re,s as Ve}from"./dialogservice.esm-acafdb8a.js";import{C as Be}from"./confirmationservice.esm-62abe3ae.js";import{s as Fe}from"./progressspinner.esm-dd1a9f95.js";import{s as Le}from"./row.esm-6ebc942e.js";import{s as Oe}from"./calendar.esm-871de032.js";import{s as Me}from"./textarea.esm-36dc9b1f.js";import{s as Pe}from"./chips.esm-94e18b40.js";import{s as je}from"./multiselect.esm-774f4ea4.js";import{s as Ue}from"./selectbutton.esm-5571bcb8.js";import{s as He}from"./radiobutton.esm-c9a3c1dd.js";import{s as Ke}from"./checkbox.esm-71be7f27.js";import{s as ze}from"./organizationchart.esm-a73c3d43.js";import{u as We,a as qe}from"./vue-router-7a52ee16.js";import{a as Ge}from"./index-362795f3.js";import{r as Je,u as w}from"./xlsx-4ad528ac.js";import"./dayjs.min-2f06af28.js";import{S as Z}from"./Service-4ef425c0.js";import{_ as Qe}from"./_plugin-vue_export-helper-c27b6911.js";const ee=Ee("useImportSalaryAdvance",()=>{We();const F=n(!1),c=Ce(),m=n(),E=n(),T=n(),_=n([]),v=n([]);n(!1),n(!1);const x=n(),L=n(),b=e=>{T.value=e.target.files[0]},t=(e,a)=>{if(e){var r=e.target.files[0];if(!r)return;var g=new FileReader;g.onload=function(N){const S=g.result;var $=Je(S,{type:"binary",cellDates:!0,dateNF:"dd-mm-yyyy"}),Y=$.Sheets[$.SheetNames[0]];let M=[];const D={},P=w.decode_range(Y["!ref"]);let y;const le=P.s.r;for(y=P.s.c;y<=P.e.c;++y){const d=Y[w.encode_cell({c:y,r:le})];let I="UNKNOWN "+y;d&&d.t&&(I=w.format_cell(d)),D[y]=I;let j={title:D[y],value:D[y]};D[y].includes("UNKNOWN")||M.push(j)}E.value=M,console.log(M);const A=$.SheetNames.reduce((d,I)=>{const j=$.Sheets[I];return d[I]=w.sheet_to_json(j,{raw:!1,dateNF:"dd-mm-yyyy"}),d},{}),k=Object.keys(A)[0];A[k]?m.value=A[k]:m.value=[],m.value&&J(m.value),_.value.push(m.value);for(let d=0;d<A[k].length;d++)console.log("jsonData['Sheet1'].length :",A[k].length),Q(m.value[d])},g.readAsArrayBuffer(r)}else c.add({severity:"error",summary:"file missing!",detail:"selected",life:2e3})},s=e=>{let a="/updateEmployeeLeaveBalanceData";v.value==0?Ge.post(a,e).then(r=>{r.data.status=="failure"?c.add({severity:"error",summary:"failure",detail:`${r.data.message}`,life:3e3}):r.data.status=="success"&&r.data.data.forEach(g=>{c.add({severity:"success",summary:`${g.Employee_Name}`,detail:`${g.message}`,life:3e3})})}).finally(()=>{}):c.add({severity:"error",summary:"Failure!",detail:"Clear error fields",life:3e3})};function O(e){return e.filter((a,r)=>e.indexOf(a)!==r)}let H=n([]),K=n([]),z=n([]),W=n([]),q=n([]),G=n([]);const J=e=>{e.forEach(a=>{H.value.push(a["Employee Code"]),K.value.push(a.Email),z.value.push(a["Mobile Number"]),W.value.push(a["Pan No"]),q.value.push(a.Aadhar),G.value.push(a["Account No"])})},se=(e,a)=>!!O(e).includes(a),oe=(e,a)=>(console.log(a),!!e.includes(a)),te=e=>i(e)<=0,ae=n([{id:"1",name:"Salary advance"},{id:"2",name:"Interest free loan"},{id:"3",name:"Travel advance"},{id:"4",name:"Interest with loan"}]),re=(e,a,r)=>{if(console.log({balance:e,loanAmt:a,Repayment:r}),console.log(`loanAmount${i(a)}`),console.log(`repaymentAmount${i(r)}`),e){let S;var N=/\d/.test(r);return N?(S=i(a)-i(r),i(e)!=S):(S=i(a),console.log("======Balance====="+S),i(e)!=S)}console.log(i(e)==balance)},ne=(e,a,r)=>{if(console.log({emi:e,balance:a,tenure:r}),e){let N=i(a)/i(r);return console.log("Actual emi:"+i(e)),console.log("subbed emi:"+N),i(e)!=N}},i=e=>{if(e){console.log(e.split(".")[0]);var a=e.split(".")[0],r=a.match(/\d/g);if(r)return r=r.join(""),console.log(`convertRupeeIntoNumber${r}`),parseInt(r)}},Q=e=>(console.log(x.value),[]);return{getCurrentlyImportedTableDuplicateEntries:J,currentlyImportedTableEmployeeCodeValues:H,findCurrentTableDups:se,uploadOnboardingFile:s,type:L,currentlyImportedTableAadharValues:q,currentlyImportedTablePanValues:W,currentlyImportedTableAccNoValues:G,currentlyImportedTableEmailValues:K,currentlyImportedTableMobileNumberValues:z,loanAmount:te,loanTypes:ae,findBalanceAmount:re,findEmiCalculation:ne,isExistsOrNot:oe,convertExcelIntoArray:t,EmployeeSalaryAdvanceDynamicHeader:E,EmployeeSalaryAdvanceSource:m,getValidationMessages:Q,getExcelForUpload:b,canShowloading:F}}),Ye={class:"grid w-10/12 grid-cols-3 mx-auto my-2 place-content-center"},Xe={class:"flex"},Ze=l("label",{class:"p-2 font-semibold border-gray-500 rounded-lg cursor-pointer border-1 fs-6",for:"file"},[l("i",{class:"px-2 pi pi-folder",style:{"font-size":"1rem"}}),pe("Browse")],-1),es=ue('<div class="p-2 mx-6 font-semibold text-black bg-white rounded-lg fs-6">Total Records : <span class="font-bold"> 2324 </span></div><div class="p-2 mx-6 font-semibold text-black bg-green-100 rounded-lg fs-6">Processed Records : <span class="font-bold"> 2342 </span></div><div class="p-2 mx-6 font-semibold text-black bg-red-100 rounded-lg fs-6">Error Records : <span class="font-bold"> 12313 </span></div>',3),ss=l("div",{class:"py-5"},[l("p",{class:"font-semibold fs-6"},"Sample format:"),l("div",{class:"table-responsive"})],-1),os={class:"table-responsive"},ts=l("p",{class:"font-semibold fs-6"},"Original data:",-1),as={key:0},rs={class:"font-semibold fs-6"},ns={key:1},ls={class:"font-semibold fs-6"},cs={class:"font-semibold fs-6"},is={key:3},ps={class:"font-semibold fs-6"},us={class:"font-semibold fs-6"},ms={class:"font-semibold fs-6"},ds={class:"font-semibold fs-6"},fs={key:7,class:"font-semibold fs-6"},_s={__name:"import_salary_advance",setup(F){Z();const c=ee(),m=T=>{let{data:_,newValue:v,field:x}=T;switch(x){case"quantity":case"price":isPositiveInteger(v)?_[x]=v:T.preventDefault();break;default:v.trim().length>0?_[x]=v:T.preventDefault();break}},E=["SALARY ADVANCE","INTEREST FREE LOAN","TRAVEL ADVANCE","INTEREST wITH LOAN"];return(T,_)=>{const v=C("InputText"),x=C("Column"),L=C("DataTable");return p(),u(U,null,[l("div",Ye,[l("div",Xe,[Ze,l("input",{type:"file",name:"",id:"file",hidden:"",onChange:_[0]||(_[0]=b=>f(c).convertExcelIntoArray(b)),accept:".xls, .xlsx"},null,32)]),es]),ss,l("div",os,[ts,B(L,{class:"py-4",value:f(c).EmployeeSalaryAdvanceSource,tableStyle:" min-width: 50rem",responsiveLayout:"scroll",stateStorage:"session",stateKey:"dt-state-demo-session",editMode:"cell",onCellEditComplete:m,rows:f(c).EmployeeSalaryAdvanceSource},{footer:R(()=>[l("button",{class:"flex justify-center mx-auto btn btn-orange",onClick:_[1]||(_[1]=b=>f(c).uploadOnboardingFile(f(c).EmployeeSalaryAdvanceSource))},"Upload")]),default:R(()=>[(p(!0),u(U,null,ce(f(c).EmployeeSalaryAdvanceDynamicHeader,b=>(p(),ie(x,{key:b.title,field:b.title,style:{"min-width":"12rem"},header:b.title},{body:R(({data:t,field:s})=>[s.includes("Employee Code")?(p(),u("div",as,[l("p",rs,h(t[s]?t[s]:"-"),1)])):s.includes("Legal Entity")?(p(),u("div",ns,[l("p",ls,h(t[s]?t[s]:"-"),1)])):s.includes("Loan Type")?(p(),u("div",{key:2,class:V([f(c).isExistsOrNot(E,t[s].toUpperCase())?"bg-red-100 p-2 rounded-lg":""])},[l("p",cs,h(t[s]?t[s]:"-"),1)],2)):s.includes("Category")?(p(),u("div",is,[l("p",ps,h(t[s]?t[s]:"-"),1)])):s.includes("Loan Amount")?(p(),u("div",{key:4,class:V([f(c).loanAmount(t[s])?"bg-red-100 p-2 rounded-lg":""])},[l("p",us,h(t[s]?t[s]:"-"),1)],2)):s.includes("Balance")?(p(),u("div",{key:5,class:V([f(c).findBalanceAmount(t[s],t["Loan Amount"],t["Repayment Made"])?"bg-red-100 p-2 rounded-lg":""])},[l("p",ms,h(t[s]?t[s]:"-"),1)],2)):s.includes("EMI")?(p(),u("div",{key:6,class:V([f(c).findEmiCalculation(t[s],t.Balance,t.Tenure)?"bg-red-100 p-2 rounded-lg":""])},[l("p",ds,h(t[s]?t[s]:"-"),1)],2)):(p(),u("p",fs,h(t[s]?t[s]:"-"),1))]),editor:R(({data:t,field:s})=>[B(v,{modelValue:t[s],"onUpdate:modelValue":O=>t[s]=O},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","header"]))),128))]),_:1},8,["value","rows"])])],64)}}};const ys={__name:"salary_advance_excel_import",setup(F){return we,ee(),Z(),n(null),qe(),(c,m)=>{const E=C("Toast");return C("Column"),C("DataTable"),p(),u(U,null,[B(E),me("",!0),B(_s)],64)}}},vs=Qe(ys,[["__scopeId","data-v-5a3198a5"]]),o=de(vs),bs=Te();o.use(fe,{ripple:!0});o.use(Be);o.use(X);o.use(Re);o.use(X);o.use(bs);o.directive("tooltip",Ne);o.directive("badge",Ae);o.directive("ripple",_e);o.directive("styleclass",Ie);o.directive("focustrap",ye);o.component("Button",ve);o.component("RadioButton",He);o.component("DataTable",ke);o.component("Column",be);o.component("ColumnGroup",Ve);o.component("Row",Le);o.component("Toast",$e);o.component("ConfirmDialog",De);o.component("Dropdown",ge);o.component("InputText",he);o.component("Dialog",xe);o.component("ProgressSpinner",Fe);o.component("Calendar",Oe);o.component("Textarea",Me);o.component("Chips",Pe);o.component("MultiSelect",je);o.component("InputNumber",Se);o.component("SelectButton",Ue);o.component("Checkbox",Ke);o.component("OrganizationChart",ze);o.mount("#salary_advance_excel_import");
