import{B as x,X as ee,E as te,c as F,h as s,w as i,W as k,a0 as j,e as b,K as E,g as C,o as O,t as M,j as R,n as I,a as ae,G as ne,P as re,H as oe,R as se,q as ie}from"./toastservice.esm-c4f6de4c.js";import{T as le,B as ue,S as de,b as me,a as ce}from"./styleclass.esm-ea560a03.js";import"./blockui.esm-85692cd0.js";import{u as pe,C as ye,F as fe,b as ve,s as ge,a as he}from"./inputtext.esm-5faf66bf.js";import{s as _e}from"./confirmdialog.esm-51539a4d.js";import{D as Te}from"./dialogservice.esm-b46cc252.js";import{s as De}from"./toast.esm-8d255b70.js";import{s as we}from"./progressspinner.esm-455f2fd3.js";import{s as Me}from"./row.esm-6ebc942e.js";import{s as be}from"./columngroup.esm-9dd1458e.js";import{s as Se}from"./tag.esm-82557d24.js";import{s as Ne}from"./overlaypanel.esm-e6b90e82.js";import{a as Y}from"./index-f7a317fc.js";var Ce=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,xe=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,ke=/[^-+\dA-Z]/g;function B(n,o,r,m){if(arguments.length===1&&typeof n=="string"&&!/\d/.test(n)&&(o=n,n=void 0),n=n||n===0?n:new Date,n instanceof Date||(n=new Date(n)),isNaN(n))throw TypeError("Invalid date");o=String(Z[o]||o||Z.default);var h=o.slice(0,4);(h==="UTC:"||h==="GMT:")&&(o=o.slice(4),r=!0,h==="GMT:"&&(m=!0));var a=function(){return r?"getUTC":"get"},f=function(){return n[a()+"Date"]()},T=function(){return n[a()+"Day"]()},_=function(){return n[a()+"Month"]()},D=function(){return n[a()+"FullYear"]()},c=function(){return n[a()+"Hours"]()},p=function(){return n[a()+"Minutes"]()},A=function(){return n[a()+"Seconds"]()},P=function(){return n[a()+"Milliseconds"]()},w=function(){return r?0:n.getTimezoneOffset()},H=function(){return Ae(n)},L=function(){return Pe(n)},W={d:function(){return f()},dd:function(){return g(f())},ddd:function(){return y.dayNames[T()]},DDD:function(){return J({y:D(),m:_(),d:f(),_:a(),dayName:y.dayNames[T()],short:!0})},dddd:function(){return y.dayNames[T()+7]},DDDD:function(){return J({y:D(),m:_(),d:f(),_:a(),dayName:y.dayNames[T()+7]})},m:function(){return _()+1},mm:function(){return g(_()+1)},mmm:function(){return y.monthNames[_()]},mmmm:function(){return y.monthNames[_()+12]},yy:function(){return String(D()).slice(2)},yyyy:function(){return g(D(),4)},h:function(){return c()%12||12},hh:function(){return g(c()%12||12)},H:function(){return c()},HH:function(){return g(c())},M:function(){return p()},MM:function(){return g(p())},s:function(){return A()},ss:function(){return g(A())},l:function(){return g(P(),3)},L:function(){return g(Math.floor(P()/10))},t:function(){return c()<12?y.timeNames[0]:y.timeNames[1]},tt:function(){return c()<12?y.timeNames[2]:y.timeNames[3]},T:function(){return c()<12?y.timeNames[4]:y.timeNames[5]},TT:function(){return c()<12?y.timeNames[6]:y.timeNames[7]},Z:function(){return m?"GMT":r?"UTC":He(n)},o:function(){return(w()>0?"-":"+")+g(Math.floor(Math.abs(w())/60)*100+Math.abs(w())%60,4)},p:function(){return(w()>0?"-":"+")+g(Math.floor(Math.abs(w())/60),2)+":"+g(Math.floor(Math.abs(w())%60),2)},S:function(){return["th","st","nd","rd"][f()%10>3?0:(f()%100-f()%10!=10)*f()%10]},W:function(){return H()},WW:function(){return g(H())},N:function(){return L()}};return o.replace(Ce,function(e){return e in W?W[e]():e.slice(1,e.length-1)})}var Z={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},y={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},g=function(o){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(o).padStart(r,"0")},J=function(o){var r=o.y,m=o.m,h=o.d,a=o._,f=o.dayName,T=o.short,_=T===void 0?!1:T,D=new Date,c=new Date;c.setDate(c[a+"Date"]()-1);var p=new Date;p.setDate(p[a+"Date"]()+1);var A=function(){return D[a+"Date"]()},P=function(){return D[a+"Month"]()},w=function(){return D[a+"FullYear"]()},H=function(){return c[a+"Date"]()},L=function(){return c[a+"Month"]()},W=function(){return c[a+"FullYear"]()},e=function(){return p[a+"Date"]()},u=function(){return p[a+"Month"]()},d=function(){return p[a+"FullYear"]()};return w()===r&&P()===m&&A()===h?_?"Tdy":"Today":W()===r&&L()===m&&H()===h?_?"Ysd":"Yesterday":d()===r&&u()===m&&e()===h?_?"Tmw":"Tomorrow":f},Ae=function(o){var r=new Date(o.getFullYear(),o.getMonth(),o.getDate());r.setDate(r.getDate()-(r.getDay()+6)%7+3);var m=new Date(r.getFullYear(),0,4);m.setDate(m.getDate()-(m.getDay()+6)%7+3);var h=r.getTimezoneOffset()-m.getTimezoneOffset();r.setHours(r.getHours()-h);var a=(r-m)/(864e5*7);return 1+Math.floor(a)},Pe=function(o){var r=o.getDay();return r===0&&(r=7),r},He=function(o){return(String(o).match(xe)||[""]).pop().replace(ke,"").replace(/GMT\+0000/g,"UTC")};const Le=b("h5",{style:{"text-align":"center"}},"Please wait...",-1),Re=b("h5",{style:{"text-align":"center"}},"Please wait...",-1),We={class:"confirmation-content"},Fe=b("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Oe={class:"confirmation-content"},Ue=b("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),$e={key:0},Ee={key:1},Ve={key:1},je={key:0},Be={__name:"LeaveApproval",setup(n){let o=x(),r=x(!1),m=x(!1),h=x(),a=x(!1);pe(),ee();const f=x({global:{value:null,matchMode:E.CONTAINS},employee_name:{value:null,matchMode:E.STARTS_WITH,matchMode:E.EQUALS,matchMode:E.CONTAINS},status:{value:"Pending",matchMode:E.EQUALS}}),T=x(!0),_=x(["Pending","Approved","Rejected"]),D=x(),c=u=>{D.value.toggle(u)};let p=null,A=null;te(()=>{P()});function P(){let u=window.location.origin+"/fetch-leaverequests/org/Approved,Rejected,Pending";Y.get(u).then(d=>{o.value=d.data,T.value=!1})}function w(u,d){m.value=!1,r.value=!0,p=d,A=u}function H(u){r.value=!1,u&&L()}function L(){p="",A=null}function W(){H(!1),a.value=!0,Y.post(window.location.origin+"/attendance-approve-rejectleave",{record_id:A.id,status:p=="Approve"?"Approved":p=="Reject"?"Rejected":p,review_comment:""}).then(u=>{if(console.log(u),L(),a.value=!1,u.data.status=="success")P();else if(u.data.status=="failure"){m.value=!0,h.value=u.data.message;return}}).catch(u=>{a.value=!1,L(),console.log(u.toJSON())})}const e=u=>{switch(u){case"Rejected":return"danger";case"Approved":return"success";case"Pending":return"warning"}};return(u,d)=>{const S=C("Toast"),z=C("ProgressSpinner"),V=C("Dialog"),U=C("Button"),G=C("InputText"),N=C("Column"),q=C("OverlayPanel"),K=C("Tag"),Q=C("Dropdown"),X=C("DataTable");return O(),F("div",null,[s(S),s(V,{header:"Header",visible:T.value,"onUpdate:visible":d[0]||(d[0]=t=>T.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:i(()=>[s(z,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:i(()=>[Le]),_:1},8,["visible"]),s(V,{header:"Header",visible:k(a),"onUpdate:visible":d[1]||(d[1]=t=>j(a)?a.value=t:a=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:i(()=>[s(z,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:i(()=>[Re]),_:1},8,["visible"]),s(V,{header:"Confirmation",visible:k(r),"onUpdate:visible":d[4]||(d[4]=t=>j(r)?r.value=t:r=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:i(()=>[s(U,{label:"Yes",icon:"pi pi-check",onClick:d[2]||(d[2]=t=>W()),class:"p-button-text",autofocus:""}),s(U,{label:"No",icon:"pi pi-times",onClick:d[3]||(d[3]=t=>H(!0)),class:"p-button-text"})]),default:i(()=>[b("div",We,[Fe,b("span",null,"Are you sure you want to "+M(k(p))+"?",1)])]),_:1},8,["visible"]),s(V,{header:"Error",visible:k(m),"onUpdate:visible":d[5]||(d[5]=t=>j(m)?m.value=t:m=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:i(()=>[s(U,{label:"Ok",icon:"pi pi-check",autofocus:""})]),default:i(()=>[b("div",Oe,[Ue,b("span",null,"Error while processing the request : "+M(k(h)),1)])]),_:1},8,["visible"]),b("div",null,[s(X,{value:k(o),paginator:!0,rows:10,dataKey:"id",rowsPerPageOptions:[5,10,25],paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",filters:f.value,"onUpdate:filters":d[6]||(d[6]=t=>f.value=t),filterDisplay:"menu",loading:u.loading2,globalFilterFields:["name","status"],style:{"white-space":"nowrap"}},{empty:i(()=>[R(" No Employee found ")]),loading:i(()=>[R(" Loading customers data. Please wait. ")]),default:i(()=>[s(N,{class:"font-bold",field:"employee_name",header:"Employee Name",style:{"min-width":"18em"}},{body:i(t=>[R(M(t.data.employee_name),1)]),filter:i(({filterModel:t,filterCallback:$})=>[s(G,{modelValue:t.value,"onUpdate:modelValue":v=>t.value=v,onInput:v=>$(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),s(N,{field:"leaverequest_date",header:"Date",sortable:!0},{body:i(t=>[R(M(k(B)(t.data.leaverequest_date,"dd-mm-yyyy, h:MM TT")),1)]),_:1}),s(N,{field:"leave_type",header:"Leave Type"}),s(N,{field:"start_date",header:"Start Time"},{body:i(t=>[R(M(k(B)(t.data.start_date,"dd-mm-yyyy, h:MM TT")),1)]),_:1}),s(N,{field:"end_date",header:"End Time"},{body:i(t=>[R(M(k(B)(t.data.end_date,"dd-mm-yyyy, h:MM TT")),1)]),_:1}),s(N,{field:"leave_reason",header:"Leave Reason",style:{"min-width":"25em","white-space":"pre-wrap"}},{body:i(t=>[t.data.leave_reason.length>80?(O(),F("div",$e,[b("p",{onClick:c,class:"font-medium text-orange-400 underline cursor-pointer"},"explore more... "),s(q,{ref_key:"overlayPanel",ref:D,style:{height:"80px"}},{default:i(()=>[R(M(t.data.leave_reason),1)]),_:2},1536)])):(O(),F("div",Ee,M(t.data.leave_reason),1))]),_:1}),s(N,{field:"reviewer_name",header:"Approver Name"}),s(N,{field:"reviewer_comments",header:"Approver Comments"}),s(N,{field:"status",header:"Status",icon:"pi pi-check"},{body:i(({data:t})=>[s(K,{value:t.status,severity:e(t.status)},null,8,["value","severity"])]),filter:i(({filterModel:t,filterCallback:$})=>[s(Q,{modelValue:t.value,"onUpdate:modelValue":v=>t.value=v,onChange:v=>$(),options:_.value,placeholder:"Select",class:"p-column-filter",showClear:!0},{value:i(v=>[v.value?(O(),F("span",{key:0,class:I("customer-badge status-"+v.value)},M(v.value),3)):(O(),F("span",Ve,M(v.placeholder),1))]),option:i(v=>[b("span",{class:I("customer-badge status-"+v.option)},M(v.option),3)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","options"])]),_:1}),s(N,{style:{width:"300px"},field:"",header:"Action"},{body:i(t=>[t.data.status=="Pending"?(O(),F("span",je,[s(U,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:$=>w(t.data,"Approve"),style:{height:"2em"}},null,8,["onClick"]),s(U,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2em"},onClick:$=>w(t.data,"Reject")},null,8,["onClick"])])):ae("",!0)]),_:1})]),_:1},8,["value","filters","loading"])])])}}},l=ne(Be);l.use(re,{ripple:!0});l.use(ye);l.use(oe);l.use(Te);l.directive("tooltip",le);l.directive("badge",ue);l.directive("ripple",se);l.directive("styleclass",de);l.directive("focustrap",fe);l.component("Button",ie);l.component("DataTable",me);l.component("Column",ce);l.component("ColumnGroup",be);l.component("Row",Me);l.component("Toast",De);l.component("ConfirmDialog",_e);l.component("Dropdown",ve);l.component("InputText",ge);l.component("Dialog",he);l.component("ProgressSpinner",we);l.component("Tag",Se);l.component("OverlayPanel",Ne);l.mount("#VJS_LeaveApproval");
