import{B as d,X as E,E as H,c as w,h as t,w as s,W as b,a0 as L,e as r,K as g,g as i,o as y,t as m,j as k,n as P,a as J,G as W,P as z,H as G,R as K,q as Q}from"./toastservice.esm-c719b254.js";import{T as X,B as q,S as Y,b as Z,a as ee}from"./styleclass.esm-abc35d43.js";import"./blockui.esm-3f60d243.js";import{u as te,C as oe,F as ae,a as se,b as ne,s as le}from"./inputtext.esm-af9c7539.js";import{s as ie}from"./confirmdialog.esm-a2dedb11.js";import{s as re}from"./toast.esm-d0b492e3.js";import{s as pe}from"./progressspinner.esm-bd35d97e.js";import{a as $}from"./index-f7a317fc.js";const ce=r("h5",{style:{"text-align":"center"}},"Please wait...",-1),ue=r("h5",{style:{"text-align":"center"}},"Please wait...",-1),de={class:"confirmation-content"},me=r("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),ve={key:1},fe={key:0},ge={__name:"PMSApprovalTable",setup(_e){let T=d(),c=d(!1),p=d(!1);te();const B=E(),S=d(!0),A=d({global:{value:null,matchMode:g.CONTAINS},employee_name:{value:null,matchMode:g.STARTS_WITH,matchMode:g.EQUALS,matchMode:g.CONTAINS},status:{value:null,matchMode:g.EQUALS}}),M=d(["Pending","Approved","Rejected"]);let u=null,_=null;H(()=>{D()});function D(){let n=window.location.origin+"/fetch_approvals_pmsforms";console.log("AJAX URL : "+n),$.get(n).then(a=>{console.log("Axios : "+a.data),T.value=a.data,S.value=!1})}function R(n,a){c.value=!0,u=a,_=n,console.log("Selected Row Data : "+JSON.stringify(n))}function N(n){c.value=!1,n&&C()}function C(){u="",_=null}function U(){N(!1),p.value=!0,console.log("Processing Rowdata : "+JSON.stringify(_)),$.post(window.location.origin+"/approvals-pms",{kpiform_review_id:_.pms_kpiform_review_id,status:u=="Approve"?"Approved":u=="Reject"?"Rejected":u}).then(n=>{console.log("Response : "+n),p.value=!1,B.add({severity:"success",summary:"Info",detail:"Success",life:3e3}),D(),C()}).catch(n=>{p.value=!1,C(),console.log(n.toJSON())})}return(n,a)=>{const j=i("Toast"),V=i("ProgressSpinner"),x=i("Dialog"),h=i("Button"),I=i("InputText"),v=i("Column"),O=i("Dropdown"),F=i("DataTable");return y(),w("div",null,[t(j),t(x,{header:"Header",visible:S.value,"onUpdate:visible":a[0]||(a[0]=e=>S.value=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[t(V,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[ce]),_:1},8,["visible"]),t(x,{header:"Header",visible:b(p),"onUpdate:visible":a[1]||(a[1]=e=>L(p)?p.value=e:p=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[t(V,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[ue]),_:1},8,["visible"]),t(x,{header:"Confirmation",visible:b(c),"onUpdate:visible":a[4]||(a[4]=e=>L(c)?c.value=e:c=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:s(()=>[t(h,{label:"Yes",icon:"pi pi-check",onClick:a[2]||(a[2]=e=>U()),class:"p-button-text",autofocus:""}),t(h,{label:"No",icon:"pi pi-times",onClick:a[3]||(a[3]=e=>N(!0)),class:"p-button-text"})]),default:s(()=>[r("div",de,[me,r("span",null,"Are you sure you want to "+m(b(u))+"?",1)])]),_:1},8,["visible"]),r("div",null,[t(F,{value:b(T),paginator:!0,rows:10,dataKey:"id",rowsPerPageOptions:[5,10,25],paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",filters:A.value,"onUpdate:filters":a[5]||(a[5]=e=>A.value=e),filterDisplay:"menu",loading:n.loading2,globalFilterFields:["name","status"],style:{"white-space":"nowrap"}},{empty:s(()=>[k(" No PMS forms found. ")]),loading:s(()=>[k(" Loading PMS forms data. Please wait. ")]),default:s(()=>[t(v,{class:"font-bold",field:"assignee_name",header:"Assignee Name"},{body:s(e=>[k(m(e.data.assignee_name),1)]),filter:s(({filterModel:e,filterCallback:f})=>[t(I,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onInput:l=>f(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),t(v,{field:"assignment_period",header:"Assignment Period"}),t(v,{field:"reviewer_name",header:"Reviewer Name"}),t(v,{field:"status",header:"Status",icon:"pi pi-check"},{body:s(({data:e})=>[r("span",{class:P("customer-badge status-"+e.status)},m(e.status),3)]),filter:s(({filterModel:e,filterCallback:f})=>[t(O,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onChange:l=>f(),options:M.value,placeholder:"Select",class:"p-column-filter",showClear:!0},{value:s(l=>[l.value?(y(),w("span",{key:0,class:P("customer-badge status-"+l.value)},m(l.value),3)):(y(),w("span",ve,m(l.placeholder),1))]),option:s(l=>[r("span",{class:P("customer-badge status-"+l.option)},m(l.option),3)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","options"])]),_:1}),t(v,{style:{width:"300px"},field:"",header:"Action"},{body:s(e=>[e.data.status=="Pending"?(y(),w("span",fe,[t(h,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:f=>R(e.data,"Approve"),style:{height:"2em"}},null,8,["onClick"]),t(h,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2em"},onClick:f=>R(e.data,"Reject")},null,8,["onClick"])])):J("",!0)]),_:1})]),_:1},8,["value","filters","loading"])])])}}},o=W(ge);o.use(z,{ripple:!0});o.use(oe);o.use(G);o.directive("tooltip",X);o.directive("badge",q);o.directive("ripple",K);o.directive("styleclass",Y);o.directive("focustrap",ae);o.component("Button",Q);o.component("DataTable",Z);o.component("Column",ee);o.component("ConfirmDialog",ie);o.component("Toast",re);o.component("Dialog",se);o.component("Dropdown",ne);o.component("ProgressSpinner",pe);o.component("InputText",le);o.mount("#vjs_pmsApproval_Table");
