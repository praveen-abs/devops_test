import{G as n,K as G,H,a as D,b as h,j as e,g as c,w as s,M as v,V as B,F as U,h as K,S as w,i as g,o as b,t as j,l as E,d as V,I as Q,P as W,J as X,R as q,v as Z}from"./toastservice.esm-6fba28a8.js";import{u as ee,C as te,T as oe,B as ae,S as le,F as ne,c as se,b as ie,e as re,a as ce,d as pe}from"./styleclass.esm-63bffd70.js";import"./blockui.esm-be2bfddc.js";import{s as ue}from"./confirmdialog.esm-99e884c2.js";import{D as de}from"./dialogservice.esm-fa4223e4.js";import{s as me}from"./toast.esm-54e5e2fd.js";import{s as ve}from"./progressspinner.esm-6ca58b04.js";import{s as ge}from"./row.esm-6ebc942e.js";import{s as fe}from"./columngroup.esm-9dd1458e.js";import{s as _e}from"./calendar.esm-adf9e513.js";import{h as F}from"./moment-fbc5633a.js";import{s as he}from"./checkbox.esm-9d34206e.js";const we=c("h5",{style:{"text-align":"center"}},"Please wait...",-1),be={class:"confirmation-content"},ye=c("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Se={key:0},Ce={class:"orders-subtable"},Re={style:{"white-space":"nowrap"}},Ae={key:0},ke=["src"],xe={__name:"review_document",setup(De){let y=n(),m=n(!1),f=n(!1);const A=n(!1);ee();const O=G();n(!0);const T=n([]);n(!1),n(!1);const S=n();n(),n(!0),n({global:{value:null,matchMode:w.CONTAINS},name:{value:null,matchMode:w.STARTS_WITH,matchMode:w.EQUALS,matchMode:w.CONTAINS},status:{value:null,matchMode:w.EQUALS}}),n(["Pending","Approved","Rejected"]);let p=null,C=null;n(!0),H(()=>{y.value=[],R.value=new Date,console.log(R.value),I()});function I(){let o=window.location.origin+"/fetch-onboarded-doc";console.log("AJAX URL : "+o),D.get(o).then(a=>{y.value=a.data,console.log(a.data)})}function _(o,a){m.value=!0,p=a,C=o,console.log("Selected Row Data : "+JSON.stringify(o))}function $(o){m.value=!1,o&&k()}function k(){p="",C=null}const R=n(),J=n();n(!1),n(!1);const N=n(),Y=()=>{let o=new Date(R.value),a=o.getFullYear(),x=o.getMonth()+1;console.log(R.value.toString()),console.log(N),A.value=!0,D.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:a,selected_month:x,selected_status:J.value}).then(u=>{console.log("data sent"),console.log("data from "+u.employee_name),data_reimbursements.value=u.data,N.value=u.data,A.value=!1}).catch(u=>{console.log(u)})};setTimeout(()=>{A.value=!1},3e3);function z(){$(!1),console.log("Processing Rowdata : "+JSON.stringify(C)),console.log("currentlySelectedStatus : "+p),D.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:C,status:p=="Approve"?"Approved":p=="Reject"?"Rejected":p,reviewer_comments:""}).then(o=>{console.log(o),Y(),O.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),k()}).catch(o=>{f.value=!1,k(),console.log(o.toJSON())})}return n(),(o,a)=>{const x=g("Toast"),u=g("ProgressSpinner"),P=g("Dialog"),d=g("Button"),i=g("Column"),L=g("DataTable");return b(),h(U,null,[e(x),c("div",null,[e(P,{header:"Header",visible:v(f),"onUpdate:visible":a[0]||(a[0]=l=>B(f)?f.value=l:f=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[e(u,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[we]),_:1},8,["visible"]),e(P,{header:"Confirmation",visible:v(m),"onUpdate:visible":a[3]||(a[3]=l=>B(m)?m.value=l:m=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:s(()=>[e(d,{label:"Yes",icon:"pi pi-check",onClick:a[1]||(a[1]=l=>z()),class:"p-button-text",autofocus:""}),e(d,{label:"No",icon:"pi pi-times",onClick:a[2]||(a[2]=l=>$(!0)),class:"p-button-text"})]),default:s(()=>[c("div",be,[ye,c("span",null,"Are you sure you want to "+j(v(p))+"?",1)])]),_:1},8,["visible"]),c("div",null,[e(L,{value:v(y),paginator:!0,rows:10,class:"mt-6",dataKey:"user_id",onRowExpand:o.onRowExpand,onRowCollapse:o.onRowCollapse,expandedRows:T.value,"onUpdate:expandedRows":a[5]||(a[5]=l=>T.value=l),selection:S.value,"onUpdate:selection":a[6]||(a[6]=l=>S.value=l),selectAll:o.selectAll,onSelectAllChange:o.onSelectAllChange,onRowSelect:o.onRowSelect,onRowUnselect:o.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:s(()=>[E(" No Reimbursement data for the selected status filter ")]),loading:s(()=>[E(" Loading customers data. Please wait. ")]),expansion:s(l=>[c("div",Ce,[e(L,{value:l.data.onboard_doc,responsiveLayout:"scroll",selection:S.value,"onUpdate:selection":a[4]||(a[4]=r=>S.value=r),selectAll:o.selectAll,onSelectAllChange:o.onSelectAllChange},{default:s(()=>[e(i,{field:"",header:"Date",sortable:""},{body:s(r=>[c("p",Re,j(v(F)(r.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),e(i,{field:"document_name",header:"Document Name"}),e(i,{field:"doc_url",header:"Document Url"}),e(i,{field:"",header:"View"},{body:s(r=>[e(d,{type:"button",icon:"pi pi-eye",class:"p-button-success Button",label:"View",onClick:M=>_(r.data,"Approve"),style:{height:"2em"},text:"",raised:""},null,8,["onClick"])]),_:2},1024),e(i,{field:"",header:"Action"},{body:s(r=>[r.data.has_pending_reimbursements=="true"?(b(),h("span",Ae,[e(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:M=>_(r.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),e(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:M=>_(r.data,"Reject")},null,8,["onClick"])])):V("",!0)]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:s(()=>[e(i,{expander:!0}),e(i,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),e(i,{field:"user_code",header:"Employee Id",sortable:""}),e(i,{field:"employee_name",header:"Employee Name"}),e(i,{class:"fontSize13px",field:"total_distance_travelled",header:"Date Of Joining"}),e(i,{class:"fontSize13px",field:"total_expenses",header:"Approval Status",sortable:!1}),e(i,{field:"",header:"Action"},{body:s(l=>[l.data.has_pending_reimbursements=="true"?(b(),h("span",Se,[e(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:r=>_(l.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),e(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:r=>_(l.data,"Reject")},null,8,["onClick"])])):V("",!0)]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"]),(b(!0),h(U,null,K(v(y),l=>(b(),h("div",{key:l},[c("img",{src:l.doc_url,alt:""},null,8,ke)]))),128))])])],64)}}},t=Q(xe);t.use(W,{ripple:!0});t.use(te);t.use(X);t.use(de);t.directive("tooltip",oe);t.directive("badge",ae);t.directive("ripple",q);t.directive("styleclass",le);t.directive("focustrap",ne);t.component("Button",Z);t.component("DataTable",se);t.component("Column",ie);t.component("ColumnGroup",fe);t.component("Row",ge);t.component("Toast",me);t.component("ConfirmDialog",ue);t.component("Dropdown",re);t.component("InputText",ce);t.component("Dialog",pe);t.component("ProgressSpinner",ve);t.component("Calendar",_e);t.component("moment",F);t.component("Checkbox",he);t.mount("#ReviewDocuments");
