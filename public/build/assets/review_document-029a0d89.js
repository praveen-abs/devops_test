import{G as s,X as Y,H as z,a as x,b as y,j as a,g as r,w as i,_ as d,a3 as $,F as U,h as G,M as g,i as m,o as C,t as B,l as E,d as H,I as Q,P as W,J as X,R as K,v as q}from"./toastservice.esm-00869179.js";import{T as Z,B as ee,S as te,b as oe,a as ae}from"./styleclass.esm-7a6b1127.js";import"./blockui.esm-6b43c010.js";import{F as le,b as se,s as ne,a as ie}from"./inputtext.esm-2f6a5e2d.js";import{s as re}from"./confirmdialog.esm-f4112131.js";import{D as ce}from"./dialogservice.esm-baf8c35b.js";import{s as pe}from"./toast.esm-a9461f00.js";import{u as ue,C as de}from"./confirmationservice.esm-be9d1e76.js";import{s as me}from"./progressspinner.esm-c6e45385.js";import{s as fe}from"./row.esm-6ebc942e.js";import{s as ve}from"./columngroup.esm-9dd1458e.js";import{s as ge}from"./calendar.esm-0d078b66.js";import{h as j}from"./moment-fbc5633a.js";import{s as _e}from"./checkbox.esm-011c2b4b.js";const we=r("h5",{style:{"text-align":"center"}},"Please wait...",-1),he={class:"confirmation-content"},be=r("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Se={key:0},ye={class:"orders-subtable"},Ce={style:{"white-space":"nowrap"}},Re=["src"],Ae={__name:"review_document",setup(De){let _=s(),u=s(!1),f=s(!1);const R=s(!1);ue();const F=Y();s(!0);const k=s([]);s(!1),s(!1);const w=s();s(),s(!0),s({global:{value:null,matchMode:g.CONTAINS},name:{value:null,matchMode:g.STARTS_WITH,matchMode:g.EQUALS,matchMode:g.CONTAINS},status:{value:null,matchMode:g.EQUALS}}),s(["Pending","Approved","Rejected"]);let c=null,h=null;s(!0),z(()=>{_.value=[],b.value=new Date,console.log(b.value),O()});function O(){let t=window.location.origin+"/fetch-onboarded-doc";console.log("AJAX URL : "+t),x.get(t).then(o=>{_.value=o.data,console.log(o.data)})}function T(t,o){u.value=!0,c=o,h=t,console.log("Selected Row Data : "+JSON.stringify(t))}function P(t){u.value=!1,t&&A()}function A(){c="",h=null}const b=s(),V=s();s(!1),s(!1);const N=s(),I=()=>{let t=new Date(b.value),o=t.getFullYear(),D=t.getMonth()+1;console.log(b.value.toString()),console.log(N),R.value=!0,x.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:o,selected_month:D,selected_status:V.value}).then(p=>{console.log("data sent"),console.log("data from "+p.employee_name),data_reimbursements.value=p.data,N.value=p.data,R.value=!1}).catch(p=>{console.log(p)})};setTimeout(()=>{R.value=!1},3e3);function J(){P(!1),console.log("Processing Rowdata : "+JSON.stringify(h)),console.log("currentlySelectedStatus : "+c),x.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:h,status:c=="Approve"?"Approved":c=="Reject"?"Rejected":c,reviewer_comments:""}).then(t=>{console.log(t),I(),F.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),A()}).catch(t=>{f.value=!1,A(),console.log(t.toJSON())})}return s(),(t,o)=>{const D=m("Toast"),p=m("ProgressSpinner"),L=m("Dialog"),S=m("Button"),n=m("Column"),M=m("DataTable");return C(),y(U,null,[a(D),r("div",null,[a(L,{header:"Header",visible:d(f),"onUpdate:visible":o[0]||(o[0]=l=>$(f)?f.value=l:f=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:i(()=>[a(p,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:i(()=>[we]),_:1},8,["visible"]),a(L,{header:"Confirmation",visible:d(u),"onUpdate:visible":o[3]||(o[3]=l=>$(u)?u.value=l:u=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:i(()=>[a(S,{label:"Yes",icon:"pi pi-check",onClick:o[1]||(o[1]=l=>J()),class:"p-button-text",autofocus:""}),a(S,{label:"No",icon:"pi pi-times",onClick:o[2]||(o[2]=l=>P(!0)),class:"p-button-text"})]),default:i(()=>[r("div",he,[be,r("span",null,"Are you sure you want to "+B(d(c))+"?",1)])]),_:1},8,["visible"]),r("div",null,[a(M,{value:d(_),paginator:!0,rows:10,class:"mt-6",dataKey:"user_id",onRowExpand:t.onRowExpand,onRowCollapse:t.onRowCollapse,expandedRows:k.value,"onUpdate:expandedRows":o[5]||(o[5]=l=>k.value=l),selection:w.value,"onUpdate:selection":o[6]||(o[6]=l=>w.value=l),selectAll:t.selectAll,onSelectAllChange:t.onSelectAllChange,onRowSelect:t.onRowSelect,onRowUnselect:t.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:i(()=>[E(" No Reimbursement data for the selected status filter ")]),loading:i(()=>[E(" Loading customers data. Please wait. ")]),expansion:i(l=>[r("div",ye,[a(M,{value:l.data.onboard_doc,responsiveLayout:"scroll",selection:w.value,"onUpdate:selection":o[4]||(o[4]=v=>w.value=v),selectAll:t.selectAll,onSelectAllChange:t.onSelectAllChange},{default:i(()=>[a(n,{field:"",header:"Date",sortable:""},{body:i(v=>[r("p",Ce,B(d(j)(v.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),a(n,{field:"document_name",header:"Document Name"}),a(n,{field:"doc_url",header:"Document Url"}),a(n,{field:"",header:"View"})]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:i(()=>[a(n,{expander:!0}),a(n,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),a(n,{field:"user_code",header:"Employee Id",sortable:""}),a(n,{field:"employee_name",header:"Employee Name"}),a(n,{class:"fontSize13px",field:"total_distance_travelled",header:"Date Of Joining"}),a(n,{class:"fontSize13px",field:"total_expenses",header:"Approval Status",sortable:!1}),a(n,{field:"",header:"Action"},{body:i(l=>[l.data.has_pending_reimbursements=="true"?(C(),y("span",Se,[a(S,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:v=>T(l.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),a(S,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:v=>T(l.data,"Reject")},null,8,["onClick"])])):H("",!0)]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"]),(C(!0),y(U,null,G(d(_),l=>(C(),y("div",{key:l},[r("img",{src:l.doc_url,alt:""},null,8,Re)]))),128))])])],64)}}},e=Q(Ae);e.use(W,{ripple:!0});e.use(de);e.use(X);e.use(ce);e.directive("tooltip",Z);e.directive("badge",ee);e.directive("ripple",K);e.directive("styleclass",te);e.directive("focustrap",le);e.component("Button",q);e.component("DataTable",oe);e.component("Column",ae);e.component("ColumnGroup",ve);e.component("Row",fe);e.component("Toast",pe);e.component("ConfirmDialog",re);e.component("Dropdown",se);e.component("InputText",ne);e.component("Dialog",ie);e.component("ProgressSpinner",me);e.component("Calendar",ge);e.component("moment",j);e.component("Checkbox",_e);e.mount("#ReviewDocuments");
