import{_ as N}from"./no-data-d6f55554.js";import{d as J}from"./dayjs.min-25482546.js";import{e as H}from"./exceljs.min-a9f463a1.js";import{a as G,c as P}from"./index-0d903406.js";import{C as Q,r as u,h as o,e as g,f as x,g as e,t as m,j as M,o as I,c as R,k as W,F as U,m as V,E as z,i as F,n as v,p as B,_ as Z,l as L,y as ee,z as te}from"./app-97f47cb8.js";import{L as oe}from"./LoadingSpinner-1e2dca26.js";import"./_commonjs-dynamic-modules-302442b1.js";/* empty css                                                                       */const ne="/build/assets/present-img-ae7c8f7a.png",se="/build/assets/Absent-6ed9e5f4.png",ae="/build/assets/Leave-4ca0d5f0.png",le="/build/assets/Early_going-6bfb3337.png",re="/build/assets/Late_coming-52c4aae0.png",Y="/build/assets/MIP_MOP-c9ad109b.png",j=Q("useAttendanceDashboardMainStore",()=>{const w=u(!1);u();const t=u(),f=u(),c=u(!1),h=u(!1),b=u(),d=u([]),p=u(),a=u(),n=u([]),s=u([]),i=u(),l=u([]),r=u(),C=u(),$=u([]),y=u(),_=u([{label:"Absent",backgroundColor:"#FFB1B8",count:null},{label:"Present",backgroundColor:"#7A5EA2",count:null},{label:"Leave",backgroundColor:"#8D98B5",count:null},{label:"Late coming",backgroundColor:"#D9AA63",count:null},{label:"Early going",backgroundColor:"#6BB7C0",count:null},{label:"Missed out punch",backgroundColor:"#000000",count:null},{label:"Missed in punch",backgroundColor:"#000000",count:null}]);function A(){G.get("/fetch-departments").then(E=>{y.value=E.data,console.log(E.data)}).finally(()=>{})}function S(E){G.post("/get-attendance-dashboard",{id:E}).then(O=>{}).finally(()=>{})}return{canShowLoading:w,attendanceDashboardWorkShiftSource:f,getAttendanceDashboardMainSource:async()=>{w.value=!0;let E="/get-attendance-dashboard";await G.get(E).then(O=>{t.value=O.data.attendance_overview,r.value=O.data.total_Employees,console.log(" totalEmployeeInOrganization.value"+r.value),_.value[0].count=parseInt(t.value.absent_count),_.value[1].count=parseInt(t.value.present_count),_.value[2].count=parseInt(t.value.leave_emp_count),_.value[3].count=parseInt(t.value.lg_count),_.value[4].count=parseInt(t.value.eg_count),_.value[5].count=parseInt(t.value.mop_count),_.value[6].count=parseInt(t.value.mip_count),f.value=O.data.work_shift;let X=Object.entries(O.data.upcomings).map(k=>({title:k[0],value:k[1]}));a.value=X;let q=Object.entries(O.data.attendance_overview).map(k=>({title:k[0],value:k[1]}));i.value=q;let K=["absent_count","present_count","leave_emp_count","lg_count","eg_count","mop_count","mip_count"];i.value.forEach(async k=>{l.value.length<7&&K.includes(k.title)&&l.value.push(k.value)}),C.value=O.data.CheckInMode,C.value.forEach(async k=>{$.value.length<3&&$.value.push(k.value)})}).finally(()=>{w.value=!1})},attendanceOverview:t,totalEmployeeInOrganization:r,chartDetails:_,canShowShiftDetails:c,canShowAttendanceOverview:h,selectedAttendanceOverviewReport:b,currentlySelectedShiftDetails:d,currentlySelectedShiftName:p,downloadShiftDetails:n,downloadAttendanceOverviewDetails:s,attendanceDashboardUpcoming:a,overallEmployeeCountForExceptionAnalytics:i,overallEmployeeCountForExceptionAnalyticsForGraph:l,AttendanceAnalytics:C,AttendanceAnalyticsForGraph:$,GetDepartment:A,departments:y,send_selectedDepartment:S}}),ie={key:0,class:"grid grid-cols-7 gap-4"},ce={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},de={class:"mr-2 text-3xl font-semibold text-center"},ue=e("img",{class:"absolute top-6 right-8 w-[16px] h-[16px]",src:ne,alt:""},null,-1),pe=e("p",{class:"text-lg underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Present",-1),_e={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},he={class:"text-3xl font-semibold text-center"},ve=e("img",{class:"ml-6 w-[20px] h-[20px]",src:se,alt:""},null,-1),me=e("p",{class:"text-lg underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Absent",-1),fe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ge={class:"text-3xl font-semibold text-center"},be=e("img",{src:ae,alt:"",class:"ml-6 w-[20px] h-[20px]"},null,-1),xe=e("p",{class:"text-lg underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Leave",-1),we={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ye={class:"text-3xl font-semibold text-center"},Se=e("img",{src:le,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),$e=e("p",{class:"text-lg underline font-semibold text-center text-gray-500 mt-[10px]"},"Late coming",-1),Ae={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Ce={class:"text-3xl font-semibold text-center"},ke=e("img",{src:re,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),De=e("p",{class:"text-lg underline font-semibold text-center text-gray-500 mt-[10px]"},"Early going",-1),Oe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Ee={class:"text-3xl font-semibold text-center"},Le=e("img",{src:Y,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Re=e("p",{class:"text-lg underline font-semibold text-center text-gray-500 mt-[10px]"},"Missed in punch",-1),Me={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},je={class:"text-3xl font-semibold text-center"},Pe=e("img",{src:Y,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Be=e("p",{class:"text-lg underline font-semibold text-center text-gray-500 mt-[10px]"},"Missed out punch",-1),Fe={__name:"attendanceCount",setup(w){const t=j();return(f,c)=>o(t).attendanceOverview?(g(),x("div",ie,[e("div",{class:"relative bg-white rounded-lg py-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[0]||(c[0]=h=>(o(t).selectedAttendanceOverviewReport="Present",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.present_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.present_emps})))},[e("div",ce,[e("span",de,m(o(t).attendanceOverview.present_count),1)]),ue,pe]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[1]||(c[1]=h=>(o(t).selectedAttendanceOverviewReport="Absent",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.absent_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.absent_emps})))},[e("div",_e,[e("span",he,m(o(t).attendanceOverview.absent_count),1),ve]),me]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[2]||(c[2]=h=>(o(t).selectedAttendanceOverviewReport="Leave",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.leave_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.leave_emps})))},[e("div",fe,[e("span",ge,m(o(t).attendanceOverview.leave_emp_count),1),be]),xe]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[3]||(c[3]=h=>(o(t).selectedAttendanceOverviewReport="Late coming",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.lc_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.lc_emps})))},[e("div",we,[e("span",ye,m(o(t).attendanceOverview.lg_count),1),Se]),$e]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[4]||(c[4]=h=>(o(t).selectedAttendanceOverviewReport="Early going",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.eg_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.eg_emps})))},[e("div",Ae,[e("span",Ce,m(o(t).attendanceOverview.eg_count),1),ke]),De]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[5]||(c[5]=h=>(o(t).selectedAttendanceOverviewReport="Missed in punch",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.mip_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.mip_emps})))},[e("div",Oe,[e("span",Ee,m(o(t).attendanceOverview.mip_count),1),Le]),Re]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[6]||(c[6]=h=>(o(t).selectedAttendanceOverviewReport="Missed out punch",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.mop_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.mop_emps})))},[e("div",Me,[e("span",je,m(o(t).attendanceOverview.mop_count),1),Pe]),Be])])):M("",!0)}},Ue={key:0,class:"bg-white rounded-lg p-2 border"},Te=e("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Attendance Analytics",-1),Ie={class:"grid grid-cols-2 gap-4 my-2.5"},Ve={class:"h-full"},Ge={class:"flex items-center"},He={class:""},Ne={class:"flex items-center gap-3"},We={class:"font-semibold text-lg"},ze={__name:"exceptionAnalytics",setup(w){const t=j();I(()=>{c.value=h(),setTimeout(()=>{console.log(t.overallEmployeeCountForExceptionAnalyticsForGraph),f.value.datasets[0].data=t.overallEmployeeCountForExceptionAnalyticsForGraph},1e4)}),u([]);const f=u({labels:["Absent","Present","Leave","Late coming","Early going","Missed out punch","Missed in punch"],datasets:[{backgroundColor:["#FFB1B8","#7A5EA2","#8D98B5","#D9AA63","#6BB7C0","#000000","#000000"],data:[0,0,0,0,0,0,0]}]}),c=u();u();const h=()=>{const d=getComputedStyle(document.documentElement),p=d.getPropertyValue("--text-color");return d.getPropertyValue("--text-color-secondary"),d.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:p}}}}},b=(d,p)=>`${(d/p*100).toFixed(0)}`;return(d,p)=>{const a=R("Chart");return o(t).chartDetails?(g(),x("div",Ue,[Te,e("div",Ie,[e("div",Ve,[o(t).overallEmployeeCountForExceptionAnalyticsForGraph?(g(),W(a,{key:0,type:"pie",data:f.value,options:c.value,class:"h-full"},null,8,["data","options"])):M("",!0)]),e("div",Ge,[e("div",He,[e("div",null,[(g(!0),x(U,null,V(o(t).chartDetails,(n,s)=>(g(),x("div",Ne,[e("div",{style:z({backgroundColor:n.backgroundColor}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),e("div",null,[F(m(n.label)+" - ",1),e("span",We,m(b(n.count,o(t).totalEmployeeInOrganization)),1),F("% ")])]))),256))])])])])])):M("",!0)}}};const Ye={key:0,class:"bg-white rounded-lg p-2 border"},Xe=e("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Check-In & Out Analytics ",-1),qe={class:"grid grid-cols-2 gap-4 my-2.5"},Ke={class:"h-full"},Je={class:"flex items-center"},Qe={class:"my-auto"},Ze={class:"flex items-center gap-3"},et={class:"font-semibold text-lg"},tt=e("div",null,null,-1),ot={__name:"attendanceAnalytics",setup(w){const t=j();I(()=>{c.value=h(),setTimeout(()=>{f.value.datasets[0].data=t.AttendanceAnalyticsForGraph},3e3)});const f=u({labels:["Bio-Metric","Mobile","Web"],datasets:[{data:[0,0,0],backgroundColor:["rgba(122, 94, 162, 1)","rgba(255, 177, 184, 1)","rgba(107, 183, 192, 1)"]}]}),c=u();u(0),u([{label:"Bio-Metric",backgroundColor:"rgba(122, 94, 162, 1)"},{label:"Mobile",backgroundColor:"rgba(255, 177, 184, 1)"},{label:"Web",backgroundColor:"rgba(107, 183, 192, 1)"}]);const h=()=>{const d=getComputedStyle(document.documentElement),p=d.getPropertyValue("--text-color");return d.getPropertyValue("--text-color-secondary"),d.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:p}}}}},b=(d,p)=>`${(d/p*100).toFixed(0)}`;return(d,p)=>{const a=R("Chart");return o(t).AttendanceAnalytics?(g(),x("div",Ye,[Xe,e("div",qe,[e("div",Ke,[v(a,{type:"doughnut",data:f.value,options:c.value},null,8,["data","options"])]),e("div",Je,[e("div",Qe,[e("div",null,[(g(!0),x(U,null,V(o(t).AttendanceAnalytics,(n,s)=>(g(),x("div",Ze,[e("div",{style:z({backgroundColor:f.value.datasets[0].backgroundColor[s]}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),e("div",null,[F(m(n.title)+" - ",1),e("span",et,m(b(n.value,o(t).totalEmployeeInOrganization)),1),F("% ")])]))),256))]),tt])])])])):M("",!0)}}},nt={class:"bg-[#E4ECFF] h-full rounded-lg p-3"},st=e("div",{class:"mx-4 flex items-center justify-between"},[e("span",{class:"font-semibold text-[14px] text-[#000] font-['Poppins]"},"Upcomings"),e("i",{class:"pi pi-calendar text-[#000] text-[16px]"})],-1),at={class:"overflow-x-scroll bg-[#E4ECFF] rounded-lg"},lt={class:"px-auto"},rt={class:"p-2 my-2 transition duration-700 ease-in-out bg-white rounded-lg cursor-pointer hover:-translate-y-1 hover:scale-100"},it={class:"flex px-2 justify-between items-center"},ct={class:"text-[14px] font-semibold"},dt={class:"flex items-center gap-6"},ut={class:"text-xl font-semibold text-black"},pt=e("span",null,[e("i",{class:"fa fa-chevron-right","aria-hidden":"true"})],-1),_t={key:1,class:"font-medium text-sm text-center"},ht={__name:"Upcomings",setup(w){const t=j();return(f,c)=>(g(),x("div",nt,[st,e("div",at,[o(t).attendanceDashboardUpcoming?(g(!0),x(U,{key:0},V(o(t).attendanceDashboardUpcoming,h=>(g(),x("div",lt,[e("div",rt,[e("div",it,[e("div",null,[e("span",ct,m(h.title),1)]),e("div",dt,[e("span",ut,m(h.value),1),pt])])])]))),256)):(g(),x("p",_t,"No data to display"))])]))}},vt={key:0,class:"bg-white p-2 rounded-[6px] border"},mt=e("span",{class:"font-semibold text-[#000] font-['Poppins] text-[16px]"},"Shift",-1),ft={class:"grid grid-cols-6 gap-2"},gt=["onClick"],bt={class:"p-3"},xt=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Shift Timing",-1),wt={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},yt={class:"my-3"},St=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Total Employees",-1),$t={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},At={class:"flex justify-between"},Ct=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Present",-1),kt={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Dt={class:"mx-3"},Ot=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Absent",-1),Et={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Lt={__name:"Shifts",setup(w){const t=j();function f(n){const[s,i]=n.split(":").map(Number),l=s>=12?"PM":"AM";return`${s%12===0?12:s%12}:${String(i).padStart(2,"0")} ${l}`}const c=["bg-orange-100","bg-red-100","bg-orange-100","bg-gray-100","bg-emerald-100","bg-orange-100","bg-red-100","bg-orange-100","bg-gray-100","bg-black-100"],h=n=>c[n],b=["bg-orange-50","bg-red-50","bg-orange-50","bg-gray-50","bg-emerald-50","bg-orange-50","bg-red-50","bg-orange-50","bg-gray-50","bg-black-50"],d=n=>b[n],p=["text-[#000]","text-[#000]","text-[#000]","text-[#000]","text-[#000]","text-[#000]"],a=n=>p[n];return(n,s)=>o(t).attendanceDashboardWorkShiftSource?(g(),x("div",vt,[mt,e("div",ft,[(g(!0),x(U,null,V(o(t).attendanceDashboardWorkShiftSource,(i,l)=>(g(),x("div",{class:B([d(l),"h-[200px] mx-[10px] rounded-[6px] cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100"]),onClick:r=>(o(t).canShowShiftDetails=!0,o(t).currentlySelectedShiftDetails={...i.work_shift_employee_data},o(t).downloadShiftDetails.push({...i.work_shift_employee_data})),key:l},[e("div",{class:B(["w-full rounded-t-[8px] pl-[12px] py-2",h(l)])},[e("span",{class:B(["font-semibold text-[16px] font-['Poppins]",a(l)])},m(i.work_shift_employee_data[0].shift_name),3)],2),e("div",bt,[e("div",null,[xt,e("p",wt,m(f(i.work_shift_employee_data[0].shift_start_time))+" - "+m(f(i.work_shift_employee_data[0].shift_end_time)),1)]),e("div",yt,[St,e("p",$t,m(i.work_shift_assigned_employees?i.work_shift_assigned_employees:"-"),1)]),e("div",At,[e("div",null,[Ct,e("p",kt,m(i.present_count?i.present_count:0),1)]),e("div",Dt,[Ot,e("p",Et,m(i.absent_count?i.absent_count:0),1)])])])],10,gt))),128))])])):M("",!0)}};var Rt={exports:{}};(function(w,t){(function(f,c){c()})(P,function(){function f(n,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function c(n,s,i){var l=new XMLHttpRequest;l.open("GET",n),l.responseType="blob",l.onload=function(){a(l.response,s,i)},l.onerror=function(){console.error("could not download file")},l.send()}function h(n){var s=new XMLHttpRequest;s.open("HEAD",n,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function b(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(s)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof P=="object"&&P.global===P?P:void 0,p=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(n,s,i){var l=d.URL||d.webkitURL,r=document.createElement("a");s=s||n.name||"download",r.download=s,r.rel="noopener",typeof n=="string"?(r.href=n,r.origin===location.origin?b(r):h(r.href)?c(n,s,i):b(r,r.target="_blank")):(r.href=l.createObjectURL(n),setTimeout(function(){l.revokeObjectURL(r.href)},4e4),setTimeout(function(){b(r)},0))}:"msSaveOrOpenBlob"in navigator?function(n,s,i){if(s=s||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(f(n,i),s);else if(h(n))c(n,s,i);else{var l=document.createElement("a");l.href=n,l.target="_blank",setTimeout(function(){b(l)})}}:function(n,s,i,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof n=="string")return c(n,s,i);var r=n.type==="application/octet-stream",C=/constructor/i.test(d.HTMLElement)||d.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||r&&C||p)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var S=y.result;S=$?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=S:location=S,l=null},y.readAsDataURL(n)}else{var _=d.URL||d.webkitURL,A=_.createObjectURL(n);l?l.location=A:location.href=A,l=null,setTimeout(function(){_.revokeObjectURL(A)},4e4)}});d.saveAs=a.saveAs=a,w.exports=a})})(Rt);const D=w=>(ee("data-v-7bbba760"),w=w(),te(),w),Mt={class:"w-full"},jt=D(()=>e("p",{class:"mb-2 text-2xl font-semibold text-black"}," Attendance dashboard ",-1)),Pt={class:"flex justify-between items-center p-2 bg-white border rounded-lg"},Bt={class:"mx-2"},Ft={class:"font-[14px] font-['Poppins'] text-gray-500"},Ut={class:"mb-2 text-sm font-semibold"},Tt={class:"flex items-center justify-end gap-3 mx-4"},It=D(()=>e("div",null,[e("i",{class:"pi pi-calendar text-[#000] text-[16px]"})],-1)),Vt={class:"my-3"},Gt={class:"grid grid-cols-3 gap-2"},Ht={class:"my-3"},Nt={class:"absolute left-0 mx-4 font-semibold fs-5"},Wt={class:"relative right-0 mx-4 font-semibold fs-5"},zt=D(()=>e("p",{class:"relative left-2 font-['poppins']"},"Download",-1)),Yt=D(()=>e("svg",{width:"22px",height:"16px",viewBox:"0 0 22 16"},[e("path",{d:"M2,10 L6,13 L12.8760559,4.5959317 C14.1180021,3.0779974 16.2457925,2.62289624 18,3.5 L18,3.5 C19.8385982,4.4192991 21,6.29848669 21,8.35410197 L21,10 C21,12.7614237 18.7614237,15 16,15 L1,15",id:"check"}),e("polyline",{points:"4.5 8.5 8 11 11.5 8.5",class:"svg-out"}),e("path",{d:"M8,1 L8,11",class:"svg-out"})],-1)),Xt=[Yt],qt={key:0,class:""},Kt={key:1,class:"flex justify-center"},Jt=D(()=>e("img",{class:"h-[450px]",src:N,alt:"",srcset:""},null,-1)),Qt=[Jt],Zt={class:"absolute left-0 mx-4 font-semibold fs-5"},eo={class:"relative right-0 mx-4 font-semibold fs-5"},to=D(()=>e("p",{class:"relative left-2 font-['poppins']"},"Download",-1)),oo=D(()=>e("svg",{width:"22px",height:"16px",viewBox:"0 0 22 16"},[e("path",{d:"M2,10 L6,13 L12.8760559,4.5959317 C14.1180021,3.0779974 16.2457925,2.62289624 18,3.5 L18,3.5 C19.8385982,4.4192991 21,6.29848669 21,8.35410197 L21,10 C21,12.7614237 18.7614237,15 16,15 L1,15",id:"check"}),e("polyline",{points:"4.5 8.5 8 11 11.5 8.5",class:"svg-out"}),e("path",{d:"M8,1 L8,11",class:"svg-out"})],-1)),no=[oo],so={key:0,class:""},ao={key:1,class:"flex justify-center"},lo=D(()=>e("img",{class:"h-[450px]",src:N,alt:"",srcset:""},null,-1)),ro=[lo],io={__name:"attendanceDashboard",setup(w){const t=j();I(async()=>{await t.getAttendanceDashboardMainSource(),t.GetDepartment()});const f=u();I(async()=>{await t.getAttendanceDashboardMainSource(),t.GetDepartment()});const c=async()=>{const p=new H.Workbook,a=p.addWorksheet("Sheet1"),n=["user_code","user_code","shift_start_time","shift_end_time","shift_end_time"],s="this report generated by ABShrms payroll software ",i=n;a.addRow(i).eachCell((_,A)=>{_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"252f70"}},_.font={bold:!0,color:{argb:"ffffff"}},a.getColumn(A).width=20}),Object.values(t.currentlySelectedShiftDetails).forEach((_,A)=>{console.log(_);const S=[];i.forEach(T=>{S.push(_[T])}),a.addRow(S)}),a.addRow([""]);const r=a.addRow([""]);r.getCell(1).value=s,a.mergeCells(r.number,1,r.number,3),r.getCell(1).alignment={wrapText:!0},r.getCell(1).font={italic:!0};const C=await p.xlsx.writeBuffer(),$=window.URL.createObjectURL(new Blob([C])),y=document.createElement("a");y.href=$,y.download="shift.xlsx",y.click(),window.URL.revokeObjectURL($)},h=async()=>{const p=new H.Workbook,a=p.addWorksheet("Sheet1"),n=["Employee_Code","Employee_Name","Department","Process","Location"],s="This report generated by ABShrms payroll software ",i=n;a.addRow(i).eachCell((_,A)=>{_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"252f70"}},_.font={bold:!0,color:{argb:"ffffff"}},a.getColumn(A).width=20}),Object.values(t.downloadAttendanceOverviewDetails[0]).forEach((_,A)=>{console.log(_);const S=[];i.forEach(T=>{S.push(_[T])}),a.addRow(S)}),a.addRow([""]);const r=a.addRow([""]);r.getCell(1).value=s,a.mergeCells(r.number,1,r.number,3),r.getCell(1).alignment={wrapText:!0},r.getCell(1).font={italic:!0};const C=await p.xlsx.writeBuffer(),$=window.URL.createObjectURL(new Blob([C])),y=document.createElement("a");y.href=$,y.download=`${t.selectedAttendanceOverviewReport}_${new Date}.xlsx`,y.click(),window.URL.revokeObjectURL($)},b=u(!1),d=u("downloaded");return(p,a)=>{const n=R("Dropdown"),s=R("Column"),i=R("DataTable"),l=R("Sidebar");return g(),x(U,null,[o(t).canShowLoading?(g(),W(oe,{key:0,class:"absolute z-50 bg-white"})):M("",!0),e("div",Mt,[jt,e("div",Pt,[e("div",Bt,[e("p",Ft,[F(" Daily Analytics - "),e("span",Ut,m(o(J)(new Date).format("MMMM DD,YYYY")),1)])]),e("div",Tt,[e("div",null,[v(n,{onChange:a[0]||(a[0]=r=>o(t).send_selectedDepartment(f.value)),optionValue:"id",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=r=>f.value=r),optionLabel:"name",options:o(t).departments,placeholder:"Select a Department",class:"w-full md:w-18rem h-[36px]"},null,8,["modelValue","options"])]),e("div",null,[v(n,{optionLabel:"name",placeholder:"Select a Location",class:"w-full md:w-14rem h-[36px]"})]),It])]),e("div",Vt,[v(Fe)]),e("div",Gt,[e("div",null,[v(ze)]),e("div",null,[v(ot)]),e("div",null,[v(ht)])]),e("div",Ht,[v(Lt)])]),v(l,{visible:o(t).canShowShiftDetails,"onUpdate:visible":a[3]||(a[3]=r=>o(t).canShowShiftDetails=r),position:"right",style:{width:"70vw !important"}},{header:L(()=>[e("p",Nt,m(o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails[0].shift_name:null)+" Reports",1),e("div",Wt,[e("button",{class:"bg-[#E6E6E6] p-2 mx-2 rounded-md w-[120px]",onClick:a[2]||(a[2]=r=>(b.value=!b.value,c()))},[zt,e("div",{id:"btn-download",style:{position:"absolute",right:"0"},class:B([b.value==!0?d.value:" "])},Xt,2)])])]),default:L(()=>[Object.values(o(t).currentlySelectedShiftDetails).length>=1?(g(),x("div",qt,[v(i,{scrollable:"",scrollHeight:"450px",value:o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails:[]},{default:L(()=>[v(s,{field:"user_code",header:"User code"}),v(s,{field:"name",header:"Name"}),v(s,{field:"shift_start_time",header:"Shift start time"}),v(s,{field:"shift_end_time",header:"Shift end time"}),v(s,{field:"grace_time",header:"Grace time"})]),_:1},8,["value"])])):(g(),x("div",Kt,Qt))]),_:1},8,["visible"]),v(l,{visible:o(t).canShowAttendanceOverview,"onUpdate:visible":a[5]||(a[5]=r=>o(t).canShowAttendanceOverview=r),position:"right",style:{width:"70vw !important"}},{header:L(()=>[e("p",Zt,m(o(t).selectedAttendanceOverviewReport)+" Reports",1),e("div",eo,[e("button",{class:"bg-[#E6E6E6] p-2 mx-2 rounded-md w-[120px]",onClick:a[4]||(a[4]=r=>(b.value=!b.value,h()))},[to,e("div",{id:"btn-download",style:{position:"absolute",right:"0"},class:B([b.value==!0?d.value:" "])},no,2)])])]),default:L(()=>[Object.values(o(t).currentlySelectedShiftDetails).length>=1?(g(),x("div",so,[v(i,{scrollable:"",scrollHeight:"450px",value:o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails:[]},{default:L(()=>[v(s,{field:"Employee_Code",header:"Employee_Code",style:{"white-space":"nowrap"}}),v(s,{field:"Employee_Name",header:"Employee_Name",style:{"white-space":"nowrap"}}),v(s,{field:"Department",header:"Department",style:{"white-space":"nowrap"}}),v(s,{field:"Process",header:"Process",style:{"white-space":"nowrap"}}),v(s,{field:"Location",header:"Location",style:{"white-space":"nowrap"}})]),_:1},8,["value"])])):(g(),x("div",ao,ro))]),_:1},8,["visible"])],64)}}},go=Z(io,[["__scopeId","data-v-7bbba760"]]);export{go as default};
