/* empty css              */import{G as y,S as H,o as D,c as x,d as o,h as s,V as v,w as m,a as V,t as E,F as W,g as C,H as z,P as j,I as J,R as O,u as I,v as G,J as K,M as q,K as Q,L as X,A as Z}from"./toastservice.esm-6ab5f57c.js";import{T as ee,B as ae,S as te,b as le,a as se}from"./styleclass.esm-9e259b99.js";import"./blockui.esm-da4dd4e3.js";import{C as oe}from"./confirmationservice.esm-91ab80c8.js";import{s as ie}from"./progressspinner.esm-34a6e341.js";import{s as ne}from"./calendar.esm-2f67a089.js";import{d as pe,c as de}from"./pinia-85c4361b.js";import{a as w}from"./index-0d903406.js";import{d as A}from"./dayjs.min-a301eb4b.js";const re=pe("managePayslipStore",()=>{const $=y(),l=y(),k=y(),u=y(!1);async function h(i,p){u.value=!0,$.value="",await w.post("getAllEmployeesPayslipDetails",{month:i,year:p}).then(r=>{$.value=r.data.data}).finally(()=>{u.value=!1})}async function P(i,p,r){u.value=!0,await w.post("/generatePayslip",{user_code:i,month:p,year:r,type:"html"}).then(c=>{console.log(c.data),k.value=c.data}).finally(()=>{u.value=!1})}async function b(i,p,r){u.value=!0,await w.post("/generatePayslip",{user_code:i,month:p,year:r,type:"pdf"}).then(c=>{}).finally(()=>{u.value=!1})}async function g(i,p,r){console.log("sendMail_employeePayslip() : Sending mail to user : "+i),u.value=!0,w.post("/generatePayslip",{user_code:i,month:p,year:r,type:"mail"}).then(c=>{console.log(" Response [sendMail_employeePayslip] : "+c.data.data)}).catch(c=>{console.log(c)}).finally(()=>{u.value=!1})}async function F(i,p,r,c){console.log("updatePayslipReleaseStatus() : Updating releasepayslip status to user : "+i);let n=new Date(l.value);w.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:p,year:r,status:c}).then(e=>{console.log(" Response [updatePayslipReleaseStatus] : "+e.data.data)}).catch(e=>{console.log(e.data.data)}).finally(()=>{h(n.getMonth()+1,n.getFullYear())})}async function T(i,p,r,c){console.log("UpdateWithDrawStatus() : Updating withdraw :",i);let n=new Date(l.value);w.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:p,year:r,status:c}).then(e=>{console.log(" Response [updatePayslipReleaseStatus] : "+e.data.data)}).catch(e=>{console.log(e.data.data)}).finally(()=>{h(n.getMonth()+1,n.getFullYear())})}function R(i,p,r){const c=i,n=document.createElement("a"),e=`${p}-${r}.pdf`;n.href=c,n.download=e,n.click()}async function L(i,p,r,c){console.log("Downloading payslip PDF....."),A(p).month()+1,A(r).year(),await w.post("/payroll/paycheck/getEmployeePayslipDetailsAsPDF",{uid:getURLParams_UID(),user_code:i,month:formattedMonth,year:formattedYear}).then(n=>{if(console.log(" Response [downloadPayslipReleaseStatus] : "+JSON.stringify(n.data.data)),n.data.data){let e=n.data.data,a=n.data.emp_name,M=n.data.emp_month;e.startsWith("JVB")?(e="data:application/pdf;base64,"+e,R(e,a,M)):e.startsWith("data:application/pdf;base64")&&R(e)}else console.log("Response Url Not Found")})}async function N(i,p,r,c){await w.post("/generatePayslip",{user_code:i,month:p,year:r,type:"pdf"}).then(n=>{if(console.log(" Response [downloadPayslipReleaseStatus] : "+JSON.stringify(n.data)),n.data){let e=n.data,a=c,M=p;e.startsWith("JVB")?(e="data:application/pdf;base64,"+e,R(e,a,M)):e.startsWith("data:application/pdf;base64")&&R(e)}else console.log("Response Url Not Found")})}return{array_employees_list:$,paySlipHTMLView:k,selectedPayRollDate:l,loading:u,getAllEmployeesPayslipDetails:h,getEmployeePayslipDetailsAsHTML:P,sendMail_employeePayslip:g,updatePayslipReleaseStatus:F,downloadPayslip:L,UpdateWithDrawStatus:T,getEmployeePayslipDetailsAsPDF:b,downloadEmployeePaySlipPdf:N}});const ce={class:"d-flex justify-content-end"},ue=o("label",{for:"",class:"my-2 text-lg font-semibold"},"Select Month",-1),ye={class:"my-4"},me={class:"d-flex flex-column"},fe=["onClick"],ve=["onClick"],ge={key:2,class:"mt-2 text-success"},he={key:3,class:"mt-2 text-danger"},_e={key:0},we=o("h1",null," Payslip sent",-1),Pe=[we],be={key:1},De=["onClick"],xe=o("div",{class:"confirmation-content"},[o("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),o("span",null,"Are you sure you want to send Mail ?")],-1),ke={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Re=o("div",{class:"confirmation-content"},[o("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),o("span",null,"Are you sure you want to send Mail ?")],-1),Se={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Ce={class:"confirmation-content"},Me=o("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),$e={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Fe={class:"confirmation-content"},Ue=o("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Te={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Le={class:"flex inline-flex card justify-content-center"},Ne=["innerHTML"],Ve=o("h5",{style:{"text-align":"center"}},"Please wait...",-1),Ee={__name:"ManagePayslips",setup($){const l=re(),k=y(!1),u=y(!1),h=y(!1),P=y(!1),b=y(!1);y();const g=y(),F=y();y(),H(()=>{l.selectedPayRollDate=new Date,l.getAllEmployeesPayslipDetails(l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear())});async function T(e){console.log("Showing payslip html for (user_code, month): "+e+" , "+parseInt(l.selectedPayRollDate.getMonth()+1)),await l.getEmployeePayslipDetailsAsHTML(e,l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear()),k.value=!0}function R(e){g.value=e,u.value=!0}function L(e){g.value=e,h.value=!0}function N(e,a){g.value=e,F.value=a,P.value=!0}async function i(e){await l.sendMail_employeePayslip(e,l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear()),u.value=!1}async function p(e){await l.updatePayslipReleaseStatus(e,l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear(),1),h.value=!1}async function r(e){g.value=e,b.value=!0}async function c(e){await l.UpdateWithDrawStatus(e,l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear(),0),b.value=!1}async function n(e,a){await l.downloadEmployeePaySlipPdf(e,l.selectedPayRollDate.getMonth()+1,l.selectedPayRollDate.getFullYear(),a),P.value=!1}return(e,a)=>{const M=C("Calendar"),f=C("Button"),_=C("Column"),Y=C("DataTable"),S=C("Dialog"),B=C("ProgressSpinner");return D(),x(W,null,[o("div",ce,[ue,s(M,{view:"month",dateFormat:"mm/yy",class:"mx-4",modelValue:v(l).selectedPayRollDate,"onUpdate:modelValue":a[0]||(a[0]=t=>v(l).selectedPayRollDate=t),style:{border:"1px solid orange","border-radius":"7px",height:"38px"}},null,8,["modelValue"]),s(f,{class:"h-10 mb-2 btn btn-orange",label:"Generate",onClick:a[1]||(a[1]=t=>v(l).getAllEmployeesPayslipDetails(v(l).selectedPayRollDate.getMonth()+1,v(l).selectedPayRollDate.getFullYear()))})]),o("div",ye,[s(Y,{value:v(l).array_employees_list,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Records",responsiveLayout:"scroll",filters:e.filters,"onUpdate:filters":a[2]||(a[2]=t=>e.filters=t),filterDisplay:"menu",loading:e.loading2,globalFilterFields:["name","status"]},{default:m(()=>[s(_,{headerStyle:"width: 3rem"}),s(_,{field:"user_code",header:"Employee Code",headerStyle:"width: 3rem"}),s(_,{field:"name",header:"Employee Name"}),s(_,{field:"email",header:"Personal Mail"}),s(_,{field:"is_payslip_released",header:"Payslip Status"},{body:m(t=>[o("div",me,[t.data.is_payslip_released==1?(D(),x("button",{key:0,class:"z-0 btn",style:{border:"1px solid navy"},onClick:U=>r(t.data.user_code)},"withdraw",8,fe)):(D(),x("button",{key:1,class:"z-0 rounded btn-primary",style:{padding:"4px 0 !important","margin-top":"10px"},onClick:U=>L(t.data.user_code)},"Release payslip",8,ve)),t.data.is_payslip_released==1?(D(),x("h1",ge," Released ")):V("",!0),t.data.is_payslip_released==0||t.data.is_payslip_released==null?(D(),x("h1",he," Not Released ")):V("",!0)])]),_:1}),s(_,{field:"is_payslip_mail_sent",header:"Mail Status"},{body:m(t=>[t.data.is_payslip_mail_sent==1?(D(),x("div",_e,Pe)):(D(),x("div",be,[o("button",{class:"z-0 rounded btn-primary",onClick:U=>R(t.data.user_code)},"Send Payslip",8,De)]))]),_:1}),s(_,{header:"Download"},{body:m(t=>[s(f,{class:"z-0 btn-primary",style:{},label:"Download",onClick:U=>N(t.data.user_code,t.data.payroll_date,t.data.name)},null,8,["onClick"])]),_:1}),s(_,{header:"View Payslip"},{body:m(t=>[s(f,{class:"z-0 btn-primary",style:{},label:"View",onClick:U=>T(t.data.user_code)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),s(S,{header:"Confirmation",visible:u.value,"onUpdate:visible":a[5]||(a[5]=t=>u.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:m(()=>[xe,o("div",ke,[s(f,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:a[3]||(a[3]=t=>i(g.value)),autofocus:""}),s(f,{label:"No",icon:"pi pi-times",onClick:a[4]||(a[4]=t=>u.value=!1),class:"py-2 p-button-text",autofocus:""})])]),_:1},8,["visible"]),s(S,{header:"Confirmation",visible:b.value,"onUpdate:visible":a[8]||(a[8]=t=>b.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:m(()=>[Re,o("div",Se,[s(f,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:a[6]||(a[6]=t=>c(g.value)),autofocus:""}),s(f,{label:"No",icon:"pi pi-times",onClick:a[7]||(a[7]=t=>b.value=!1),class:"py-2 p-button-text",autofocus:""})])]),_:1},8,["visible"]),s(S,{header:"Confirmation",visible:h.value,"onUpdate:visible":a[11]||(a[11]=t=>h.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:m(()=>[o("div",Ce,[Me,o("span",null,"Are you sure you want to release payslip? "+E(v(l).name),1)]),o("div",$e,[s(f,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:a[9]||(a[9]=t=>p(g.value)),autofocus:""}),s(f,{label:"No",icon:"pi pi-times",onClick:a[10]||(a[10]=t=>h.value=!1),class:"py-2 p-button-text",autofocus:""})])]),_:1},8,["visible"]),s(S,{header:"Confirmation",visible:P.value,"onUpdate:visible":a[14]||(a[14]=t=>P.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:m(()=>[o("div",Fe,[Ue,o("span",null,"Are you sure you want to download payslip? "+E(v(l).name),1)]),o("div",Te,[s(f,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:a[12]||(a[12]=t=>n(g.value,F.value)),autofocus:""}),s(f,{label:"No",icon:"pi pi-times",onClick:a[13]||(a[13]=t=>P.value=!1),class:"py-2 p-button-text",autofocus:""})])]),_:1},8,["visible"]),o("div",Le,[s(S,{visible:k.value,"onUpdate:visible":a[15]||(a[15]=t=>k.value=t),modal:"",header:"Payslip",breakpoints:{"960px":"75vw","640px":"90vw"}},{default:m(()=>[o("div",{innerHTML:v(l).paySlipHTMLView},null,8,Ne)]),_:1},8,["visible"])]),s(S,{header:"Header",visible:v(l).loading,"onUpdate:visible":a[16]||(a[16]=t=>v(l).loading=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:m(()=>[s(B,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:m(()=>[Ve]),_:1},8,["visible"])],64)}}},d=z(Ee),Ae=de();d.use(j,{ripple:!0});d.use(oe);d.use(J);d.use(Ae);d.directive("tooltip",ee);d.directive("badge",ae);d.directive("ripple",O);d.directive("styleclass",te);d.directive("focustrap",I);d.component("Button",G);d.component("DataTable",le);d.component("Column",se);d.component("ConfirmDialog",K);d.component("Toast",q);d.component("Dialog",Q);d.component("Dropdown",X);d.component("ProgressSpinner",ie);d.component("InputText",Z);d.component("Calendar",ne);d.mount("#vjs_manage_payslips");
