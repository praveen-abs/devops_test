/* empty css                  *//* empty css              *//* empty css                     *//* empty css                   */import{I as y,ak as A,o as w,c as D,aj as v,b as E,a as N,d as s,h as o,w as g,t as V,F as z,g as C,K as B,P as H,L as j,u as W,M as I,R as O,S as J,x as K,y as Q,N as q,Q as G,_ as X,V as Z,W as ee,Y as ae}from"./toastservice.esm-3d6796bd.js";import"./blockui.esm-fba20899.js";import{a as te}from"./datatable.esm-30f5a7e6.js";import{C as le}from"./confirmationservice.esm-5ceb5613.js";import{s as se}from"./progressspinner.esm-2bee3521.js";import{s as oe}from"./calendar.esm-88321a96.js";import{d as ie,c as ne}from"./pinia-5332ebd8.js";import{a as k}from"./index-362795f3.js";import{L as pe}from"./LoadingSpinner-e8e4c1ec.js";import"./_plugin-vue_export-helper-c27b6911.js";const de=ie("managePayslipStore",()=>{const S=y(),t=y(),x=y(),c=y(!1);async function h(i,d){c.value=!0,S.value="",await k.post("/generatePayslip",{month:i,year:d,type:"pdf"}).then(r=>{S.value=r.data.data}).finally(()=>{c.value=!1})}async function P(i,d,r){c.value=!0,await k.post("/payroll/paycheck/getEmployeePayslipDetailsAsHTML",{user_code:i,month:d,year:r}).then(u=>{x.value=u.data}).finally(()=>{c.value=!1})}async function b(i,d,r){c.value=!0,await k.post("/payroll/paycheck/getEmployeePayslipDetailsAsPDF",{user_code:i,month:d,year:r}).then(u=>{}).finally(()=>{c.value=!1})}async function m(i,d,r){console.log("sendMail_employeePayslip() : Sending mail to user : "+i),c.value=!0,k.post("/payroll/paycheck/sendMail_employeePayslip",{user_code:i,month:d,year:r}).then(u=>{console.log(" Response [sendMail_employeePayslip] : "+u.data.data)}).catch(u=>{console.log(u)}).finally(()=>{c.value=!1})}async function F(i,d,r,u){console.log("updatePayslipReleaseStatus() : Updating releasepayslip status to user : "+i);let p=new Date(t.value);k.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:d,year:r,status:u}).then(e=>{console.log(" Response [updatePayslipReleaseStatus] : "+e.data.data)}).catch(e=>{console.log(e.data.data)}).finally(()=>{h(p.getMonth()+1,p.getFullYear())})}async function L(i,d,r,u){console.log("UpdateWithDrawStatus() : Updating withdraw :",i);let p=new Date(t.value);k.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:d,year:r,status:u}).then(e=>{console.log(" Response [updatePayslipReleaseStatus] : "+e.data.data)}).catch(e=>{console.log(e.data.data)}).finally(()=>{h(p.getMonth()+1,p.getFullYear())})}function M(i,d,r){const u=i,p=document.createElement("a"),e=`${d}-${r}.pdf`;p.href=u,p.download=e,p.click()}async function T(i,d,r,u){console.log("Downloading payslip PDF....."),parseInt(dayjs(payroll_month).month())+1,dayjs(payroll_month).year(),await k.post("/payroll/paycheck/getEmployeePayslipDetailsAsPDF",{uid:getURLParams_UID(),user_code:i,month:formattedMonth,year:formattedYear}).then(p=>{if(console.log(" Response [downloadPayslipReleaseStatus] : "+JSON.stringify(p.data.data)),p.data.data){let e=p.data.data,l=p.data.emp_name,U=p.data.emp_month;e.startsWith("JVB")?(e="data:application/pdf;base64,"+e,M(e,l,U)):e.startsWith("data:application/pdf;base64")&&M(e)}else console.log("Response Url Not Found")})}return{array_employees_list:S,paySlipHTMLView:x,selectedPayRollDate:t,loading:c,getAllEmployeesPayslipDetails:h,getEmployeePayslipDetailsAsHTML:P,sendMail_employeePayslip:m,updatePayslipReleaseStatus:F,downloadPayslip:T,UpdateWithDrawStatus:L,getEmployeePayslipDetailsAsPDF:b}});const re={class:"flex justify-between"},ce=s("div",null,[s("h6",{class:"mb-2 font-semibold text-lg"},"Manage Employee Payslips")],-1),ue={class:"d-flex justify-content-end"},ye=s("label",{for:"",class:"my-2 text-lg font-semibold"},"Select Month",-1),me={class:"my-4"},fe={class:"d-flex flex-column"},ve=["onClick"],ge=["onClick"],he={key:2,class:"text-success mt-2"},_e={key:3,class:"text-danger mt-2"},we={key:0},Pe=s("h1",null," Payslip sent",-1),be=[Pe],De={key:1},ke=["onClick"],xe=s("div",{class:"confirmation-content"},[s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),s("span",null,"Are you sure you want to send Mail ?")],-1),Re={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Ce=s("div",{class:"confirmation-content"},[s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),s("span",null,"Are you sure you want to send Mail ?")],-1),Se={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Me={class:"confirmation-content"},$e=s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Fe={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Le={class:"confirmation-content"},Te=s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Ue={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Ne={class:"flex inline-flex card justify-content-center"},Ve=["innerHTML"],Ye={__name:"ManagePayslips",setup(S){const t=de(),x=y(!1),c=y(!1),h=y(!1),P=y(!1),b=y(!1);y();const m=y();A(()=>{t.selectedPayRollDate=new Date,t.selectedPayRollDate=new Date,t.getAllEmployeesPayslipDetails(t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear())});async function F(e){console.log("Showing payslip html for (user_code, month): "+e+" , "+parseInt(t.selectedPayRollDate.getMonth()+1)),await t.getEmployeePayslipDetailsAsHTML(e,t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear()),x.value=!0}function L(e){m.value=e,c.value=!0}function M(e){m.value=e,h.value=!0}function T(e){m.value=e,P.value=!0}async function i(e){await t.sendMail_employeePayslip(e,t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear()),c.value=!1}async function d(e){await t.updatePayslipReleaseStatus(e,t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear(),1),h.value=!1}async function r(e){m.value=e,b.value=!0}async function u(e){await t.UpdateWithDrawStatus(e,t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear(),0),b.value=!1}async function p(e){await t.downloadPayslip(e,t.selectedPayRollDate.getMonth()+1,t.selectedPayRollDate.getFullYear()),P.value=!1}return(e,l)=>{const U=C("Calendar"),_=C("Column"),f=C("Button"),Y=C("DataTable"),R=C("Dialog");return w(),D(z,null,[v(t).loading?(w(),E(pe,{key:0,class:"absolute z-50 bg-white"})):N("",!0),s("div",re,[ce,s("div",ue,[ye,o(U,{view:"month",dateFormat:"mm/yy",class:"mx-4",modelValue:v(t).selectedPayRollDate,"onUpdate:modelValue":l[0]||(l[0]=a=>v(t).selectedPayRollDate=a),style:{"border-radius":"7px",height:"38px"},onDateSelect:l[1]||(l[1]=a=>v(t).getAllEmployeesPayslipDetails(v(t).selectedPayRollDate.getMonth()+1,v(t).selectedPayRollDate.getFullYear()))},null,8,["modelValue"])])]),s("div",me,[o(Y,{value:v(t).array_employees_list,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Records",responsiveLayout:"scroll",filters:e.filters,"onUpdate:filters":l[2]||(l[2]=a=>e.filters=a),filterDisplay:"menu",loading:e.loading2,globalFilterFields:["name","status"]},{default:g(()=>[o(_,{headerStyle:"width: 3rem"}),o(_,{field:"user_code",header:"Employee Code",headerStyle:"width: 3rem"}),o(_,{field:"name",header:"Employee Name"}),o(_,{field:"email",header:"Personal Mail"}),o(_,{field:"is_payslip_released",header:"Payslip Status"},{body:g(a=>[s("div",fe,[a.data.is_payslip_released==1?(w(),D("button",{key:0,class:"btn z-0",style:{border:"1px solid navy"},onClick:$=>r(a.data.user_code)},"withdraw",8,ve)):(w(),D("button",{key:1,class:"btn-primary rounded z-0",style:{padding:"4px 0 !important","margin-top":"10px"},onClick:$=>M(a.data.user_code)},"Release payslip",8,ge)),a.data.is_payslip_released==1?(w(),D("h1",he," Released ")):N("",!0),a.data.is_payslip_released==0||a.data.is_payslip_released==null?(w(),D("h1",_e," Not Released ")):N("",!0)])]),_:1}),o(_,{field:"is_payslip_mail_sent",header:"Mail Status"},{body:g(a=>[a.data.is_payslip_mail_sent==1?(w(),D("div",we,be)):(w(),D("div",De,[s("button",{class:"btn-primary rounded z-0",onClick:$=>L(a.data.user_code)},"Send Payslip",8,ke)]))]),_:1}),o(_,{header:"Download"},{body:g(a=>[o(f,{class:"btn-primary z-0",style:{},label:"Download",onClick:$=>T(a.data.user_code)},null,8,["onClick"])]),_:1}),o(_,{header:"View Payslip"},{body:g(a=>[o(f,{class:"btn-primary z-0",style:{},label:"View",onClick:$=>F(a.data.user_code)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),o(R,{header:"Confirmation",visible:c.value,"onUpdate:visible":l[5]||(l[5]=a=>c.value=a),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:g(()=>[xe,s("div",Re,[o(f,{class:"btn-primary mr-3 py-2",label:"Yes",icon:"pi pi-check",onClick:l[3]||(l[3]=a=>i(m.value)),autofocus:""}),o(f,{label:"No",icon:"pi pi-times",onClick:l[4]||(l[4]=a=>c.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),o(R,{header:"Confirmation",visible:b.value,"onUpdate:visible":l[8]||(l[8]=a=>b.value=a),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:g(()=>[Ce,s("div",Se,[o(f,{class:"btn-primary mr-3 py-2",label:"Yes",icon:"pi pi-check",onClick:l[6]||(l[6]=a=>u(m.value)),autofocus:""}),o(f,{label:"No",icon:"pi pi-times",onClick:l[7]||(l[7]=a=>b.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),o(R,{header:"Confirmation",visible:h.value,"onUpdate:visible":l[11]||(l[11]=a=>h.value=a),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:g(()=>[s("div",Me,[$e,s("span",null,"Are you sure you want to release payslip? "+V(v(t).name),1)]),s("div",Fe,[o(f,{class:"btn-primary py-2 mr-3",label:"Yes",icon:"pi pi-check",onClick:l[9]||(l[9]=a=>d(m.value)),autofocus:""}),o(f,{label:"No",icon:"pi pi-times",onClick:l[10]||(l[10]=a=>h.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),o(R,{header:"Confirmation",visible:P.value,"onUpdate:visible":l[14]||(l[14]=a=>P.value=a),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:g(()=>[s("div",Le,[Te,s("span",null,"Are you sure you want to download payslip? "+V(v(t).name),1)]),s("div",Ue,[o(f,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:l[12]||(l[12]=a=>p(m.value,e.selectedUsername)),autofocus:""}),o(f,{label:"No",icon:"pi pi-times",onClick:l[13]||(l[13]=a=>P.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),s("div",Ne,[o(R,{visible:x.value,"onUpdate:visible":l[15]||(l[15]=a=>x.value=a),modal:"",header:"Payslip",style:{width:"50vw"}},{default:g(()=>[s("div",{innerHTML:v(t).paySlipHTMLView},null,8,Ve)]),_:1},8,["visible"])])],64)}}},n=B(Ye),Ae=ne();n.use(H,{ripple:!0});n.use(le);n.use(j);n.use(Ae);n.directive("tooltip",W);n.directive("badge",I);n.directive("ripple",O);n.directive("styleclass",J);n.directive("focustrap",K);n.component("Button",Q);n.component("DataTable",te);n.component("Column",q);n.component("ConfirmDialog",G);n.component("Toast",X);n.component("Dialog",Z);n.component("Dropdown",ee);n.component("ProgressSpinner",se);n.component("InputText",ae);n.component("Calendar",oe);n.mount("#vjs_manage_payslips");
