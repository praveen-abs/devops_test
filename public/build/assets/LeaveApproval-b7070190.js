import{a as I}from"./index-362795f3.js";import{Q as C,W as re,ae as oe,c as A,aa as L,b as Y,a as z,d as f,g as s,w as l,X as Z,F as se,a7 as P,h as k,o as M,t as g,l as R,n as J}from"./inputnumber.esm-a7c5b1f0.js";import{u as ie}from"./confirmationservice.esm-c87db23e.js";import{u as le}from"./toastservice.esm-c9da6ad1.js";import{S as ue}from"./Service-27f748d6.js";import{L as de}from"./LoadingSpinner-bbcf6d6b.js";import"./pinia-4be28dc8.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-c27b6911.js";var me=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,ce=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,ye=/[^-+\dA-Z]/g;function $(a,n,o,u){if(arguments.length===1&&typeof a=="string"&&!/\d/.test(a)&&(n=a,a=void 0),a=a||a===0?a:new Date,a instanceof Date||(a=new Date(a)),isNaN(a))throw TypeError("Invalid date");n=String(q[n]||n||q.default);var c=n.slice(0,4);(c==="UTC:"||c==="GMT:")&&(n=n.slice(4),o=!0,c==="GMT:"&&(u=!0));var r=function(){return o?"getUTC":"get"},d=function(){return a[r()+"Date"]()},T=function(){return a[r()+"Day"]()},v=function(){return a[r()+"Month"]()},b=function(){return a[r()+"FullYear"]()},m=function(){return a[r()+"Hours"]()},N=function(){return a[r()+"Minutes"]()},D=function(){return a[r()+"Seconds"]()},H=function(){return a[r()+"Milliseconds"]()},w=function(){return o?0:a.getTimezoneOffset()},F=function(){return fe(a)},W=function(){return pe(a)},O={d:function(){return d()},dd:function(){return h(d())},ddd:function(){return p.dayNames[T()]},DDD:function(){return G({y:b(),m:v(),d:d(),_:r(),dayName:p.dayNames[T()],short:!0})},dddd:function(){return p.dayNames[T()+7]},DDDD:function(){return G({y:b(),m:v(),d:d(),_:r(),dayName:p.dayNames[T()+7]})},m:function(){return v()+1},mm:function(){return h(v()+1)},mmm:function(){return p.monthNames[v()]},mmmm:function(){return p.monthNames[v()+12]},yy:function(){return String(b()).slice(2)},yyyy:function(){return h(b(),4)},h:function(){return m()%12||12},hh:function(){return h(m()%12||12)},H:function(){return m()},HH:function(){return h(m())},M:function(){return N()},MM:function(){return h(N())},s:function(){return D()},ss:function(){return h(D())},l:function(){return h(H(),3)},L:function(){return h(Math.floor(H()/10))},t:function(){return m()<12?p.timeNames[0]:p.timeNames[1]},tt:function(){return m()<12?p.timeNames[2]:p.timeNames[3]},T:function(){return m()<12?p.timeNames[4]:p.timeNames[5]},TT:function(){return m()<12?p.timeNames[6]:p.timeNames[7]},Z:function(){return u?"GMT":o?"UTC":ve(a)},o:function(){return(w()>0?"-":"+")+h(Math.floor(Math.abs(w())/60)*100+Math.abs(w())%60,4)},p:function(){return(w()>0?"-":"+")+h(Math.floor(Math.abs(w())/60),2)+":"+h(Math.floor(Math.abs(w())%60),2)},S:function(){return["th","st","nd","rd"][d()%10>3?0:(d()%100-d()%10!=10)*d()%10]},W:function(){return F()},WW:function(){return h(F())},N:function(){return W()}};return n.replace(me,function(e){return e in O?O[e]():e.slice(1,e.length-1)})}var q={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},p={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},h=function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(n).padStart(o,"0")},G=function(n){var o=n.y,u=n.m,c=n.d,r=n._,d=n.dayName,T=n.short,v=T===void 0?!1:T,b=new Date,m=new Date;m.setDate(m[r+"Date"]()-1);var N=new Date;N.setDate(N[r+"Date"]()+1);var D=function(){return b[r+"Date"]()},H=function(){return b[r+"Month"]()},w=function(){return b[r+"FullYear"]()},F=function(){return m[r+"Date"]()},W=function(){return m[r+"Month"]()},O=function(){return m[r+"FullYear"]()},e=function(){return N[r+"Date"]()},U=function(){return N[r+"Month"]()},E=function(){return N[r+"FullYear"]()};return w()===o&&H()===u&&D()===c?v?"Tdy":"Today":O()===o&&W()===u&&F()===c?v?"Ysd":"Yesterday":E()===o&&U()===u&&e()===c?v?"Tmw":"Tomorrow":d},fe=function(n){var o=new Date(n.getFullYear(),n.getMonth(),n.getDate());o.setDate(o.getDate()-(o.getDay()+6)%7+3);var u=new Date(o.getFullYear(),0,4);u.setDate(u.getDate()-(u.getDay()+6)%7+3);var c=o.getTimezoneOffset()-u.getTimezoneOffset();o.setHours(o.getHours()-c);var r=(o-u)/(864e5*7);return 1+Math.floor(r)},pe=function(n){var o=n.getDay();return o===0&&(o=7),o},ve=function(n){return(String(n).match(ce)||[""]).pop().replace(ye,"").replace(/GMT\+0000/g,"UTC")};const _e={class:"w-full bg-white p-2 rounded-lg"},ge=f("div",{class:"col-sm-12 col-xxl-6 col-md-6 col-xl-6 col-lg-6"},[f("h6",{class:"my-2 text-lg font-semibold"},"Leave Approvals")],-1),he={class:"confirmation-content d-flex justify-content-start align-items-center mt-3 ml-3"},De=f("i",{class:"mr-3 pi pi-exclamation-triangle text-red-600",style:{"font-size":"2rem"}},null,-1),Te={class:"w-full d-flex justify-content-start align-items-center mt-4 pl-3",style:{"margin-bottom":"-12px"}},we={class:"confirmation-content"},Me=f("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),be={class:"mt-3"},Ne={class:"flex justify-center items-center"},Se=["src"],xe={class:"text-left pl-2 font-semibold fs-6"},Ce={key:0},ke=f("div",null,null,-1),Ae={key:0},Le={key:1},He={key:1},Fe={key:0},Je={__name:"LeaveApproval",setup(a){const n=ue();let o=C(),u=C(!1),c=C(!1),r=C(),d=C(!1);ie(),le();const T=C(),v=C({global:{value:null,matchMode:P.CONTAINS},employee_name:{value:null,matchMode:P.STARTS_WITH,matchMode:P.EQUALS,matchMode:P.CONTAINS},status:{value:"Pending",matchMode:P.EQUALS}});C(!1);const b=C(["Pending","Approved","Rejected"]),m=C(),N=i=>{m.value.toggle(i)};let D=null,H=null;const w=re({review_comment:""});oe(()=>{F()});function F(){d.value=!0;let i=window.location.origin+"/fetch-leaverequests-based-on-currentrole";I.get(i).then(y=>{o.value=y.data.data}).finally(()=>{d.value=!1})}function W(i){return isNaN(Date.parse(i))?"Invalid date":$(i,"dd-mm-yyyy, h:MM TT")}function O(i,y){c.value=!1,u.value=!0,D=y,H=i,console.log("Selected Row Data : "+JSON.stringify(i))}function e(i){u.value=!1,i&&U()}function U(){D="",H=null}function E(){console.log(w.review_comment),e(!1),d.value=!0,I.post(window.location.origin+"/attendance-approve-rejectleave",{record_id:H.id,status:D=="Approve"?"Approved":D=="Reject"?"Rejected":D,review_comment:w.review_comment}).then(i=>{if(console.log(i),U(),i.data.status=="success")F();else if(i.data.status=="failure"){c.value=!0,r.value=i.data.message;return}}).catch(i=>{d.value=!1,U(),console.log(i.toJSON())}).finally(()=>{d.value=!1})}const S=i=>{switch(i){case"Rejected":return"danger";case"Approved":return"success";case"Pending":return"warning"}};return(i,y)=>{const Q=k("Toast"),K=k("Textarea"),V=k("Button"),B=k("Dialog"),X=k("InputText"),x=k("Column"),ee=k("OverlayPanel"),te=k("Tag"),ae=k("Dropdown"),ne=k("DataTable");return M(),A(se,null,[L(d)?(M(),Y(de,{key:0,class:"absolute z-50 bg-white"})):z("",!0),f("div",_e,[ge,s(Q),s(B,{header:"Confirmation",visible:L(u),"onUpdate:visible":y[3]||(y[3]=t=>Z(u)?u.value=t:u=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"450px"},modal:!0},{footer:l(()=>[s(V,{label:"Yes",icon:"pi pi-check",onClick:y[1]||(y[1]=t=>E()),class:"p-button-text",autofocus:""}),s(V,{label:"No",icon:"pi pi-times",onClick:y[2]||(y[2]=t=>e(!0)),class:"p-button-text"})]),default:l(()=>[f("div",he,[De,f("span",null,"Are you sure you want to "+g(L(D))+"?",1)]),f("div",Te,[L(D)=="Reject"?(M(),Y(K,{key:0,name:"",id:"",modelValue:T.value,"onUpdate:modelValue":y[0]||(y[0]=t=>T.value=t),class:"border p-2 rounded",cols:"45",rows:"4",autoResize:"",placeholder:"Add Comment"},null,8,["modelValue"])):z("",!0),R(" "+g(T.value),1)])]),_:1},8,["visible"]),s(B,{header:"Error",visible:L(c),"onUpdate:visible":y[4]||(y[4]=t=>Z(c)?c.value=t:c=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:l(()=>[s(V,{label:"Ok",icon:"pi pi-check",autofocus:""})]),default:l(()=>[f("div",we,[Me,f("span",null,"Error while processing the request : "+g(L(r)),1)])]),_:1},8,["visible"]),f("div",be,[s(ne,{value:L(o),paginator:!0,rows:10,dataKey:"id",rowsPerPageOptions:[5,10,25],paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",sortField:"leaverequest_date",sortOrder:-1,filters:v.value,"onUpdate:filters":y[5]||(y[5]=t=>v.value=t),filterDisplay:"menu",globalFilterFields:["name","status"],style:{"white-space":"nowrap"}},{empty:l(()=>[R(" No Employee found ")]),loading:l(()=>[R(" Loading customers data. Please wait. ")]),default:l(()=>[s(x,{class:"font-bold",field:"employee_name",header:"Employee Name",style:{"min-width":"18em"}},{body:l(t=>[f("div",Ne,[JSON.parse(t.data.employee_avatar).type=="shortname"?(M(),A("p",{key:0,class:J(["p-2 w-11 fs-6 font-semibold rounded-full text-white",L(n).getBackgroundColor(t.index)])},g(JSON.parse(t.data.employee_avatar).data),3)):(M(),A("img",{key:1,class:"rounded-circle img-md w-10 userActive-status profile-img",style:{height:"30px !important"},src:`data:image/png;base64,${JSON.parse(t.data.employee_avatar).data}`,srcset:"",alt:""},null,8,Se)),f("p",xe,g(t.data.employee_name),1)])]),filter:l(({filterModel:t,filterCallback:j})=>[s(X,{modelValue:t.value,"onUpdate:modelValue":_=>t.value=_,onInput:_=>j(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),s(x,{field:"leaverequest_date",header:"Date",sortable:!0},{body:l(t=>[R(g(L($)(t.data.leaverequest_date,"dd-mm-yyyy, h:MM TT")),1)]),_:1}),s(x,{field:"leave_type",header:"Leave Type"},{body:l(t=>[t.data.leave_type=="Casual/Sick Leave"?(M(),A("h1",Ce," SL/CL ")):z("",!0),ke]),_:1}),s(x,{field:"start_date",header:"Start Time"},{body:l(t=>[R(g(W(t.data.start_date)),1)]),_:1}),s(x,{field:"end_date",header:"End Time"},{body:l(t=>[R(g(W(t.data.end_date))+" ",1)]),_:1}),s(x,{field:"leave_reason",header:"Leave Reason",style:{"min-width":"25em","white-space":"pre-wrap"}},{body:l(t=>[t.data.leave_reason.length>80?(M(),A("div",Ae,[f("p",{onClick:N,class:"font-medium text-orange-400 underline cursor-pointer"},"explore more... "),s(ee,{ref_key:"overlayPanel",ref:m,style:{height:"80px"}},{default:l(()=>[R(g(t.data.leave_reason),1)]),_:2},1536)])):(M(),A("div",Le,g(t.data.leave_reason),1))]),_:1}),s(x,{field:"reviewer_name",header:"Approver Name"}),s(x,{field:"reviewer_comments",header:"Approver Comments"}),s(x,{field:"status",header:"Status",icon:"pi pi-check"},{body:l(({data:t})=>[s(te,{value:t.status,severity:S(t.status)},null,8,["value","severity"])]),filter:l(({filterModel:t,filterCallback:j})=>[s(ae,{modelValue:t.value,"onUpdate:modelValue":_=>t.value=_,onChange:_=>j(),options:b.value,placeholder:"Select",class:"p-column-filter",showClear:!0},{value:l(_=>[_.value?(M(),A("span",{key:0,class:J("customer-badge status-"+_.value)},g(_.value),3)):(M(),A("span",He,g(_.placeholder),1))]),option:l(_=>[f("span",{class:J("customer-badge status-"+_.option)},g(_.option),3)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","options"])]),_:1}),s(x,{style:{width:"300px"},field:"",header:"Action"},{body:l(t=>[t.data.status=="Pending"?(M(),A("span",Fe,[s(V,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:j=>O(t.data,"Approve"),style:{height:"2em"}},null,8,["onClick"]),s(V,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2em"},onClick:j=>O(t.data,"Reject")},null,8,["onClick"])])):z("",!0)]),_:1})]),_:1},8,["value","filters"])])])],64)}}};export{Je as default};
