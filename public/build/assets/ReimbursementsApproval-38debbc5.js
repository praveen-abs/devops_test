/* empty css              *//* empty css                     *//* empty css                   *//* empty css                 */import{H as s,a9 as S,I as X,o as T,c as E,h as t,w as n,b as Z,a as j,d as i,l as p,J as g,t as m,n as ee,_ as I,F as te,g as u,K as oe,P as ae,R as le,u as se,x as ne,L as ie,N as re,S as de,M as ce}from"./inputnumber.esm-2ef94937.js";import{u as pe,a as ue,T as me,B as ve,S as fe,b as _e,s as ge}from"./toastservice.esm-a2aa885f.js";import"./blockui.esm-1772f2aa.js";import{a as be}from"./datatable.esm-9e333783.js";import{D as he,s as we}from"./dialogservice.esm-4374de6d.js";import{u as ye,C as Se}from"./confirmationservice.esm-d19112e7.js";import{s as Ce}from"./progressspinner.esm-311b8ec7.js";import{s as xe}from"./row.esm-6ebc942e.js";import{s as Re}from"./calendar.esm-11c715d3.js";import{h as F}from"./moment-fbc5633a.js";import{s as ke}from"./checkbox.esm-3eaffbbf.js";import{a as z}from"./index-362795f3.js";import{L as Ae}from"./LoadingSpinner-9dbead47.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-c27b6911.js";const De=i("h5",null,"Do you want to approve all?",-1),Te={class:"w-full"},Me=i("h6",{class:"font-semibold text-lg"},"Reimbursement Approvals",-1),Ne={class:"flex justify-end"},Pe={class:"grid grid-cols-4 w-1/2 gap-2"},$e=["disabled"],Le=i("i",{class:"fa fa-cog me-2"},null,-1),Ue=["disabled"],Ve=i("i",{class:"fas fa-file-download me-2"},null,-1),Be={key:0},Ee={class:"orders-subtable"},je={style:{"white-space":"nowrap"}},Ie=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),ze={class:"confirmation-content"},Fe=i("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Oe={__name:"ReimbursementsApproval",setup(Ye){let C=s(),_=s(!1),b=s(!1);const h=s(!1);ye();const O=pe();s(!0);const M=s([]);s(!1),s(!1);const x=s();s(),s(!0),s({global:{value:null,matchMode:S.CONTAINS},name:{value:null,matchMode:S.STARTS_WITH,matchMode:S.EQUALS,matchMode:S.CONTAINS},status:{value:null,matchMode:S.EQUALS}});const Y=s(["Pending","Approved","Rejected"]);let v=null,R=null;const H=s(!0);X(()=>{C.value=[],f.value=new Date,console.log(f.value)});function N(l,o){_.value=!0,v=o,R=l,console.log("Selected Row Data : "+JSON.stringify(l))}function P(l){_.value=!1,l&&A()}function A(){v="",R=null}const f=s(),w=s();s(!1);const k=s(!1),$=s(),L=()=>{let l=new Date(f.value),o=l.getFullYear(),y=l.getMonth()+1;console.log(f.value.toString()),console.log($),h.value=!0,z.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:o,selected_month:y,selected_status:w.value,selected_reimbursement_type:""}).then(d=>{console.log("data sent"),console.log("data from "+d.employee_name),C.value=d.data,$.value=d.data,h.value=!1}).catch(d=>{console.log(d)})},J=()=>{let l=new Date(f.value);h.value=!0;let o=l.getFullYear(),y=l.getMonth()+1;H.value=!1;let d="/reports/generate-manager-reimbursements-reports?selected_year="+o+"&selected_month="+y+"&selected_status="+w.value+"&_token={{ csrf_token() }}";window.location=d,setTimeout(U,1e3)},U=()=>{h.value=!1};setTimeout(U,3e3);function K(){P(!1),console.log("Processing Rowdata : "+JSON.stringify(R)),console.log("currentlySelectedStatus : "+v),z.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:R,status:v=="Approve"?"Approved":v=="Reject"?"Rejected":v,reviewer_comments:""}).then(l=>{console.log(l),L(),O.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),A()}).catch(l=>{b.value=!1,A(),console.log(l.toJSON())})}return s(),(l,o)=>{const y=u("Toast"),d=u("Button"),D=u("Dialog"),G=u("Calendar"),Q=u("Dropdown"),r=u("Column"),W=u("InputText"),V=u("DataTable"),q=u("ProgressSpinner");return T(),E(te,null,[t(y),t(D,{visible:k.value,"onUpdate:visible":o[2]||(o[2]=e=>k.value=e),modal:"",header:"Header",style:{width:"25vw"}},{footer:n(()=>[t(d,{label:"No",icon:"pi pi-times",onClick:o[0]||(o[0]=e=>k.value=!1),text:""}),t(d,{label:"Yes",icon:"pi pi-check",onClick:o[1]||(o[1]=e=>k.value=!1),autofocus:""})]),default:n(()=>[De]),_:1},8,["visible"]),h.value?(T(),Z(Ae,{key:0,class:"absolute z-50 bg-white"})):j("",!0),i("div",Te,[Me,i("div",Ne,[i("div",Pe,[t(G,{modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=e=>f.value=e),view:"month",dateFormat:"mm/yy",class:"",style:{"border-radius":"7px",height:"30px"}},null,8,["modelValue"]),t(Q,{modelValue:w.value,"onUpdate:modelValue":o[4]||(o[4]=e=>w.value=e),options:Y.value,placeholder:"Status",class:"w-full",style:{"border-radius":"7px",height:"30px"}},null,8,["modelValue","options"]),i("button",{label:"Submit",class:"btn btn-primary z-0 whitespace-nowrap",severity:"danger",style:{height:"30px"},disabled:!w.value!="",onClick:L},[Le,p(" Generate")],8,$e),i("button",{class:"btn btn-primary whitespace-nowrap mx-3 z-0",disabled:g(C)=="",severity:"success",onClick:J,style:{height:"30px"}},[Ve,p("Download")],8,Ue)])]),i("div",null,[i("div",null,[t(V,{value:g(C),paginator:!0,rows:10,class:"mt-6",dataKey:"user_id",onRowExpand:l.onRowExpand,onRowCollapse:l.onRowCollapse,expandedRows:M.value,"onUpdate:expandedRows":o[6]||(o[6]=e=>M.value=e),selection:x.value,"onUpdate:selection":o[7]||(o[7]=e=>x.value=e),selectAll:l.selectAll,onSelectAllChange:l.onSelectAllChange,onRowSelect:l.onRowSelect,onRowUnselect:l.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:n(()=>[p(" No Reimbursement data for the selected status filter ")]),loading:n(()=>[p(" Loading customers data. Please wait. ")]),expansion:n(e=>[i("div",Ee,[t(V,{value:e.data.reimbursement_data,responsiveLayout:"scroll",selection:x.value,"onUpdate:selection":o[5]||(o[5]=c=>x.value=c),selectAll:l.selectAll,onSelectAllChange:l.onSelectAllChange},{default:n(()=>[t(r,{field:"",header:"Date",sortable:""},{body:n(c=>[i("p",je,m(g(F)(c.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),t(r,{field:"reimbursement_type",header:"Reimbursement Type"}),t(r,{field:"from",header:"From"}),t(r,{field:"to",header:"To"}),t(r,{field:"user_comments",header:"Comments"}),t(r,{field:"vehicle_type",header:"Mode of transport"}),t(r,{class:"fontSize13px",field:"distance_travelled",header:"Distance Covered"},{body:n(c=>[p(m(c.data.distance_travelled+" KM(s)"),1)]),_:2},1024),t(r,{class:"fontSize13px",field:"total_expenses",header:"Total Expenses"},{body:n(c=>[p(m("₹ "+c.data.total_expenses),1)]),_:2},1024),t(r,{field:"status",header:"Status",sortable:""},{body:n(c=>[i("span",{class:ee("order-badge order-"+c.data.status)},m(c.data.status),3)]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:n(()=>[t(r,{expander:!0}),t(r,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),t(r,{field:"user_code",header:"Employee Id",sortable:""}),t(r,{field:"name",header:"Employee Name"},{body:n(e=>[p(m(e.data.employee_name),1)]),filter:n(({filterModel:e,filterCallback:c})=>[t(W,{modelValue:e.value,"onUpdate:modelValue":B=>e.value=B,onInput:B=>c(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),t(r,{class:"fontSize13px",field:"total_distance_travelled",header:"Overall Distance Travelled",sortable:!1},{body:n(e=>[p(m(e.data.total_distance_travelled+" KM(s)"),1)]),_:1}),t(r,{class:"fontSize13px",field:"total_expenses",header:"Overall Reimbursements",sortable:!1},{body:n(e=>[p(m("₹ "+e.data.total_expenses),1)]),_:1}),t(r,{field:"",header:"Action",style:{width:"15vw"}},{body:n(e=>[e.data.has_pending_reimbursements=="true"?(T(),E("span",Be,[t(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:c=>N(e.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),t(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:c=>N(e.data,"Reject")},null,8,["onClick"])])):j("",!0)]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"])])])]),t(D,{header:"Header",visible:g(b),"onUpdate:visible":o[8]||(o[8]=e=>I(b)?b.value=e:b=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:n(()=>[t(q,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:n(()=>[Ie]),_:1},8,["visible"]),t(D,{header:"Confirmation",visible:g(_),"onUpdate:visible":o[11]||(o[11]=e=>I(_)?_.value=e:_=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:n(()=>[t(d,{label:"Yes",icon:"pi pi-check",onClick:o[9]||(o[9]=e=>K()),class:"p-button-text",autofocus:""}),t(d,{label:"No",icon:"pi pi-times",onClick:o[10]||(o[10]=e=>P(!0)),class:"p-button-text"})]),default:n(()=>[i("div",ze,[Fe,i("span",null,"Are you sure you want to "+m(g(v))+"?",1)])]),_:1},8,["visible"])],64)}}},a=oe(Oe);a.use(ae,{ripple:!0});a.use(Se);a.use(ue);a.use(he);a.directive("tooltip",me);a.directive("badge",ve);a.directive("ripple",le);a.directive("styleclass",fe);a.directive("focustrap",se);a.component("Button",ne);a.component("DataTable",be);a.component("Column",ie);a.component("ColumnGroup",we);a.component("Row",xe);a.component("Toast",_e);a.component("ConfirmDialog",ge);a.component("Dropdown",re);a.component("InputText",de);a.component("Dialog",ce);a.component("ProgressSpinner",Ce);a.component("Calendar",Re);a.component("moment",F);a.component("Checkbox",ke);a.mount("#vjs_reimbursementsApprovalTable");
