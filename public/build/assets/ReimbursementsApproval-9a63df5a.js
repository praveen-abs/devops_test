import{V as n,Q as te,X as oe,c as O,h as o,w as s,e as i,j as f,b as F,a as T,Y as y,a2 as I,F as le,K as R,W as P,g as m,o as A,t as h,n as ae,B as se,P as ne,E as ie,R as re,q as ce}from"./index-fca754c1.js";import{u as de,C as ue,T as pe,B as me,S as ve,F as fe,c as ge,b as be,e as _e,a as he,d as we}from"./styleclass.esm-1f250c0e.js";import"./blockui.esm-6a519c3a.js";import{s as ye}from"./confirmdialog.esm-5d1a5d78.js";import{D as Ce}from"./dialogservice.esm-6315b049.js";import{s as Se}from"./toast.esm-5d4b434c.js";import{s as xe}from"./progressspinner.esm-5644b1af.js";import{s as Re}from"./row.esm-6ebc942e.js";import{s as ke}from"./columngroup.esm-9dd1458e.js";import{s as Ae}from"./calendar.esm-6b426cdb.js";import{h as Y}from"./moment-fbc5633a.js";import{s as De}from"./checkbox.esm-2434a4e8.js";const Te=i("h5",null,"Do you want to approve all?",-1),Pe={class:"flex justify-content-between align-items-center"},$e={class:"flex justify-content-between align-items-center"},Ue=["disabled"],je=i("i",{class:"fa fa-cog me-2"},null,-1),Ne=["disabled"],Ve=i("i",{class:"fas fa-file-download me-2"},null,-1),Me=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),Ee=i("h5",{style:{"text-align":"center"}},"Please wait...",-1),Le={class:"confirmation-content"},Be=i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Oe={key:0},Fe={class:"orders-subtable"},Ie={style:{"white-space":"nowrap"}},Ye={__name:"ReimbursementsApproval",setup(ze){let C=n(),g=n(!1),b=n(!1);const w=n(!1);de();const z=te();n(!0);const $=n([]);n(!1),n(!1);const p=n();n(),n(!0),n({global:{value:null,matchMode:R.CONTAINS},name:{value:null,matchMode:R.STARTS_WITH,matchMode:R.EQUALS,matchMode:R.CONTAINS},status:{value:null,matchMode:R.EQUALS}});const J=n(["Pending","Approved","Rejected"]);let v=null,S=null;const H=n(!0);oe(()=>{C.value=[],_.value=new Date,console.log(_.value)});function W(){let l=window.location.origin+"/fetch_all_reimbursements_as_groups";console.log("AJAX URL : "+l),P.get(l).then(e=>{C.value=e.data,console.log(e.data),console.log(Object.keys(e.data))})}function U(l,e){g.value=!0,v=e,S=l,console.log("Selected Row Data : "+JSON.stringify(l))}function j(l,e){console.log(p.value),Object.values(p.value).forEach(c=>{console.log(c.employee_name)}),g.value=!0,v=e,S=l,console.log("Selected Row Data : "+JSON.stringify(l))}function N(l){g.value=!1,l&&D()}function D(){v="",S=null}const _=n(),x=n();n(!1);const k=n(!1),V=n(),G=()=>{let l=new Date(_.value),e=l.getFullYear(),d=l.getMonth()+1;console.log(_.value.toString()),console.log(V),w.value=!0,P.post(window.location.origin+"/fetch_all_reimbursements_as_groups",{selected_year:e,selected_month:d,selected_status:x.value}).then(c=>{console.log("data sent"),console.log("data from "+c.employee_name),C.value=c.data,V.value=c.data,w.value=!1}).catch(c=>{console.log(c)})},K=()=>{let l=new Date(_.value);w.value=!0;let e=l.getFullYear(),d=l.getMonth()+1;H.value=!1;let c="/reports/generate-manager-reimbursements-reports?selected_year="+e+"&selected_month="+d+"&selected_status="+x.value+"&_token={{ csrf_token() }}";window.location=c,setTimeout(M,1e3)},M=()=>{w.value=!1};setTimeout(M,3e3);function Q(){N(!1),b.value=!0,console.log("Processing Rowdata : "+JSON.stringify(S)),console.log("currentlySelectedStatus : "+v),P.post(window.location.origin+"/reimbursements_bulk_approval",{reimbursement_id:S,status:v=="Approve"?"Approved":v=="Reject"?"Rejected":v,reviewer_comments:""}).then(l=>{console.log(l),b.value=!1,z.add({severity:"success",summary:"",detail:" Successfully Approved !",life:3e3}),W(),D()}).catch(l=>{b.value=!1,D(),console.log(l.toJSON())})}return n(),(l,e)=>{const d=m("Button"),c=m("Dialog"),X=m("Calendar"),q=m("Dropdown"),Z=m("Toast"),E=m("ProgressSpinner"),r=m("Column"),ee=m("InputText"),L=m("DataTable");return A(),O(le,null,[o(c,{visible:k.value,"onUpdate:visible":e[2]||(e[2]=t=>k.value=t),modal:"",header:"Header",style:{width:"25vw"}},{footer:s(()=>[o(d,{label:"No",icon:"pi pi-times",onClick:e[0]||(e[0]=t=>k.value=!1),text:""}),o(d,{label:"Yes",icon:"pi pi-check",onClick:e[1]||(e[1]=t=>k.value=!1),autofocus:""})]),default:s(()=>[Te]),_:1},8,["visible"]),i("div",Pe,[i("div",$e,[o(X,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),view:"month",dateFormat:"mm/yy",class:""},null,8,["modelValue"]),o(q,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=t=>x.value=t),options:J.value,placeholder:"Status",class:"w-full md:w-14rem mx-3"},null,8,["modelValue","options"]),i("button",{label:"Submit",class:"btn btn-primary",severity:"danger",disabled:!x.value!="",onClick:G},[je,f(" Generate")],8,Ue)]),!p.value==""?(A(),F(d,{key:0,label:"Approve all",icon:"pi pi-check",severity:"success",onClick:e[5]||(e[5]=t=>j(p.value,"Approve")),style:{"margin-left":"30rem",height:"2.5em"}})):T("",!0),!p.value==""?(A(),F(d,{key:1,type:"button",icon:"pi pi-times-circle",severity:"danger",label:"Reject all",style:{height:"2.5em"},onClick:e[6]||(e[6]=t=>j(p.value,"Reject"))})):T("",!0),i("button",{class:"btn btn-primary",disabled:y(C)=="",severity:"success",onClick:K},[Ve,f("Download")],8,Ne)]),i("div",null,[o(Z),o(c,{header:"Header",visible:w.value,"onUpdate:visible":e[7]||(e[7]=t=>w.value=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[o(E,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[Me]),_:1},8,["visible"]),o(c,{header:"Header",visible:y(b),"onUpdate:visible":e[8]||(e[8]=t=>I(b)?b.value=t:b=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:s(()=>[o(E,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:s(()=>[Ee]),_:1},8,["visible"]),o(c,{header:"Confirmation",visible:y(g),"onUpdate:visible":e[11]||(e[11]=t=>I(g)?g.value=t:g=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:s(()=>[o(d,{label:"Yes",icon:"pi pi-check",onClick:e[9]||(e[9]=t=>Q()),class:"p-button-text",autofocus:""}),o(d,{label:"No",icon:"pi pi-times",onClick:e[10]||(e[10]=t=>N(!0)),class:"p-button-text"})]),default:s(()=>[i("div",Le,[Be,i("span",null,"Are you sure you want to "+h(y(v))+"?",1)])]),_:1},8,["visible"]),i("div",null,[o(L,{value:y(C),paginator:!0,rows:10,class:"mt-6",dataKey:"user_id",onRowExpand:l.onRowExpand,onRowCollapse:l.onRowCollapse,expandedRows:$.value,"onUpdate:expandedRows":e[13]||(e[13]=t=>$.value=t),selection:p.value,"onUpdate:selection":e[14]||(e[14]=t=>p.value=t),selectAll:l.selectAll,onSelectAllChange:l.onSelectAllChange,onRowSelect:l.onRowSelect,onRowUnselect:l.onRowUnselect,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:s(()=>[f(" No Reimbursement data for the selected status filter ")]),loading:s(()=>[f(" Loading customers data. Please wait. ")]),expansion:s(t=>[i("div",Fe,[o(L,{value:t.data.reimbursement_data,responsiveLayout:"scroll",selection:p.value,"onUpdate:selection":e[12]||(e[12]=u=>p.value=u),selectAll:l.selectAll,onSelectAllChange:l.onSelectAllChange},{default:s(()=>[o(r,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),o(r,{field:"",header:"Date",sortable:""},{body:s(u=>[i("p",Ie,h(y(Y)(u.data.date).format("DD-MMM-YYYY")),1)]),_:2},1024),o(r,{field:"from",header:"From"}),o(r,{field:"to",header:"To"}),o(r,{field:"user_comments",header:"Comments"}),o(r,{field:"vehicle_type",header:"Mode of transport"}),o(r,{class:"fontSize13px",field:"distance_travelled",header:"Distance Covered"}),o(r,{class:"fontSize13px",field:"total_expenses",header:"Total Expenses"},{body:s(u=>[f(h("₹ "+u.data.total_expenses),1)]),_:2},1024),o(r,{field:"status",header:"Status",sortable:""},{body:s(u=>[i("span",{class:ae("order-badge order-"+u.data.status)},h(u.data.status),3)]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:s(()=>[o(r,{expander:!0}),o(r,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),o(r,{field:"user_code",header:"Employee Id",sortable:""}),o(r,{field:"name",header:"Employee Name"},{body:s(t=>[f(h(t.data.employee_name),1)]),filter:s(({filterModel:t,filterCallback:u})=>[o(ee,{modelValue:t.value,"onUpdate:modelValue":B=>t.value=B,onInput:B=>u(),placeholder:"Search",class:"p-column-filter",showClear:!0},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),o(r,{class:"fontSize13px",field:"total_distance_travelled",header:"Overall Distance Travelled",sortable:!1},{body:s(t=>[f(h(t.data.total_distance_travelled+" KM"),1)]),_:1}),o(r,{class:"fontSize13px",field:"total_expenses",header:"Overall Reimbursements",sortable:!1},{body:s(t=>[f(h("₹ "+t.data.total_expenses),1)]),_:1}),o(r,{field:"",header:"Action"},{body:s(t=>[t.data.has_pending_reimbursements=="true"?(A(),O("span",Oe,[o(d,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:u=>U(t.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),o(d,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:u=>U(t.data,"Reject")},null,8,["onClick"])])):T("",!0)]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"])])])],64)}}},a=se(Ye);a.use(ne,{ripple:!0});a.use(ue);a.use(ie);a.use(Ce);a.directive("tooltip",pe);a.directive("badge",me);a.directive("ripple",re);a.directive("styleclass",ve);a.directive("focustrap",fe);a.component("Button",ce);a.component("DataTable",ge);a.component("Column",be);a.component("ColumnGroup",ke);a.component("Row",Re);a.component("Toast",Se);a.component("ConfirmDialog",ye);a.component("Dropdown",_e);a.component("InputText",he);a.component("Dialog",we);a.component("ProgressSpinner",xe);a.component("Calendar",Ae);a.component("moment",Y);a.component("Checkbox",De);a.mount("#vjs_reimbursementsApprovalTable");
