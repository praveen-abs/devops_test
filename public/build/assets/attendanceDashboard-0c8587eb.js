import{_ as W}from"./no-data-d6f55554.js";import{d as Q}from"./dayjs.min-2f06af28.js";import{e as H}from"./exceljs.min-edd65134.js";import{a as V,c as j}from"./index-362795f3.js";import{q as Z,r as u,h as o,e as x,f as b,g as e,t as m,j as F,o as G,c as R,k as z,F as U,m as I,H as Y,i as B,n as v,p as P,_ as ee,l as L,C as te,D as oe}from"./app-e362a0cc.js";import{L as ne}from"./LoadingSpinner-9ad5eb93.js";import"./_commonjs-dynamic-modules-302442b1.js";/* empty css                                                                       */const se="/build/assets/present-img-ae7c8f7a.png",ae="/build/assets/Absent-6ed9e5f4.png",le="/build/assets/Leave-4ca0d5f0.png",ie="/build/assets/Early_going-6bfb3337.png",re="/build/assets/Late_coming-52c4aae0.png",q="/build/assets/MIP_MOP-c9ad109b.png",M=Z("useAttendanceDashboardMainStore",()=>{const w=u(!1);u();const t=u(),f=u(),c=u(!1),h=u(!1),g=u(),d=u([]),p=u(),a=u(),n=u([]),s=u([]),r=u(),l=u([]),i=u(),A=u(),$=u([]),y=u(),_=u([{label:"Absent",backgroundColor:"#FFB1B8",count:null},{label:"Present",backgroundColor:"#7A5EA2",count:null},{label:"Leave",backgroundColor:"#8D98B5",count:null},{label:"Late coming",backgroundColor:"#D9AA63",count:null},{label:"Early going",backgroundColor:"#6BB7C0",count:null},{label:"Missed out punch",backgroundColor:"#000000",count:null},{label:"Missed in punch",backgroundColor:"#000000",count:null}]);function C(){V.get("/fetch-departments").then(O=>{y.value=O.data,console.log(O.data)}).finally(()=>{})}function S(O){V.post("/get-attendance-dashboard",{id:O}).then(E=>{}).finally(()=>{})}return{canShowLoading:w,attendanceDashboardWorkShiftSource:f,getAttendanceDashboardMainSource:async()=>{w.value=!0;let O="/get-attendance-dashboard";await V.get(O).then(E=>{t.value=E.data.attendance_overview,i.value=E.data.total_Employees,console.log(" totalEmployeeInOrganization.value"+i.value),_.value[0].count=parseInt(t.value.absent_count),_.value[1].count=parseInt(t.value.present_count),_.value[2].count=parseInt(t.value.leave_emp_count),_.value[3].count=parseInt(t.value.lg_count),_.value[4].count=parseInt(t.value.eg_count),_.value[5].count=parseInt(t.value.mop_count),_.value[6].count=parseInt(t.value.mip_count),f.value=E.data.work_shift;let X=Object.entries(E.data.upcomings).map(D=>({title:D[0],value:D[1]}));a.value=X;let K=Object.entries(E.data.attendance_overview).map(D=>({title:D[0],value:D[1]}));r.value=K;let J=["absent_count","present_count","leave_emp_count","lg_count","eg_count","mop_count","mip_count"];r.value.forEach(async D=>{l.value.length<7&&J.includes(D.title)&&l.value.push(D.value)}),A.value=E.data.CheckInMode,A.value.forEach(async D=>{$.value.length<3&&$.value.push(D.value)})}).finally(()=>{w.value=!1})},attendanceOverview:t,totalEmployeeInOrganization:i,chartDetails:_,canShowShiftDetails:c,canShowAttendanceOverview:h,selectedAttendanceOverviewReport:g,currentlySelectedShiftDetails:d,currentlySelectedShiftName:p,downloadShiftDetails:n,downloadAttendanceOverviewDetails:s,attendanceDashboardUpcoming:a,overallEmployeeCountForExceptionAnalytics:r,overallEmployeeCountForExceptionAnalyticsForGraph:l,AttendanceAnalytics:A,AttendanceAnalyticsForGraph:$,GetDepartment:C,departments:y,send_selectedDepartment:S}}),ce={key:0,class:"grid grid-cols-7 gap-4"},de={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ue={class:"mr-2 text-[28px] font-semibold text-center"},pe=e("img",{class:"ml-4 w-[20px] h-[20px]",src:se,alt:""},null,-1),_e=e("p",{class:"text-[18px] underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Present",-1),he={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ve={class:"text-[28px] font-semibold text-center"},me=e("img",{class:"ml-6 w-[20px] h-[20px]",src:ae,alt:""},null,-1),fe=e("p",{class:"text-[18px] underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Absent",-1),xe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ge={class:"text-[28px] font-semibold text-center"},be=e("img",{src:le,alt:"",class:"ml-6 w-[20px] h-[20px]"},null,-1),we=e("p",{class:"text-[18px] underline text-center text-gray-500 font-[Poppins] font-medium mt-[10px]"},"Leave",-1),ye={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Se={class:"text-[28px] font-semibold text-center"},$e=e("img",{src:ie,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Ce=e("p",{class:"text-[18px] underline font-semibold text-center text-gray-500 mt-[10px]"},"Late coming",-1),Ae={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},De={class:"text-[32px] font-semibold text-center"},ke=e("img",{src:re,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Ee=e("p",{class:"text-[18px] underline font-semibold text-center text-gray-500 mt-[10px]"},"Early going",-1),Oe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Le={class:"text-[28px] font-semibold text-center"},Re=e("img",{src:q,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Fe=e("p",{class:"text-[18px] underline font-semibold text-center text-gray-500 mt-[10px]"},"Missed in punch",-1),Me={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},je={class:"text-[28px] font-semibold text-center"},Pe=e("img",{src:q,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Be=e("p",{class:"text-[18px] underline font-semibold text-center text-gray-500 mt-[10px]"},"Missed out punch",-1),Ue={__name:"attendanceCount",setup(w){const t=M();return(f,c)=>o(t).attendanceOverview?(x(),b("div",ce,[e("div",{class:"bg-white rounded-lg py-2 !h-[104px] border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[0]||(c[0]=h=>(o(t).selectedAttendanceOverviewReport="Present",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.present_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.present_emps})))},[e("div",de,[e("span",ue,m(o(t).attendanceOverview.present_count),1),pe]),_e]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[1]||(c[1]=h=>(o(t).selectedAttendanceOverviewReport="Absent",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.absent_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.absent_emps})))},[e("div",he,[e("span",ve,m(o(t).attendanceOverview.absent_count),1),me]),fe]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[2]||(c[2]=h=>(o(t).selectedAttendanceOverviewReport="Leave",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.leave_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.leave_emps})))},[e("div",xe,[e("span",ge,m(o(t).attendanceOverview.leave_emp_count),1),be]),we]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[3]||(c[3]=h=>(o(t).selectedAttendanceOverviewReport="Late coming",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.lc_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.lc_emps})))},[e("div",ye,[e("span",Se,m(o(t).attendanceOverview.lg_count),1),$e]),Ce]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[4]||(c[4]=h=>(o(t).selectedAttendanceOverviewReport="Early going",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.eg_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.eg_emps})))},[e("div",Ae,[e("span",De,m(o(t).attendanceOverview.eg_count),1),ke]),Ee]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[5]||(c[5]=h=>(o(t).selectedAttendanceOverviewReport="Missed in punch",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.mip_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.mip_emps})))},[e("div",Oe,[e("span",Le,m(o(t).attendanceOverview.mip_count),1),Re]),Fe]),e("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:c[6]||(c[6]=h=>(o(t).selectedAttendanceOverviewReport="Missed out punch",o(t).canShowAttendanceOverview=!0,o(t).currentlySelectedShiftDetails={...o(t).attendanceOverview.mop_emps},o(t).downloadAttendanceOverviewDetails.push({...o(t).attendanceOverview.mop_emps})))},[e("div",Me,[e("span",je,m(o(t).attendanceOverview.mop_count),1),Pe]),Be])])):F("",!0)}},Te={key:0,class:"bg-white rounded-lg p-2 border"},Ie=e("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Attendance Analytics",-1),Ve={class:"grid grid-cols-2 gap-4 my-2.5"},Ge={class:"h-full"},He={class:"flex items-center"},Ne={class:""},We={class:"flex items-center gap-3"},ze={class:"font-semibold text-lg"},Ye={__name:"exceptionAnalytics",setup(w){const t=M();G(async()=>{await t.attendanceOverview,t.overallEmployeeCountForExceptionAnalyticsForGraph,c.value=h(),setTimeout(()=>{console.log(t.overallEmployeeCountForExceptionAnalyticsForGraph),f.value.datasets[0].data=t.overallEmployeeCountForExceptionAnalyticsForGraph},3e3)}),u([]);const f=u({labels:["Absent","Present","Leave","Late coming","Early going","Missed out punch","Missed in punch"],datasets:[{backgroundColor:["#FFB1B8","#7A5EA2","#8D98B5","#D9AA63","#6BB7C0","#000000","#000000"],data:[0,0,0,0,0,0,0]}]}),c=u();u();const h=()=>{const d=getComputedStyle(document.documentElement),p=d.getPropertyValue("--text-color");return d.getPropertyValue("--text-color-secondary"),d.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:p}}}}},g=(d,p)=>`${(d/p*100).toFixed(0)}`;return(d,p)=>{const a=R("Chart");return o(t).chartDetails?(x(),b("div",Te,[Ie,e("div",Ve,[e("div",Ge,[o(t).overallEmployeeCountForExceptionAnalyticsForGraph?(x(),z(a,{key:0,type:"pie",data:f.value,options:c.value,class:"h-full"},null,8,["data","options"])):F("",!0)]),e("div",He,[e("div",Ne,[e("div",null,[(x(!0),b(U,null,I(o(t).chartDetails,(n,s)=>(x(),b("div",We,[e("div",{style:Y({backgroundColor:n.backgroundColor}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),e("div",null,[B(m(n.label)+" - ",1),e("span",ze,m(g(n.count,o(t).totalEmployeeInOrganization)),1),B("% ")])]))),256))])])])])])):F("",!0)}}};const qe={key:0,class:"bg-white rounded-lg p-2 border"},Xe=e("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Check-In & Out Analytics ",-1),Ke={class:"grid grid-cols-2 gap-4 my-2.5"},Je={class:"h-full"},Qe={class:"flex items-center"},Ze={class:"my-auto"},et={class:"flex items-center gap-3"},tt={class:"font-semibold text-lg"},ot=e("div",null,null,-1),nt={__name:"attendanceAnalytics",setup(w){const t=M();G(()=>{c.value=h(),setTimeout(()=>{f.value.datasets[0].data=t.AttendanceAnalyticsForGraph},3e3)});const f=u({labels:["Bio-Metric","Mobile","Web"],datasets:[{data:[0,0,0],backgroundColor:["rgba(122, 94, 162, 1)","rgba(255, 177, 184, 1)","rgba(107, 183, 192, 1)"]}]}),c=u();u(0),u([{label:"Bio-Metric",backgroundColor:"rgba(122, 94, 162, 1)"},{label:"Mobile",backgroundColor:"rgba(255, 177, 184, 1)"},{label:"Web",backgroundColor:"rgba(107, 183, 192, 1)"}]);const h=()=>{const d=getComputedStyle(document.documentElement),p=d.getPropertyValue("--text-color");return d.getPropertyValue("--text-color-secondary"),d.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:p}}}}},g=(d,p)=>`${(d/p*100).toFixed(0)}`;return(d,p)=>{const a=R("Chart");return o(t).AttendanceAnalytics?(x(),b("div",qe,[Xe,e("div",Ke,[e("div",Je,[v(a,{type:"doughnut",data:f.value,options:c.value},null,8,["data","options"])]),e("div",Qe,[e("div",Ze,[e("div",null,[(x(!0),b(U,null,I(o(t).AttendanceAnalytics,(n,s)=>(x(),b("div",et,[e("div",{style:Y({backgroundColor:f.value.datasets[0].backgroundColor[s]}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),e("div",null,[B(m(n.title)+" - ",1),e("span",tt,m(g(n.value,o(t).totalEmployeeInOrganization)),1),B("% ")])]))),256))]),ot])])])])):F("",!0)}}},st={class:"bg-[#E4ECFF] rounded-[20px] p-3",style:{height:"200px"}},at=e("div",{class:"mx-4 flex items-center justify-between"},[e("span",{class:"font-semibold text-[14px] text-[#000] font-['Poppins]"},"Upcomings"),e("i",{class:"pi pi-calendar text-[#000] text-[16px]"})],-1),lt={class:"h-full overflow-x-scroll bg-[#E4ECFF] rounded-lg"},it={class:"px-auto"},rt={class:"p-2 my-2 transition duration-700 ease-in-out bg-white rounded-lg cursor-pointer hover:-translate-y-1 hover:scale-100"},ct={class:"flex px-2 justify-between items-center"},dt={class:"text-[14px] font-semibold"},ut={class:"flex items-center gap-6"},pt={class:"text-xl font-semibold text-black"},_t=e("span",null,[e("i",{class:"fa fa-chevron-right","aria-hidden":"true"})],-1),ht={key:1,class:"font-medium text-sm text-center"},vt={__name:"Upcomings",setup(w){const t=M();return(f,c)=>(x(),b("div",st,[at,e("div",lt,[o(t).attendanceDashboardUpcoming?(x(!0),b(U,{key:0},I(o(t).attendanceDashboardUpcoming,h=>(x(),b("div",it,[e("div",rt,[e("div",ct,[e("div",null,[e("span",dt,m(h.title),1)]),e("div",ut,[e("span",pt,m(h.value),1),_t])])])]))),256)):(x(),b("p",ht,"No data to display"))])]))}},mt={key:0,class:"bg-white p-2 rounded-[6px] border"},ft=e("span",{class:"font-semibold text-[#000] font-['Poppins] text-[16px]"},"Shift",-1),xt={class:"flex flex-row w-[100%]"},gt={class:"mx-[10px] flex my-2"},bt=["onClick"],wt={class:"p-3"},yt=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Shift Timing",-1),St={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},$t={class:"my-3"},Ct=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Total Employees",-1),At={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Dt={class:"flex justify-between"},kt=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Present",-1),Et={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Ot={class:"mx-3"},Lt=e("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Absent",-1),Rt={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Ft={__name:"Shifts",setup(w){const t=M();function f(n){const[s,r]=n.split(":").map(Number),l=s>=12?"PM":"AM";return`${s%12===0?12:s%12}:${String(r).padStart(2,"0")} ${l}`}const c=["bg-[#FFD757]","bg-[#D91010]","bg-[#FFBC6D]","bg-[#B8B8B8]","bg-[#000000]","bg-[#FFE9A3]"],h=n=>c[n%c.length],g=["bg-[#FFF3CB]","bg-[#FFC6C6]","bg-[#FFEBD3]","bg-[#EEEEEE]","bg-[#E3E3E3]","bg-[#FFF7DF]"],d=n=>g[n%g.length],p=["text-[#000]","text-[#ffff]","text-[#000]","text-[#000]","text-[#ffff]","text-[#000]"],a=n=>p[n%p.length];return(n,s)=>o(t).attendanceDashboardWorkShiftSource?(x(),b("div",mt,[ft,e("div",xt,[e("div",gt,[(x(!0),b(U,null,I(o(t).attendanceDashboardWorkShiftSource,(r,l)=>(x(),b("div",{class:P([d(l),"w-[213px] h-[200px] mx-[10px] rounded-[6px] cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100"]),onClick:i=>(o(t).canShowShiftDetails=!0,o(t).currentlySelectedShiftDetails={...r.work_shift_employee_data},o(t).downloadShiftDetails.push({...r.work_shift_employee_data})),key:l},[e("div",{class:P(["w-full rounded-t-[8px] pl-[12px] py-2",h(l)])},[e("span",{class:P(["font-semibold text-[16px] font-['Poppins]",a(l)])},m(r.work_shift_employee_data[0].shift_name),3)],2),e("div",wt,[e("div",null,[yt,e("p",St,m(f(r.work_shift_employee_data[0].shift_start_time))+" - "+m(f(r.work_shift_employee_data[0].shift_end_time)),1)]),e("div",$t,[Ct,e("p",At,m(r.work_shift_assigned_employees?r.work_shift_assigned_employees:"-"),1)]),e("div",Dt,[e("div",null,[kt,e("p",Et,m(r.present_count?r.present_count:0),1)]),e("div",Ot,[Lt,e("p",Rt,m(r.absent_count?r.absent_count:0),1)])])])],10,bt))),128))])])])):F("",!0)}};var N={},Mt={get exports(){return N},set exports(w){N=w}};(function(w,t){(function(f,c){c()})(j,function(){function f(n,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function c(n,s,r){var l=new XMLHttpRequest;l.open("GET",n),l.responseType="blob",l.onload=function(){a(l.response,s,r)},l.onerror=function(){console.error("could not download file")},l.send()}function h(n){var s=new XMLHttpRequest;s.open("HEAD",n,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function g(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(s)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof j=="object"&&j.global===j?j:void 0,p=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(n,s,r){var l=d.URL||d.webkitURL,i=document.createElement("a");s=s||n.name||"download",i.download=s,i.rel="noopener",typeof n=="string"?(i.href=n,i.origin===location.origin?g(i):h(i.href)?c(n,s,r):g(i,i.target="_blank")):(i.href=l.createObjectURL(n),setTimeout(function(){l.revokeObjectURL(i.href)},4e4),setTimeout(function(){g(i)},0))}:"msSaveOrOpenBlob"in navigator?function(n,s,r){if(s=s||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(f(n,r),s);else if(h(n))c(n,s,r);else{var l=document.createElement("a");l.href=n,l.target="_blank",setTimeout(function(){g(l)})}}:function(n,s,r,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof n=="string")return c(n,s,r);var i=n.type==="application/octet-stream",A=/constructor/i.test(d.HTMLElement)||d.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||i&&A||p)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var S=y.result;S=$?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=S:location=S,l=null},y.readAsDataURL(n)}else{var _=d.URL||d.webkitURL,C=_.createObjectURL(n);l?l.location=C:location.href=C,l=null,setTimeout(function(){_.revokeObjectURL(C)},4e4)}});d.saveAs=a.saveAs=a,w.exports=a})})(Mt);const k=w=>(te("data-v-a6dad66c"),w=w(),oe(),w),jt={class:"w-full"},Pt=k(()=>e("p",{class:"mb-2 text-2xl text-black font-semibold"}," Attendance dashboard ",-1)),Bt={class:"bg-white p-2 rounded-lg border flex justify-between"},Ut={class:"mx-2"},Tt={class:"font-[14px] font-['Poppins'] text-gray-500"},It={class:"mb-2 text-sm font-semibold"},Vt={class:"flex justify-end gap-3 mx-4 items-center"},Gt=k(()=>e("div",null,[e("i",{class:"pi pi-calendar text-[#000] text-[16px]"})],-1)),Ht={class:"my-3"},Nt={class:"grid grid-cols-3 gap-2"},Wt={class:"my-3"},zt={class:"absolute left-0 mx-4 font-semibold fs-5"},Yt={class:"relative right-0 mx-4 font-semibold fs-5"},qt=k(()=>e("p",{class:"relative left-2 font-['poppins']"},"Download",-1)),Xt=k(()=>e("svg",{width:"22px",height:"16px",viewBox:"0 0 22 16"},[e("path",{d:"M2,10 L6,13 L12.8760559,4.5959317 C14.1180021,3.0779974 16.2457925,2.62289624 18,3.5 L18,3.5 C19.8385982,4.4192991 21,6.29848669 21,8.35410197 L21,10 C21,12.7614237 18.7614237,15 16,15 L1,15",id:"check"}),e("polyline",{points:"4.5 8.5 8 11 11.5 8.5",class:"svg-out"}),e("path",{d:"M8,1 L8,11",class:"svg-out"})],-1)),Kt=[Xt],Jt={key:0,class:""},Qt={key:1,class:"flex justify-center"},Zt=k(()=>e("img",{class:"h-[450px]",src:W,alt:"",srcset:""},null,-1)),eo=[Zt],to={class:"absolute left-0 mx-4 font-semibold fs-5"},oo={class:"relative right-0 mx-4 font-semibold fs-5"},no=k(()=>e("p",{class:"relative left-2 font-['poppins']"},"Download",-1)),so=k(()=>e("svg",{width:"22px",height:"16px",viewBox:"0 0 22 16"},[e("path",{d:"M2,10 L6,13 L12.8760559,4.5959317 C14.1180021,3.0779974 16.2457925,2.62289624 18,3.5 L18,3.5 C19.8385982,4.4192991 21,6.29848669 21,8.35410197 L21,10 C21,12.7614237 18.7614237,15 16,15 L1,15",id:"check"}),e("polyline",{points:"4.5 8.5 8 11 11.5 8.5",class:"svg-out"}),e("path",{d:"M8,1 L8,11",class:"svg-out"})],-1)),ao=[so],lo={key:0,class:""},io={key:1,class:"flex justify-center"},ro=k(()=>e("img",{class:"h-[450px]",src:W,alt:"",srcset:""},null,-1)),co=[ro],uo={__name:"attendanceDashboard",setup(w){const t=M();G(async()=>{await t.getAttendanceDashboardMainSource(),t.GetDepartment()});const f=u(),c=async()=>{const p=new H.Workbook,a=p.addWorksheet("Sheet1"),n=["user_code","user_code","shift_start_time","shift_end_time","shift_end_time"],s="this report generated by ABShrms payroll software ",r=n;a.addRow(r).eachCell((_,C)=>{_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"252f70"}},_.font={bold:!0,color:{argb:"ffffff"}},a.getColumn(C).width=20}),Object.values(t.currentlySelectedShiftDetails).forEach((_,C)=>{console.log(_);const S=[];r.forEach(T=>{S.push(_[T])}),a.addRow(S)}),a.addRow([""]);const i=a.addRow([""]);i.getCell(1).value=s,a.mergeCells(i.number,1,i.number,3),i.getCell(1).alignment={wrapText:!0},i.getCell(1).font={italic:!0};const A=await p.xlsx.writeBuffer(),$=window.URL.createObjectURL(new Blob([A])),y=document.createElement("a");y.href=$,y.download="shift.xlsx",y.click(),window.URL.revokeObjectURL($)},h=async()=>{const p=new H.Workbook,a=p.addWorksheet("Sheet1"),n=["Employee Code","Employee Name","Department","Process","Location"],s="This report generated by ABShrms payroll software ",r=n;a.addRow(r).eachCell((_,C)=>{_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"252f70"}},_.font={bold:!0,color:{argb:"ffffff"}},a.getColumn(C).width=20}),Object.values(t.downloadAttendanceOverviewDetails[0]).forEach((_,C)=>{console.log(_);const S=[];r.forEach(T=>{S.push(_[T])}),a.addRow(S)}),a.addRow([""]);const i=a.addRow([""]);i.getCell(1).value=s,a.mergeCells(i.number,1,i.number,3),i.getCell(1).alignment={wrapText:!0},i.getCell(1).font={italic:!0};const A=await p.xlsx.writeBuffer(),$=window.URL.createObjectURL(new Blob([A])),y=document.createElement("a");y.href=$,y.download=`${t.selectedAttendanceOverviewReport}_${new Date}.xlsx`,y.click(),window.URL.revokeObjectURL($)},g=u(!1),d=u("downloaded");return(p,a)=>{const n=R("Dropdown"),s=R("Column"),r=R("DataTable"),l=R("Sidebar");return x(),b(U,null,[o(t).canShowLoading?(x(),z(ne,{key:0,class:"absolute z-50 bg-white"})):F("",!0),e("div",jt,[Pt,e("div",Bt,[e("div",Ut,[e("p",Tt,[B(" Daily Analytics - "),e("span",It,m(o(Q)(new Date).format("MMMM DD,YYYY")),1)])]),e("div",Vt,[e("div",null,[v(n,{onChange:a[0]||(a[0]=i=>o(t).send_selectedDepartment(f.value)),optionValue:"id",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=i=>f.value=i),optionLabel:"name",options:o(t).departments,placeholder:"Select a Department",class:"w-full md:w-18rem h-[36px]"},null,8,["modelValue","options"])]),e("div",null,[v(n,{optionLabel:"name",placeholder:"Select a Location",class:"w-full md:w-14rem h-[36px]"})]),Gt])]),e("div",Ht,[v(Ue)]),e("div",Nt,[e("div",null,[v(Ye)]),e("div",null,[v(nt)]),e("div",null,[v(vt)])]),e("div",Wt,[v(Ft)])]),v(l,{visible:o(t).canShowShiftDetails,"onUpdate:visible":a[3]||(a[3]=i=>o(t).canShowShiftDetails=i),position:"right",class:"w-full"},{header:L(()=>[e("p",zt,m(o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails[0].shift_name:null)+" Reports",1),e("div",Yt,[e("button",{class:"bg-[#E6E6E6] p-2 mx-2 rounded-md w-[120px]",onClick:a[2]||(a[2]=i=>(g.value=!g.value,c()))},[qt,e("div",{id:"btn-download",style:{position:"absolute",right:"0"},class:P([g.value==!0?d.value:" "])},Kt,2)])])]),default:L(()=>[Object.values(o(t).currentlySelectedShiftDetails).length>=1?(x(),b("div",Jt,[v(r,{scrollable:"",scrollHeight:"450px",value:o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails:[]},{default:L(()=>[v(s,{field:"user_code",header:"User code"}),v(s,{field:"name",header:"Name"}),v(s,{field:"shift_start_time",header:"Shift start time"}),v(s,{field:"shift_end_time",header:"Shift end time"}),v(s,{field:"grace_time",header:"Grace time"})]),_:1},8,["value"])])):(x(),b("div",Qt,eo))]),_:1},8,["visible"]),v(l,{visible:o(t).canShowAttendanceOverview,"onUpdate:visible":a[5]||(a[5]=i=>o(t).canShowAttendanceOverview=i),position:"right",class:"w-full"},{header:L(()=>[e("p",to,m(o(t).selectedAttendanceOverviewReport)+" Reports",1),e("div",oo,[e("button",{class:"bg-[#E6E6E6] p-2 mx-2 rounded-md w-[120px]",onClick:a[4]||(a[4]=i=>(g.value=!g.value,h()))},[no,e("div",{id:"btn-download",style:{position:"absolute",right:"0"},class:P([g.value==!0?d.value:" "])},ao,2)])])]),default:L(()=>[Object.values(o(t).currentlySelectedShiftDetails).length>=1?(x(),b("div",lo,[v(r,{scrollable:"",scrollHeight:"450px",value:o(t).currentlySelectedShiftDetails?o(t).currentlySelectedShiftDetails:[]},{default:L(()=>[v(s,{field:"Employee Code",header:"Employee Code",style:{"white-space":"nowrap"}}),v(s,{field:"Employee Name",header:"Employee Name",style:{"white-space":"nowrap"}}),v(s,{field:"Department",header:"Department",style:{"white-space":"nowrap"}}),v(s,{field:"Process",header:"Process",style:{"white-space":"nowrap"}}),v(s,{field:"Location",header:"Location",style:{"white-space":"nowrap"}})]),_:1},8,["value"])])):(x(),b("div",io,co))]),_:1},8,["visible"])],64)}}},bo=ee(uo,[["__scopeId","data-v-a6dad66c"]]);export{bo as default};
