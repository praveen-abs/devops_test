/* empty css              *//* empty css                     *//* empty css                   */import{a0 as m,ak as E,o as P,c as x,I as g,b as z,a as N,d as l,h as s,w as h,t as V,F as B,g as S,K as W,P as H,L as j,u as I,M as O,R as J,S as K,x as Q,y as q,N as G,Q as X,_ as Z,V as ee,W as ae,Y as te}from"./toastservice.esm-484a3f44.js";import"./blockui.esm-a8e59b90.js";import{a as le}from"./datatable.esm-70b25cd4.js";import{C as se}from"./confirmationservice.esm-c218b510.js";import{s as oe}from"./progressspinner.esm-b12f0644.js";import{s as ie}from"./calendar.esm-17a99f33.js";import{d as ne,c as pe}from"./pinia-ef13c18a.js";import{a as k}from"./index-362795f3.js";import"./dayjs.min-2f06af28.js";import{L as de}from"./LoadingSpinner-e46f55f6.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-c27b6911.js";const re=ne("managePayslipStore",()=>{const M=m(),a=m(),R=m(),c=m(!1);async function _(i,p){c.value=!0,M.value="",await k.post("payroll/getAllEmployeesPayslipDetails",{month:i,year:p,type:"pdf"}).then(r=>{M.value=r.data.data}).finally(()=>{c.value=!1})}async function b(i,p,r){c.value=!0,await k.post("/generatePayslip",{user_code:i,month:p,year:r,type:"pdf"}).then(u=>{R.value="data:application/pdf;base64,"+u.data}).finally(()=>{c.value=!1})}async function D(i,p,r){c.value=!0,await k.post("/payroll/paycheck/getEmployeePayslipDetailsAsPDF",{user_code:i,month:p,year:r}).then(u=>{}).finally(()=>{c.value=!1})}async function f(i,p,r){console.log("sendMail_employeePayslip() : Sending mail to user : "+i),c.value=!0,k.post("/generatePayslip",{user_code:i,month:p,year:r,type:"mail"}).then(u=>{console.log(" Response [sendMail_employeePayslip] : "+u.data)}).catch(u=>{console.log(u)}).finally(()=>{c.value=!1})}async function L(i,p,r,u){console.log("updatePayslipReleaseStatus() : Updating releasepayslip status to user : "+i);let y=new Date(a.value);k.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:p,year:r,status:u}).then(d=>{console.log(" Response [updatePayslipReleaseStatus] : "+d.data.data)}).catch(d=>{console.log(d.data.data)}).finally(()=>{_(y.getMonth()+1,y.getFullYear())})}async function T(i,p,r,u){console.log("UpdateWithDrawStatus() : Updating withdraw :",i);let y=new Date(a.value);k.post("/payroll/paycheck/updatePayslipReleaseStatus",{user_code:i,month:p,year:r,status:u}).then(d=>{console.log(" Response [updatePayslipReleaseStatus] : "+d.data.data)}).catch(d=>{console.log(d.data.data)}).finally(()=>{_(y.getMonth()+1,y.getFullYear())})}function $(i,p,r){const u=i,y=document.createElement("a"),d=`${p}-${r}.pdf`;y.href=u,y.download=d,y.click()}async function U(i,p,r,u){console.log("Downloading payslip PDF....."),await k.post("/generatePayslip",{user_code:i,month:p,year:r,type:"pdf"}).then(y=>{if(console.log(" Response [downloadPayslipReleaseStatus] : "+JSON.stringify(y.data.data)),y.data){let d=y.data,o=i,t=p;d.startsWith("JVB")?(d="data:application/pdf;base64,"+d,$(d,o,t)):d.startsWith("data:application/pdf;base64")&&$(d)}else console.log("Response Url Not Found")})}return{array_employees_list:M,paySlipHTMLView:R,selectedPayRollDate:a,loading:c,getAllEmployeesPayslipDetails:_,getEmployeePayslipDetailsAsHTML:b,sendMail_employeePayslip:f,updatePayslipReleaseStatus:L,downloadPayslip:U,UpdateWithDrawStatus:T,getEmployeePayslipDetailsAsPDF:D}});const ce={class:"flex justify-between"},ue=l("div",null,[l("h6",{class:"mb-2 font-semibold text-lg"},"Manage Employee Payslips")],-1),ye={class:"d-flex justify-content-end"},me=l("label",{for:"",class:"my-2 text-lg font-semibold"},"Select Month",-1),fe={class:"my-4"},ve={class:"d-flex flex-column"},ge=["onClick"],he=["onClick"],_e={key:2,class:"text-success mt-2"},we={key:3,class:"text-danger mt-2"},Pe={key:0},be=l("h1",null," Payslip sent",-1),De=[be],xe={key:1},ke=["onClick"],Re=l("div",{class:"confirmation-content"},[l("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),l("span",null,"Are you sure you want to send Mail ?")],-1),Ce={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Se=l("div",{class:"confirmation-content"},[l("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),l("span",null,"Are you sure you want to send Mail ?")],-1),Me={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},$e={class:"confirmation-content"},Fe=l("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Le={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Te={class:"confirmation-content"},Ue=l("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Ne={class:"d-flex mt-11",style:{position:"relative",right:"-180px",width:"140px"}},Ve={class:"flex card justify-content-center"},Ye=["src"],Ae={__name:"ManagePayslips",setup(M){const a=re(),R=m(!1),c=m(!1),_=m(!1),b=m(!1),D=m(!1);m();const f=m(),L=m();E(()=>{a.selectedPayRollDate=new Date,a.selectedPayRollDate=new Date,a.getAllEmployeesPayslipDetails(a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear())});async function T(o){console.log("Showing payslip html for (user_code, month): "+o+" , "+parseInt(a.selectedPayRollDate.getMonth()+1)),await a.getEmployeePayslipDetailsAsHTML(o,a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear()),R.value=!0}function $(o){f.value=o,c.value=!0}function U(o){f.value=o,_.value=!0}function i(o){f.value=o,b.value=!0}async function p(o){await a.sendMail_employeePayslip(o,a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear()),c.value=!1}async function r(o){await a.updatePayslipReleaseStatus(o,a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear(),1),_.value=!1}async function u(o){f.value=o,D.value=!0}async function y(o){await a.UpdateWithDrawStatus(o,a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear(),0),D.value=!1}async function d(o){await a.downloadPayslip(o,a.selectedPayRollDate.getMonth()+1,a.selectedPayRollDate.getFullYear()),b.value=!1}return(o,t)=>{const Y=S("Calendar"),w=S("Column"),v=S("Button"),A=S("DataTable"),C=S("Dialog");return P(),x(B,null,[g(a).loading?(P(),z(de,{key:0,class:"absolute z-50 bg-white"})):N("",!0),l("div",ce,[ue,l("div",ye,[me,s(Y,{view:"month",dateFormat:"mm/yy",class:"mx-4",modelValue:g(a).selectedPayRollDate,"onUpdate:modelValue":t[0]||(t[0]=e=>g(a).selectedPayRollDate=e),style:{"border-radius":"7px",height:"38px"},onDateSelect:t[1]||(t[1]=e=>g(a).getAllEmployeesPayslipDetails(g(a).selectedPayRollDate.getMonth()+1,g(a).selectedPayRollDate.getFullYear()))},null,8,["modelValue"])])]),l("div",fe,[s(A,{value:g(a).array_employees_list,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Records",responsiveLayout:"scroll",filters:o.filters,"onUpdate:filters":t[2]||(t[2]=e=>o.filters=e),filterDisplay:"menu",loading:o.loading2,globalFilterFields:["name","status"]},{default:h(()=>[s(w,{headerStyle:"width: 3rem"}),s(w,{field:"user_code",header:"Employee Code",headerStyle:"width: 3rem"}),s(w,{field:"name",header:"Employee Name"}),s(w,{field:"email",header:"Personal Mail"}),s(w,{field:"is_payslip_released",header:"Payslip Status"},{body:h(e=>[l("div",ve,[e.data.is_payslip_released==1?(P(),x("button",{key:0,class:"btn z-0",style:{border:"1px solid navy"},onClick:F=>u(e.data.user_code)},"withdraw",8,ge)):(P(),x("button",{key:1,class:"btn-primary rounded z-0",style:{padding:"4px 0 !important","margin-top":"10px"},onClick:F=>U(e.data.user_code)},"Release payslip",8,he)),e.data.is_payslip_released==1?(P(),x("h1",_e," Released ")):N("",!0),e.data.is_payslip_released==0||e.data.is_payslip_released==null?(P(),x("h1",we," Not Released ")):N("",!0)])]),_:1}),s(w,{field:"is_payslip_mail_sent",header:"Mail Status"},{body:h(e=>[e.data.is_payslip_mail_sent==1?(P(),x("div",Pe,De)):(P(),x("div",xe,[l("button",{class:"btn-primary rounded z-0",onClick:F=>$(e.data.user_code)},"Send Payslip",8,ke)]))]),_:1}),s(w,{header:"Download"},{body:h(e=>[s(v,{class:"btn-primary z-0",style:{},label:"Download",onClick:F=>i(e.data.user_code)},null,8,["onClick"])]),_:1}),s(w,{header:"View Payslip"},{body:h(e=>[s(v,{class:"btn-primary z-0",style:{},label:"View",onClick:F=>T(e.data.user_code)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),s(C,{header:"Confirmation",visible:c.value,"onUpdate:visible":t[5]||(t[5]=e=>c.value=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:h(()=>[Re,l("div",Ce,[s(v,{class:"btn-primary mr-3 py-2",label:"Yes",icon:"pi pi-check",onClick:t[3]||(t[3]=e=>p(f.value)),autofocus:""}),s(v,{label:"No",icon:"pi pi-times",onClick:t[4]||(t[4]=e=>c.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),s(C,{header:"Confirmation",visible:D.value,"onUpdate:visible":t[8]||(t[8]=e=>D.value=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:h(()=>[Se,l("div",Me,[s(v,{class:"btn-primary mr-3 py-2",label:"Yes",icon:"pi pi-check",onClick:t[6]||(t[6]=e=>y(f.value)),autofocus:""}),s(v,{label:"No",icon:"pi pi-times",onClick:t[7]||(t[7]=e=>D.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),s(C,{header:"Confirmation",visible:_.value,"onUpdate:visible":t[11]||(t[11]=e=>_.value=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:h(()=>[l("div",$e,[Fe,l("span",null,"Are you sure you want to release payslip? "+V(g(a).name),1)]),l("div",Le,[s(v,{class:"btn-primary py-2 mr-3",label:"Yes",icon:"pi pi-check",onClick:t[9]||(t[9]=e=>r(f.value)),autofocus:""}),s(v,{label:"No",icon:"pi pi-times",onClick:t[10]||(t[10]=e=>_.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),s(C,{header:"Confirmation",visible:b.value,"onUpdate:visible":t[14]||(t[14]=e=>b.value=e),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{default:h(()=>[l("div",Te,[Ue,l("span",null,"Are you sure you want to download payslip? "+V(g(a).name),1)]),l("div",Ne,[s(v,{class:"py-2 mr-3 btn-primary",label:"Yes",icon:"pi pi-check",onClick:t[12]||(t[12]=e=>d(f.value,L.value)),autofocus:""}),s(v,{label:"No",icon:"pi pi-times",onClick:t[13]||(t[13]=e=>b.value=!1),class:"p-button-text py-2",autofocus:""})])]),_:1},8,["visible"]),l("div",Ve,[s(C,{visible:R.value,"onUpdate:visible":t[15]||(t[15]=e=>R.value=e),maximizable:"",modal:"",header:"Payslip",style:{width:"50vw"}},{default:h(()=>[l("embed",{src:g(a).paySlipHTMLView,type:"application/pdf",width:"100%",height:"800px"},null,8,Ye)]),_:1},8,["visible"])])],64)}}},n=W(Ae),Ee=pe();n.use(H,{ripple:!0});n.use(se);n.use(j);n.use(Ee);n.directive("tooltip",I);n.directive("badge",O);n.directive("ripple",J);n.directive("styleclass",K);n.directive("focustrap",Q);n.component("Button",q);n.component("DataTable",le);n.component("Column",G);n.component("ConfirmDialog",X);n.component("Toast",Z);n.component("Dialog",ee);n.component("Dropdown",ae);n.component("ProgressSpinner",oe);n.component("InputText",te);n.component("Calendar",ie);n.mount("#vjs_manage_payslips");
