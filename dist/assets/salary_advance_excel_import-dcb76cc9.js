/* empty css              *//* empty css                   *//* empty css                 */import{I as l,ag as Be,aj as Fe,ah as Re,o as Ue,c as Le,h as c,w as E,d as r,l as le,t as ze,ai as y,T as ye,F as je,g as C,ak as qe,al as Ze,J as Qe,P as We,K as xe,u as Ke,L as Je,R as He,S as Ge,x as Xe,y as Ye,M as es,Y as ss,N as ts,V as ls,X as as,Q as rs,W as os}from"./toastservice.esm-918560db.js";import{d as is,c as ns}from"./pinia-3f44ac08.js";import"./blockui.esm-af7169c2.js";import{a as us}from"./datatable.esm-b98720f6.js";import{D as cs,s as ds}from"./dialogservice.esm-5dbb3ad8.js";import{C as ps}from"./confirmationservice.esm-87248870.js";import{s as ms}from"./progressspinner.esm-aabe5d1a.js";import{s as fs}from"./row.esm-6ebc942e.js";import{s as vs}from"./calendar.esm-b58ab31f.js";import{s as gs}from"./textarea.esm-c5c6ba2f.js";import{s as hs}from"./chips.esm-4c50bd29.js";import{s as bs}from"./multiselect.esm-2ac860b7.js";import{s as ys}from"./selectbutton.esm-a520c323.js";import{s as _s}from"./radiobutton.esm-60b83b54.js";import{s as xs}from"./checkbox.esm-6e395b34.js";import{s as Es}from"./organizationchart.esm-e18a99c8.js";import{u as Cs,a as ks}from"./vue-router-441d5b01.js";import{a as _e}from"./index-362795f3.js";import{r as Ns,u as M}from"./xlsx-4ad528ac.js";import"./dayjs.min-2f06af28.js";import{_ as Ss}from"./_plugin-vue_export-helper-c27b6911.js";const Ts=is("useSalaryAdvanceMainStore",()=>{const v=Cs(),a=l(!1),g=Be(),m=l(),B=l(),n=l(),N=l([]),o=l([]),F=l(!1),R=l(!1),b=l(),u=l(),Ee=e=>{n.value=e.target.files[0]},Ce=e=>{if(b.value=e,console.log(e),n.value){a.value=!0;var s=n.value;if(!s)return;setTimeout(()=>{e=="quick"?(u.value="quick",v.push({path:"/import/quickOnboarding"})):e=="bulk"?(u.value="bulk",v.push({path:"/import/bulkOnboarding"})):u.value="",a.value=!1},500);var i=new FileReader;i.onload=function(h){const Oe=i.result;var P=Ns(Oe,{type:"binary",cellDates:!0,dateNF:"dd-mm-yyyy"}),be=P.Sheets[P.SheetNames[0]];let ee=[];const V={},se=M.decode_range(be["!ref"]);let f;const Me=se.s.r;for(f=se.s.c;f<=se.e.c;++f){const p=be[M.encode_cell({c:f,r:Me})];let x="UNKNOWN "+f;p&&p.t&&(x=M.format_cell(p)),V[f]=x;let te={title:V[f],value:V[f]};V[f].includes("UNKNOWN")||ee.push(te)}B.value=ee,console.log(ee);const _=P.SheetNames.reduce((p,x)=>{const te=P.Sheets[x];return p[x]=M.sheet_to_json(te,{raw:!1,dateNF:"dd-mm-yyyy"}),p},{}),O=Object.keys(_)[0];_[O]?m.value=_[O]:m.value=[],m.value&&ae(m.value),N.value.push(m.value);for(let p=0;p<_[O].length;p++)console.log("jsonData['Sheet1'].length :",_[O].length),he(m.value[p])},i.readAsArrayBuffer(s)}else g.add({severity:"error",summary:"file missing!",detail:"selected",life:2e3})},ke=e=>{let s="";u.value=="quick"?s="/onboarding/storeQuickOnboardEmployees":u.value=="bulk"&&(s="/onboarding/storeBulkOnboardEmployees"),o.value==0?(a.value=!0,_e.post(s,e).then(i=>{a.value=!1,i.data.status=="failure"?g.add({severity:"error",summary:"failure",detail:`${i.data.message}`,life:3e3}):i.data.status=="success"&&(i.data.data.forEach(h=>{g.add({severity:"success",summary:`${h.Employee_Name}`,detail:`${h.message}`,life:3e3})}),setTimeout(()=>{window.location.replace(window.location.origin+"/manageEmployees")},4e3))}).finally(()=>{})):g.add({severity:"error",summary:"Failure!",detail:"Clear error fields",life:3e3})};function d(e){return e.filter((s,i)=>e.indexOf(s)!==i)}let S=l([]),T=l([]),w=l([]),U=l([]),L=l([]),z=l([]);const ae=e=>{e.forEach(s=>{S.value.push(s["Employee Code"]),T.value.push(s.Email),w.value.push(s["Mobile Number"]),U.value.push(s["Pan No"]),L.value.push(s.Aadhar),z.value.push(s["Account No"])})},Ne=(e,s)=>!!d(e).includes(s),re=l(),D=l(),j=l(),q=l(),Z=l(),$=l(),Q=l(),oe=l(),ie=l(),ne=l(),ue=l(),W=l(),A=l(),K=l([]),Se=()=>{_e.get("/onboarding/getEmployeeMandatoryDetails").then(e=>{Object.values(e.data).forEach(s=>{re.value=s.client_code,D.value=s.user_code,q.value=s.mobile_number,j.value=s.email,Z.value=s.pan_number,$.value=s.aadhar_number,Q.value=s.bankaccount_number,oe.value=s.bank_name,ie.value=s.department_name,ne.value=s.official_mail,ue.value=s.employees_blood_group,W.value=s.employees_marital_status,A.value=s.client_details,A.value&&A.value.forEach(i=>{K.value.push(i.client_fullname)})})})},Te=e=>!/^[ A-Za-z_ ]+$/.test(e),we=e=>!(/^[A-Za-z0-9]+$/.test(e)&&!D.value.includes(e));function De(e,s){const i=s.split(/(?=\d)/);return!!Object.values(e).includes(i[0])}const J=e=>e?!D.value.includes(e):!0,$e=e=>!/^[0-9]+$/.test(e),H=e=>e?!(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e.trim())&&!j.value.includes(e.trim())):!1,G=e=>{const s=ce(e);return e?!(/^[2-9]{1}[0-9]{3}\s{1}[0-9]{4}\s{1}[0-9]{4}$/.test(s)&&!$.value.includes(s)):!1};function ce(e){const s=String(e),i=[];for(let h=0;h<s.length;h+=4)i.push(s.substr(h,4));return i.join(" ")}const Ae=e=>!!$.value.includes(e),de=e=>{let s="";return e&&(s=e.toUpperCase()),e?!(/^([a-zA-Z]){3}([Pp]){1}([a-zA-Z]){1}([0-9]){4}([a-zA-Z]){1}?$/.test(s.trim())&&Z.value.includes(s.trim())):!0},pe=e=>e?!!Q.value.includes(e.trim()):!1,me=e=>{let s="";return e&&(s=e.toUpperCase()),e?!/^[A-Za-z]{4}0[A-Za-z0-9]{6}$/.test(s.trim()):!1},I=e=>e?!/^[0-9]{1,2}-[0-9]{1,2}-[0-9]{4}$/.test(e):!0,X=e=>e?!(/^[0-9]{10,10}$/.test(e.trim())&&!q.value.includes(e.trim())):!1,Y=(e,s)=>s?!e.includes(s):!1,Ie=e=>{let s=String.fromCharCode(e.keyCode);if(/^[0-9]+$/.test(s))return!0;e.preventDefault()},Pe=e=>{let s=String.fromCharCode(e.keyCode);if(/^[A-Za-z_ ]+$/.test(s))return!0;e.preventDefault()},fe=e=>{let s=String.fromCharCode(e.keyCode);if(/^[A-Za-z0-9]+$/.test(s))return!0;e.preventDefault()},ve=e=>{if(e){let s="";e&&e.toUpperCase();let i=s.trim();return!!oe.value.includes(i)}else return!0},ge=e=>e?!!ie.value.includes(e):!0,Ve=e=>!!ne.value.includes(e),he=e=>{console.log(b.value);let s=[];return b.value=="quick"?(d(S.value).includes(e["Employee Code"])||!J(e["Employee Code"])||d(T.value).includes(e.Email)||H(e.Email)||I(e.DOJ)||d(w.value).includes(e["Mobile Number"])||X(e["Mobile Number"]))&&o.value.push("invalid"):b.value=="bulk"?d(S.value).includes(e["Employee Code"])||!J(e["Employee Code"])||Y(K.value,e["Legal Entity"])||d(T.value).includes(e.Email)||H(e.Email)||I(e.DOJ)||I(e.DOB)||d(U.value).includes(e["Pan No"])||!de(e["Pan No"])?o.value.push("invalid"):d(L.value).includes(e.Aadhar)||G(e.Aadhar)?(console.log(G(e.Aadhar)),o.value.push("invalid")):d(w.value).includes(e["Mobile Number"])||X(e["Mobile Number"])||ve(e["Bank Name"])||Y(W.value,e["Marital Status"])||me(e["Bank ifsc"])||d(z.value).includes(e["Account No"])||pe(e["Account No"])?o.value.push("invalid"):ge(e.Department)||o.value.push("invalid"):console.log("No more error record found!"),s};return{getCurrentlyImportedTableDuplicateEntries:ae,currentlyImportedTableEmployeeCodeValues:S,findCurrentTableDups:Ne,uploadOnboardingFile:ke,type:u,currentlyImportedTableAadharValues:L,currentlyImportedTablePanValues:U,currentlyImportedTableAccNoValues:z,currentlyImportedTableEmailValues:T,currentlyImportedTableMobileNumberValues:w,getExistingOnboardingDocuments:Se,existingUserCode:D,existingEmails:j,existingMobileNumbers:q,existingAadharCards:$,existingPanCards:Z,existingBankAccountNumbers:Q,initialUpdate:F,isValueUpdated:R,existingMartialStatus:W,existingBloodgroups:ue,existingClientCode:re,existingLegalEntity:K,legalEntityDropdown:A,isLetter:Te,isEmail:H,isNumber:$e,isEnterLetter:Pe,isEnterSpecialChars:fe,isEnterSpecialChars:fe,isValidAadhar:G,isValidBankAccountNo:pe,isValidBankIfsc:me,isSpecialChars:we,isValidDate:I,isValidMobileNumber:X,isValidPancard:de,isEnteredNos:Ie,totalRecordsCount:N,errorRecordsCount:o,selectedFile:n,isUserExists:J,isBankExists:ve,isDepartmentExists:ge,isOfficialMailExists:Ve,isAadharExists:Ae,isExistsOrNot:Y,isClientCodeExists:De,splitNumberWithSpaces:ce,convertExcelIntoArray:Ce,EmployeeQuickOnboardingDynamicHeader:B,EmployeeQuickOnboardingSource:m,getValidationMessages:he,getExcelForUpload:Ee,canShowloading:a}});const k=v=>(qe("data-v-0776e25d"),v=v(),Ze(),v),ws={class:"w-full h-screen"},Ds={class:"grid grid-cols-12"},$s={class:"col-span-5 px-2"},As=k(()=>r("p",{class:"text-2xl font-bold"},"Employee Quick Onboarding",-1)),Is=k(()=>r("ul",{class:"p-2 my-3 list-disc"},[r("li",{class:"font-semibold fs-6"},[le("Download the "),r("a",{href:"/assets//ABSQuickOnboarding.xlsx",class:"font-semibold text-blue-300 cursor-pointer fs-6"},"Sample")]),r("li",{class:"font-semibold fs-6"},"Fill the information in excel template")],-1)),Ps={class:"grid grid-cols-12 p-2 mr-3 border border-gray-500 divide-x-2 divide-gray-600 rounded-lg"},Vs=k(()=>r("i",{class:"px-2 pi pi-folder",style:{"font-size":"1rem"}},null,-1)),Os={class:"col-span-9 px-4"},Ms=k(()=>r("div",{class:"col-span-7"},[r("div",{class:"col-form-label"},[r("div",{class:"py-2 font-semibold bg-red-100 rounded-lg f-12 alert-warning fs-6"},[r("i",{class:"mx-2 fa fa-warning text-danger"}),le(" Read these instructions before uploading the file. ")]),r("div",null,[r("ul",{class:"m-4 font-semibold list-disc",style:{}},[r("li",{class:"font-semibold fs-6"}," The fields Employee Number, Employee Name, Email, Date of Joining, and Location must be filled in before adding workers."),r("li",{class:"font-semibold fs-6"}," When adding an employee, you must enter your mobile phone number."),r("li",{class:"font-semibold fs-6"}," To receive all messages, including those about timesheet reminders, leave requests, and attendance requests, your email address must be current. "),r("li",{class:"font-semibold fs-6"}," Each employee's email is different. Therefore, an employee cannot be added to two organisations using the same email."),r("li",{class:"font-semibold fs-6"}," Designation is required because, in cases when two or more workers share the same Name, it will aid in locating them in People Picker search results. ")])])])],-1)),Bs=k(()=>r("h5",{style:{"text-align":"center"}},"Please wait...",-1)),Fs={__name:"salary_advance_excel_import",setup(v){const a=Ts(),g=l(null),m=()=>{g.value.click()};return Fe(()=>{a.getExistingOnboardingDocuments(),useNormalOnboardingStore.getBasicDeps()}),Re(()=>{a.initialUpdate&&(a.currentlyImportedTableEmployeeCodeValues.splice(0,a.currentlyImportedTableEmployeeCodeValues.length),a.currentlyImportedTableAadharValues.splice(0,a.currentlyImportedTableAadharValues.length),a.currentlyImportedTableMobileNumberValues.splice(0,a.currentlyImportedTableMobileNumberValues.length),a.currentlyImportedTableAccNoValues.splice(0,a.currentlyImportedTableAccNoValues.length),a.currentlyImportedTablePanValues.splice(0,a.currentlyImportedTablePanValues.length),a.currentlyImportedTableEmailValues.splice(0,a.currentlyImportedTableEmailValues.length))}),ks(),(B,n)=>{const N=C("Toast"),o=C("Column"),F=C("DataTable"),R=C("ProgressSpinner"),b=C("Dialog");return Ue(),Le(je,null,[c(N),c(ye,{name:"fade"},{default:E(()=>[r("div",ws,[r("div",Ds,[r("div",$s,[As,Is,r("div",Ps,[r("div",{onClick:m,class:"w-full col-span-3 font-semibold cursor-pointer fs-6",for:"file"},[Vs,le("Browse ")]),r("span",Os,ze(y(a).selectedFile?y(a).selectedFile.name:""),1)]),r("input",{ref_key:"fileInput",ref:g,type:"file",name:"",id:"file",hidden:"",onChange:n[0]||(n[0]=u=>y(a).getExcelForUpload(u)),accept:".xls, .xlsx"},null,544),r("button",{class:"float-right mx-5 mt-4 btn btn-orange",onClick:n[1]||(n[1]=u=>y(a).convertExcelIntoArray("quick"))},"Upload")]),Ms]),c(F,{ref:"dt",dataKey:"id",paginator:!0,class:"mt-3",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Records",responsiveLayout:"scroll"},{default:E(()=>[c(o,{field:"Employee",header:"Employee's"}),c(o,{field:"Employee code",header:"Month"}),c(o,{field:"Employee code",header:"Date Time"}),c(o,{field:"Employee code",header:"Total Employees Onboarded"}),c(o,{field:"Employee code",header:"Action"})]),_:1},512)])]),_:1}),c(ye,{name:"fade",mode:"out-in"},{default:E(()=>[c(b,{header:"Header",visible:y(a).canShowloading,"onUpdate:visible":n[2]||(n[2]=u=>y(a).canShowloading=u),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"25vw"},modal:!0,closable:!1,closeOnEscape:!1},{header:E(()=>[c(R,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:"2s","aria-label":"Custom ProgressSpinner"})]),footer:E(()=>[Bs]),_:1},8,["visible"])]),_:1})],64)}}},Rs=Ss(Fs,[["__scopeId","data-v-0776e25d"]]),t=Qe(Rs),Us=ns();t.use(We,{ripple:!0});t.use(ps);t.use(xe);t.use(cs);t.use(xe);t.use(Us);t.directive("tooltip",Ke);t.directive("badge",Je);t.directive("ripple",He);t.directive("styleclass",Ge);t.directive("focustrap",Xe);t.component("Button",Ye);t.component("RadioButton",_s);t.component("DataTable",us);t.component("Column",es);t.component("ColumnGroup",ds);t.component("Row",fs);t.component("Toast",ss);t.component("ConfirmDialog",ts);t.component("Dropdown",ls);t.component("InputText",as);t.component("Dialog",rs);t.component("ProgressSpinner",ms);t.component("Calendar",vs);t.component("Textarea",gs);t.component("Chips",hs);t.component("MultiSelect",bs);t.component("InputNumber",os);t.component("SelectButton",ys);t.component("Checkbox",xs);t.component("OrganizationChart",Es);t.mount("#salary_advance_excel_import");
